<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Praktikum 21 Ruumiandmete analüüs R-iga (2) | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes</title>
  <meta name="description" content="Praktikum 21 Ruumiandmete analüüs R-iga (2) | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Praktikum 21 Ruumiandmete analüüs R-iga (2) | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Praktikum 21 Ruumiandmete analüüs R-iga (2) | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes" />
  
  
  

<meta name="author" content="Maarja-Liisa Pilvik, Andres Kimber" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r.html"/>
<link rel="next" href="kirjandus.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<link href="libs/leaflet-measure-2.1.7/leaflet-measure.css" rel="stylesheet" />
<script src="libs/leaflet-measure-2.1.7/leaflet-measure.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.26/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Sissejuhatus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#kursuse-korraldusest"><i class="fa fa-check"></i><b>1.1</b> Kursuse korraldusest</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#mis-on-geoinfosüsteemid"><i class="fa fa-check"></i><b>1.2</b> Mis on geoinfosüsteemid?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#geoinfosüsteemide-ajaloost"><i class="fa fa-check"></i><b>1.3</b> Geoinfosüsteemide ajaloost</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#ruumiandmed-ja-gis-humanitaarteadustes"><i class="fa fa-check"></i><b>1.4</b> Ruumiandmed ja GIS humanitaarteadustes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#arheoloogia"><i class="fa fa-check"></i><b>1.4.1</b> Arheoloogia</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#veel-näiteid"><i class="fa fa-check"></i><b>1.4.2</b> Veel näiteid</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#küsitlus"><i class="fa fa-check"></i><b>1.5</b> Küsitlus</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#järgmisel-korral"><i class="fa fa-check"></i><b>1.6</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="seminar.html"><a href="seminar.html"><i class="fa fa-check"></i><b>2</b> Seminar</a>
<ul>
<li class="chapter" data-level="2.1" data-path="seminar.html"><a href="seminar.html#mõisted"><i class="fa fa-check"></i><b>2.1</b> Mõisted</a></li>
<li class="chapter" data-level="2.2" data-path="seminar.html"><a href="seminar.html#rühmatöö-1-gisi-ja-ruumi-geohumanitaaria-projekte-ja-rakendusi"><i class="fa fa-check"></i><b>2.2</b> Rühmatöö 1: GISi ja ruumi-/geohumanitaaria projekte ja rakendusi</a></li>
<li class="chapter" data-level="2.3" data-path="seminar.html"><a href="seminar.html#rühmatöö-2-humanitaaria-ja-kvantitatiivsed-meetodid"><i class="fa fa-check"></i><b>2.3</b> Rühmatöö 2: humanitaaria ja kvantitatiivsed meetodid</a></li>
<li class="chapter" data-level="2.4" data-path="seminar.html"><a href="seminar.html#järgmisel-korral-1"><i class="fa fa-check"></i><b>2.4</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html"><i class="fa fa-check"></i><b>3</b> Ruumiobjektid ja ruumiandmed</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#vektorandmed"><i class="fa fa-check"></i><b>3.1</b> Vektorandmed</a></li>
<li class="chapter" data-level="3.2" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#rasterandmed"><i class="fa fa-check"></i><b>3.2</b> Rasterandmed</a></li>
<li class="chapter" data-level="3.3" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#vektor-vs.-raster"><i class="fa fa-check"></i><b>3.3</b> Vektor vs. raster</a></li>
<li class="chapter" data-level="3.4" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#kasikirjalised"><i class="fa fa-check"></i><b>3.4</b> Ülesanne</a></li>
<li class="chapter" data-level="3.5" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#järgmisel-korral-2"><i class="fa fa-check"></i><b>3.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="kaardid.html"><a href="kaardid.html"><i class="fa fa-check"></i><b>4</b> Kaardid, koordinaatsüsteemid ja projektsioonid</a>
<ul>
<li class="chapter" data-level="4.1" data-path="kaardid.html"><a href="kaardid.html#kaart"><i class="fa fa-check"></i><b>4.1</b> Kaart</a></li>
<li class="chapter" data-level="4.2" data-path="kaardid.html"><a href="kaardid.html#kaardi-elemendid"><i class="fa fa-check"></i><b>4.2</b> Kaardi elemendid</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="kaardid.html"><a href="kaardid.html#mootkava"><i class="fa fa-check"></i><b>4.2.1</b> Mõõtkava</a></li>
<li class="chapter" data-level="4.2.2" data-path="kaardid.html"><a href="kaardid.html#projektsioon"><i class="fa fa-check"></i><b>4.2.2</b> Koordinaatsüsteemid ja projektsioonid</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="kaardid.html"><a href="kaardid.html#kaartide-liigitus"><i class="fa fa-check"></i><b>4.3</b> Kaartide liigitus</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="kaardid.html"><a href="kaardid.html#digitaalkaardid"><i class="fa fa-check"></i><b>4.3.1</b> Digitaalkaardid</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="kaardid.html"><a href="kaardid.html#kaartide-koostamine-ja-kujundamine-veebis"><i class="fa fa-check"></i><b>4.4</b> Kaartide koostamine ja kujundamine veebis</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="kaardid.html"><a href="kaardid.html#kaardistiili-kohandamine"><i class="fa fa-check"></i><b>4.4.1</b> Kaardistiili kohandamine</a></li>
<li class="chapter" data-level="4.4.2" data-path="kaardid.html"><a href="kaardid.html#oma-andmete-lisamine"><i class="fa fa-check"></i><b>4.4.2</b> Oma andmete lisamine</a></li>
<li class="chapter" data-level="4.4.3" data-path="kaardid.html"><a href="kaardid.html#kaardijagamine"><i class="fa fa-check"></i><b>4.4.3</b> Kaardi jagamine</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="kaardid.html"><a href="kaardid.html#järgmisel-korral-3"><i class="fa fa-check"></i><b>4.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="storymaps.html"><a href="storymaps.html"><i class="fa fa-check"></i><b>5</b> Story maps</a>
<ul>
<li class="chapter" data-level="5.1" data-path="storymaps.html"><a href="storymaps.html#story-maps"><i class="fa fa-check"></i><b>5.1</b> Story maps</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="storymaps.html"><a href="storymaps.html#storymapjs"><i class="fa fa-check"></i><b>5.1.1</b> StoryMapJS</a></li>
<li class="chapter" data-level="5.1.2" data-path="storymaps.html"><a href="storymaps.html#arcgis-storymaps"><i class="fa fa-check"></i><b>5.1.2</b> ArcGIS StoryMaps</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="storymaps.html"><a href="storymaps.html#ülesanne-tänane-kuupäev-story-mapis"><i class="fa fa-check"></i><b>5.2</b> Ülesanne: tänane kuupäev <em>story map</em>’is</a></li>
<li class="chapter" data-level="5.3" data-path="storymaps.html"><a href="storymaps.html#järgmisel-korral-4"><i class="fa fa-check"></i><b>5.3</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="qgis_1.html"><a href="qgis_1.html"><i class="fa fa-check"></i><b>6</b> Sissejuhatus QGISi (1)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="qgis_1.html"><a href="qgis_1.html#installimine"><i class="fa fa-check"></i><b>6.1</b> Installimine</a></li>
<li class="chapter" data-level="6.2" data-path="qgis_1.html"><a href="qgis_1.html#andmed-ja-failihaldus"><i class="fa fa-check"></i><b>6.2</b> Andmed ja failihaldus</a></li>
<li class="chapter" data-level="6.3" data-path="qgis_1.html"><a href="qgis_1.html#esimene-seadistamine-ja-kasutajaliides"><i class="fa fa-check"></i><b>6.3</b> Esimene seadistamine ja kasutajaliides</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="qgis_1.html"><a href="qgis_1.html#vaikimisi-koordinaatsüsteemi-sätestamine."><i class="fa fa-check"></i><b>6.3.1</b> Vaikimisi koordinaatsüsteemi sätestamine.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="qgis_1.html"><a href="qgis_1.html#andmete-avamine"><i class="fa fa-check"></i><b>6.4</b> Andmete avamine</a></li>
<li class="chapter" data-level="6.5" data-path="qgis_1.html"><a href="qgis_1.html#kihtide-visualiseerimine"><i class="fa fa-check"></i><b>6.5</b> Kihtide visualiseerimine</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="qgis_1.html"><a href="qgis_1.html#harjutus-1"><i class="fa fa-check"></i><b>6.5.1</b> Harjutus 1</a></li>
<li class="chapter" data-level="6.5.2" data-path="qgis_1.html"><a href="qgis_1.html#yhendamine1"><i class="fa fa-check"></i><b>6.5.2</b> Harjutus 2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="qgis_1.html"><a href="qgis_1.html#aluskaardid"><i class="fa fa-check"></i><b>6.6</b> Aluskaardid</a></li>
<li class="chapter" data-level="6.7" data-path="qgis_1.html"><a href="qgis_1.html#järgmisel-korral-5"><i class="fa fa-check"></i><b>6.7</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="qgis_2.html"><a href="qgis_2.html"><i class="fa fa-check"></i><b>7</b> Sissejuhatus QGISi (2)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="qgis_2.html"><a href="qgis_2.html#andmete-valimine"><i class="fa fa-check"></i><b>7.1</b> Andmete valimine</a></li>
<li class="chapter" data-level="7.2" data-path="qgis_2.html"><a href="qgis_2.html#kihiparandus"><i class="fa fa-check"></i><b>7.2</b> Vektorkihi geomeetria parandamine</a></li>
<li class="chapter" data-level="7.3" data-path="qgis_2.html"><a href="qgis_2.html#kihiloomine"><i class="fa fa-check"></i><b>7.3</b> Kihi ja andmete loomine</a></li>
<li class="chapter" data-level="7.4" data-path="qgis_2.html"><a href="qgis_2.html#kaartide-kujundamine-ja-eksportimine"><i class="fa fa-check"></i><b>7.4</b> Kaartide kujundamine ja eksportimine</a></li>
<li class="chapter" data-level="7.5" data-path="qgis_2.html"><a href="qgis_2.html#järgmisel-korral-6"><i class="fa fa-check"></i><b>7.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="avaandmed.html"><a href="avaandmed.html"><i class="fa fa-check"></i><b>8</b> Avaandmed ja repositooriumid</a>
<ul>
<li class="chapter" data-level="8.1" data-path="avaandmed.html"><a href="avaandmed.html#mis-on-avaandmed"><i class="fa fa-check"></i><b>8.1</b> Mis on avaandmed?</a></li>
<li class="chapter" data-level="8.2" data-path="avaandmed.html"><a href="avaandmed.html#eesti-ruumiandmed"><i class="fa fa-check"></i><b>8.2</b> Eesti ruumiandmed</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="avaandmed.html"><a href="avaandmed.html#maa-ameti-geoportaal"><i class="fa fa-check"></i><b>8.2.1</b> Maa-ameti Geoportaal</a></li>
<li class="chapter" data-level="8.2.2" data-path="avaandmed.html"><a href="avaandmed.html#statistikaamet"><i class="fa fa-check"></i><b>8.2.2</b> Statistikaamet</a></li>
<li class="chapter" data-level="8.2.3" data-path="avaandmed.html"><a href="avaandmed.html#digitaalsed-kaardikollektsioonid"><i class="fa fa-check"></i><b>8.2.3</b> Digitaalsed kaardikollektsioonid</a></li>
<li class="chapter" data-level="8.2.4" data-path="avaandmed.html"><a href="avaandmed.html#muu"><i class="fa fa-check"></i><b>8.2.4</b> Muu</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="avaandmed.html"><a href="avaandmed.html#muude-riikide-ruumiandmed"><i class="fa fa-check"></i><b>8.3</b> Muude riikide ruumiandmed</a></li>
<li class="chapter" data-level="8.4" data-path="avaandmed.html"><a href="avaandmed.html#järgmisel-korral-7"><i class="fa fa-check"></i><b>8.4</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="georefereerimine.html"><a href="georefereerimine.html"><i class="fa fa-check"></i><b>9</b> Georefereerimine</a>
<ul>
<li class="chapter" data-level="9.1" data-path="georefereerimine.html"><a href="georefereerimine.html#kaartide-otsimine-ja-allalaadimine"><i class="fa fa-check"></i><b>9.1</b> Kaartide otsimine ja allalaadimine</a></li>
<li class="chapter" data-level="9.2" data-path="georefereerimine.html"><a href="georefereerimine.html#harjutus-1-vana-tartu-kaardi-georefereerimine"><i class="fa fa-check"></i><b>9.2</b> Harjutus 1: vana Tartu kaardi georefereerimine</a></li>
<li class="chapter" data-level="9.3" data-path="georefereerimine.html"><a href="georefereerimine.html#harjutus-2-ajalooline-maakasutus-jägala-mõisa-külades"><i class="fa fa-check"></i><b>9.3</b> Harjutus 2: ajalooline maakasutus Jägala mõisa külades</a></li>
<li class="chapter" data-level="9.4" data-path="georefereerimine.html"><a href="georefereerimine.html#harjutus-3-käsikirjalise-kaardi-georefereerimine"><i class="fa fa-check"></i><b>9.4</b> Harjutus 3: käsikirjalise kaardi georefereerimine</a></li>
<li class="chapter" data-level="9.5" data-path="georefereerimine.html"><a href="georefereerimine.html#veebilahendus"><i class="fa fa-check"></i><b>9.5</b> Veebilahendus</a></li>
<li class="chapter" data-level="9.6" data-path="georefereerimine.html"><a href="georefereerimine.html#järgmisel-korral-8"><i class="fa fa-check"></i><b>9.6</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="avaldised.html"><a href="avaldised.html"><i class="fa fa-check"></i><b>10</b> Avaldised ja päringud</a>
<ul>
<li class="chapter" data-level="10.1" data-path="avaldised.html"><a href="avaldised.html#avaldised-1"><i class="fa fa-check"></i><b>10.1</b> Avaldised</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="avaldised.html"><a href="avaldised.html#harjutused"><i class="fa fa-check"></i><b>10.1.1</b> Harjutused</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="avaldised.html"><a href="avaldised.html#päringud"><i class="fa fa-check"></i><b>10.2</b> Päringud</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="avaldised.html"><a href="avaldised.html#harjutused-1"><i class="fa fa-check"></i><b>10.2.1</b> Harjutused</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="avaldised.html"><a href="avaldised.html#ülesanne-1-ei-olepole-suhtelised-sagedused-murdekorpuses"><i class="fa fa-check"></i><b>10.3</b> Ülesanne 1: “ei ole”/“pole” suhtelised sagedused murdekorpuses</a></li>
<li class="chapter" data-level="10.4" data-path="avaldised.html"><a href="avaldised.html#ülesanne-2-ei-olepole-murdeatlase-levikuandmed"><i class="fa fa-check"></i><b>10.4</b> Ülesanne 2: “ei ole”/“pole” murdeatlase levikuandmed</a></li>
<li class="chapter" data-level="10.5" data-path="avaldised.html"><a href="avaldised.html#ülesanne-3-ei-olepole-selged-eelistused"><i class="fa fa-check"></i><b>10.5</b> Ülesanne 3: “ei ole”/“pole” selged eelistused</a></li>
<li class="chapter" data-level="10.6" data-path="avaldised.html"><a href="avaldised.html#ülesanne-4-tekstiatribuutide-muutmine"><i class="fa fa-check"></i><b>10.6</b> Ülesanne 4: tekstiatribuutide muutmine</a></li>
<li class="chapter" data-level="10.7" data-path="avaldised.html"><a href="avaldised.html#järgmisel-korral-9"><i class="fa fa-check"></i><b>10.7</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html"><i class="fa fa-check"></i><b>11</b> Andmekihtide ühendamine</a>
<ul>
<li class="chapter" data-level="11.1" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#andmestike-ühendamine"><i class="fa fa-check"></i><b>11.1</b> Andmestike ühendamine</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#lisaülesanne"><i class="fa fa-check"></i><b>11.1.1</b> Lisaülesanne</a></li>
<li class="chapter" data-level="11.1.2" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#csv-info-ühendamine-vektorkihiga"><i class="fa fa-check"></i><b>11.1.2</b> CSV info ühendamine vektorkihiga</a></li>
<li class="chapter" data-level="11.1.3" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#vektorkihi-info-ühendamine-csv-ga-punktid"><i class="fa fa-check"></i><b>11.1.3</b> Vektorkihi info ühendamine CSV-ga (punktid)</a></li>
<li class="chapter" data-level="11.1.4" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#csv-ja-vektorkihi-ühendamine-polügoonidega-vektorandmeteks"><i class="fa fa-check"></i><b>11.1.4</b> CSV ja vektorkihi ühendamine polügoonidega vektorandmeteks</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#geokodeerimine"><i class="fa fa-check"></i><b>11.2</b> Geokodeerimine</a></li>
<li class="chapter" data-level="11.3" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#ruumiandmete-omavahel-ühendamine"><i class="fa fa-check"></i><b>11.3</b> Ruumiandmete omavahel ühendamine</a></li>
<li class="chapter" data-level="11.4" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#ruumiandmete-käsitsi-lisamine"><i class="fa fa-check"></i><b>11.4</b> Ruumiandmete käsitsi lisamine</a></li>
<li class="chapter" data-level="11.5" data-path="andmekihtide_yhendamine.html"><a href="andmekihtide_yhendamine.html#järgmisel-korral-10"><i class="fa fa-check"></i><b>11.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="varvid.html"><a href="varvid.html"><i class="fa fa-check"></i><b>12</b> Värvid, sildid ja eksitamine</a>
<ul>
<li class="chapter" data-level="12.1" data-path="varvid.html"><a href="varvid.html#eksitamine"><i class="fa fa-check"></i><b>12.1</b> Eksitamine</a></li>
<li class="chapter" data-level="12.2" data-path="varvid.html"><a href="varvid.html#värvidest"><i class="fa fa-check"></i><b>12.2</b> Värvidest</a></li>
<li class="chapter" data-level="12.3" data-path="varvid.html"><a href="varvid.html#visualiseerimine"><i class="fa fa-check"></i><b>12.3</b> Visualiseerimine</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="varvid.html"><a href="varvid.html#sildid"><i class="fa fa-check"></i><b>12.3.1</b> Sildid</a></li>
<li class="chapter" data-level="12.3.2" data-path="varvid.html"><a href="varvid.html#kaardi-tegemine"><i class="fa fa-check"></i><b>12.3.2</b> Kaardi tegemine</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="varvid.html"><a href="varvid.html#yl12_1"><i class="fa fa-check"></i><b>12.4</b> Ülesanne</a></li>
<li class="chapter" data-level="12.5" data-path="varvid.html"><a href="varvid.html#järgmisel-korral-11"><i class="fa fa-check"></i><b>12.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="maailm.html"><a href="maailm.html"><i class="fa fa-check"></i><b>13</b> Maailma ruumiandmed ja diagrammid</a>
<ul>
<li class="chapter" data-level="13.1" data-path="maailm.html"><a href="maailm.html#euroopa-ja-maailma-andmed"><i class="fa fa-check"></i><b>13.1</b> Euroopa ja maailma andmed</a></li>
<li class="chapter" data-level="13.2" data-path="maailm.html"><a href="maailm.html#euroopa-riikide-filtreerimine"><i class="fa fa-check"></i><b>13.2</b> Euroopa riikide filtreerimine</a></li>
<li class="chapter" data-level="13.3" data-path="maailm.html"><a href="maailm.html#skpin-visualiseerimine"><i class="fa fa-check"></i><b>13.3</b> SKP/in visualiseerimine</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="maailm.html"><a href="maailm.html#ülesanne-polügoonide-värvimine-skpin-põhjal"><i class="fa fa-check"></i><b>13.3.1</b> Ülesanne: polügoonide värvimine SKP/in põhjal</a></li>
<li class="chapter" data-level="13.3.2" data-path="maailm.html"><a href="maailm.html#harjutus-skpin-kohta-diagrammidena-või-punktidena"><i class="fa fa-check"></i><b>13.3.2</b> Harjutus: SKP/in kohta diagrammidena või punktidena</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="maailm.html"><a href="maailm.html#maailma-linnade-punktikiht"><i class="fa fa-check"></i><b>13.4</b> Maailma linnade punktikiht</a></li>
<li class="chapter" data-level="13.5" data-path="maailm.html"><a href="maailm.html#järgmisel-korral-12"><i class="fa fa-check"></i><b>13.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="tekstianalyys.html"><a href="tekstianalyys.html"><i class="fa fa-check"></i><b>14</b> Geograafiline tekstianalüüs (1)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="tekstianalyys.html"><a href="tekstianalyys.html#sammud"><i class="fa fa-check"></i><b>14.1</b> Sammud</a></li>
<li class="chapter" data-level="14.2" data-path="tekstianalyys.html"><a href="tekstianalyys.html#näited"><i class="fa fa-check"></i><b>14.2</b> Näited</a></li>
<li class="chapter" data-level="14.3" data-path="tekstianalyys.html"><a href="tekstianalyys.html#ressursid"><i class="fa fa-check"></i><b>14.3</b> Ressursid</a></li>
<li class="chapter" data-level="14.4" data-path="tekstianalyys.html"><a href="tekstianalyys.html#ülesanded"><i class="fa fa-check"></i><b>14.4</b> Ülesanded</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="tekstianalyys.html"><a href="tekstianalyys.html#geoparserite-katsetamine"><i class="fa fa-check"></i><b>14.4.1</b> Geoparserite katsetamine</a></li>
<li class="chapter" data-level="14.4.2" data-path="tekstianalyys.html"><a href="tekstianalyys.html#kohanimede-tuvastamine"><i class="fa fa-check"></i><b>14.4.2</b> Kohanimede tuvastamine</a></li>
<li class="chapter" data-level="14.4.3" data-path="tekstianalyys.html"><a href="tekstianalyys.html#kohanimede-geokodeerimine"><i class="fa fa-check"></i><b>14.4.3</b> Kohanimede geokodeerimine</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="tekstianalyys.html"><a href="tekstianalyys.html#järgmisel-korral-13"><i class="fa fa-check"></i><b>14.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html"><i class="fa fa-check"></i><b>15</b> Geograafiline tekstianalüüs (2)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#kohanimeüksuste-ja-tekstikatkendite-meelsuse-tuvastamine"><i class="fa fa-check"></i><b>15.1</b> Kohanimeüksuste ja tekstikatkendite meelsuse tuvastamine</a></li>
<li class="chapter" data-level="15.2" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#tekstikatkendi-meelsuse-tuvastamine-excelis"><i class="fa fa-check"></i><b>15.2</b> Tekstikatkendi meelsuse tuvastamine Excelis</a></li>
<li class="chapter" data-level="15.3" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#koordinaatide-lisamine-geokodeerimine"><i class="fa fa-check"></i><b>15.3</b> Koordinaatide lisamine (geokodeerimine)</a></li>
<li class="chapter" data-level="15.4" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#visualiseerimine-1"><i class="fa fa-check"></i><b>15.4</b> Visualiseerimine</a>
<ul>
<li class="chapter" data-level="" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#mainimiste-arv"><i class="fa fa-check"></i>Mainimiste arv</a></li>
<li class="chapter" data-level="" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#emotsioonid"><i class="fa fa-check"></i>Emotsioonid</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="tekstianalyys2.html"><a href="tekstianalyys2.html#järgmisel-korral-14"><i class="fa fa-check"></i><b>15.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="geostatistika1.html"><a href="geostatistika1.html"><i class="fa fa-check"></i><b>16</b> Geostatistika (1)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="geostatistika1.html"><a href="geostatistika1.html#punktimustri-analüüs"><i class="fa fa-check"></i><b>16.1</b> Punktimustri analüüs</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="geostatistika1.html"><a href="geostatistika1.html#punktitihedus"><i class="fa fa-check"></i><b>16.1.1</b> Punktitihedus</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="geostatistika1.html"><a href="geostatistika1.html#ülesanne-1-1"><i class="fa fa-check"></i><b>16.2</b> Ülesanne 1</a></li>
<li class="chapter" data-level="16.3" data-path="geostatistika1.html"><a href="geostatistika1.html#graphical-modeler"><i class="fa fa-check"></i><b>16.3</b> Graphical Modeler</a>
<ul>
<li class="chapter" data-level="" data-path="geostatistika1.html"><a href="geostatistika1.html#sisendid"><i class="fa fa-check"></i>Sisendid</a></li>
<li class="chapter" data-level="" data-path="geostatistika1.html"><a href="geostatistika1.html#funktsioonid"><i class="fa fa-check"></i>Funktsioonid</a></li>
<li class="chapter" data-level="" data-path="geostatistika1.html"><a href="geostatistika1.html#tulemus"><i class="fa fa-check"></i>Tulemus</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="geostatistika1.html"><a href="geostatistika1.html#ruumiline-vastastikmõju"><i class="fa fa-check"></i><b>16.4</b> Ruumiline vastastikmõju</a></li>
<li class="chapter" data-level="16.5" data-path="geostatistika1.html"><a href="geostatistika1.html#ülesanne-2-1"><i class="fa fa-check"></i><b>16.5</b> Ülesanne 2</a></li>
<li class="chapter" data-level="16.6" data-path="geostatistika1.html"><a href="geostatistika1.html#järgmisel-korral-15"><i class="fa fa-check"></i><b>16.6</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="geostatistika2.html"><a href="geostatistika2.html"><i class="fa fa-check"></i><b>17</b> Geostatistika (2)</a>
<ul>
<li class="chapter" data-level="17.1" data-path="geostatistika2.html"><a href="geostatistika2.html#klasterdamine"><i class="fa fa-check"></i><b>17.1</b> Klasterdamine</a></li>
<li class="chapter" data-level="17.2" data-path="geostatistika2.html"><a href="geostatistika2.html#interpoleerimine"><i class="fa fa-check"></i><b>17.2</b> Interpoleerimine</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="geostatistika2.html"><a href="geostatistika2.html#distantsi-kaaluv-interpoleerimine"><i class="fa fa-check"></i><b>17.2.1</b> Distantsi kaaluv interpoleerimine</a></li>
<li class="chapter" data-level="17.2.2" data-path="geostatistika2.html"><a href="geostatistika2.html#ülesanne-1-2"><i class="fa fa-check"></i><b>17.2.2</b> Ülesanne 1</a></li>
<li class="chapter" data-level="17.2.3" data-path="geostatistika2.html"><a href="geostatistika2.html#splain-spline"><i class="fa fa-check"></i><b>17.2.3</b> Splain (<em>Spline</em>)</a></li>
<li class="chapter" data-level="17.2.4" data-path="geostatistika2.html"><a href="geostatistika2.html#ülesanne-2-2"><i class="fa fa-check"></i><b>17.2.4</b> Ülesanne 2</a></li>
<li class="chapter" data-level="17.2.5" data-path="geostatistika2.html"><a href="geostatistika2.html#ülesanne-3"><i class="fa fa-check"></i><b>17.2.5</b> Ülesanne 3</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="geostatistika2.html"><a href="geostatistika2.html#voronoi-polügoonid"><i class="fa fa-check"></i><b>17.3</b> Voronoi polügoonid</a></li>
<li class="chapter" data-level="17.4" data-path="geostatistika2.html"><a href="geostatistika2.html#järgmisel-korral-16"><i class="fa fa-check"></i><b>17.4</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="veebirakendused.html"><a href="veebirakendused.html"><i class="fa fa-check"></i><b>18</b> Veebirakendused, veebimajutus (1)</a>
<ul>
<li class="chapter" data-level="18.1" data-path="veebirakendused.html"><a href="veebirakendused.html#kaardikihid-qgisis"><i class="fa fa-check"></i><b>18.1</b> Kaardikihid QGISis</a></li>
<li class="chapter" data-level="18.2" data-path="veebirakendused.html"><a href="veebirakendused.html#veebikaartide-tegemine"><i class="fa fa-check"></i><b>18.2</b> Veebikaartide tegemine</a></li>
<li class="chapter" data-level="18.3" data-path="veebirakendused.html"><a href="veebirakendused.html#ülesanne"><i class="fa fa-check"></i><b>18.3</b> Ülesanne</a></li>
<li class="chapter" data-level="18.4" data-path="veebirakendused.html"><a href="veebirakendused.html#veebikaartide-majutamine-ja-jagamine"><i class="fa fa-check"></i><b>18.4</b> Veebikaartide majutamine ja jagamine</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="veebirakendused.html"><a href="veebirakendused.html#ülikooli-võrguketas"><i class="fa fa-check"></i><b>18.4.1</b> Ülikooli võrguketas</a></li>
<li class="chapter" data-level="18.4.2" data-path="veebirakendused.html"><a href="veebirakendused.html#github-pages"><i class="fa fa-check"></i><b>18.4.2</b> GitHub Pages</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="veebirakendused.html"><a href="veebirakendused.html#järgmisel-korral-17"><i class="fa fa-check"></i><b>18.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="veebirakendused2.html"><a href="veebirakendused2.html"><i class="fa fa-check"></i><b>19</b> Veebirakendused, veebimajutus (2)</a>
<ul>
<li class="chapter" data-level="19.1" data-path="veebirakendused2.html"><a href="veebirakendused2.html#ajatelje-kasutamine-qgisis"><i class="fa fa-check"></i><b>19.1</b> Ajatelje kasutamine QGISis</a></li>
<li class="chapter" data-level="19.2" data-path="veebirakendused2.html"><a href="veebirakendused2.html#ajadimensioon-mapbox-gl-js-apis"><i class="fa fa-check"></i><b>19.2</b> Ajadimensioon Mapbox GL JS APIs</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="veebirakendused2.html"><a href="veebirakendused2.html#html"><i class="fa fa-check"></i><b>19.2.1</b> HTML</a></li>
<li class="chapter" data-level="19.2.2" data-path="veebirakendused2.html"><a href="veebirakendused2.html#css"><i class="fa fa-check"></i><b>19.2.2</b> CSS</a></li>
<li class="chapter" data-level="19.2.3" data-path="veebirakendused2.html"><a href="veebirakendused2.html#javascript"><i class="fa fa-check"></i><b>19.2.3</b> JavaScript</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="veebirakendused2.html"><a href="veebirakendused2.html#ülesanne-4"><i class="fa fa-check"></i><b>19.3</b> Ülesanne</a></li>
<li class="chapter" data-level="19.4" data-path="veebirakendused2.html"><a href="veebirakendused2.html#lisa"><i class="fa fa-check"></i><b>19.4</b> Lisa</a></li>
<li class="chapter" data-level="19.5" data-path="veebirakendused2.html"><a href="veebirakendused2.html#järgmisel-korral-18"><i class="fa fa-check"></i><b>19.5</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>20</b> Ruumiandmete analüüs R-iga (1)</a>
<ul>
<li class="chapter" data-level="20.1" data-path="r.html"><a href="r.html#miks-teha-kaarte-koodipõhiselt"><i class="fa fa-check"></i><b>20.1</b> Miks teha kaarte koodipõhiselt?</a></li>
<li class="chapter" data-level="20.2" data-path="r.html"><a href="r.html#r-rstudio-ja-r-markdown"><i class="fa fa-check"></i><b>20.2</b> R, RStudio ja R Markdown</a></li>
<li class="chapter" data-level="20.3" data-path="r.html"><a href="r.html#pakettide-installimine"><i class="fa fa-check"></i><b>20.3</b> Pakettide installimine</a></li>
<li class="chapter" data-level="20.4" data-path="r.html"><a href="r.html#kood"><i class="fa fa-check"></i><b>20.4</b> Kood</a></li>
<li class="chapter" data-level="20.5" data-path="r.html"><a href="r.html#andmete-sisselugemine"><i class="fa fa-check"></i><b>20.5</b> Andmete sisselugemine</a></li>
<li class="chapter" data-level="20.6" data-path="r.html"><a href="r.html#kaartide-tegemine"><i class="fa fa-check"></i><b>20.6</b> Kaartide tegemine</a></li>
<li class="chapter" data-level="20.7" data-path="r.html"><a href="r.html#andmete-valimine-1"><i class="fa fa-check"></i><b>20.7</b> Andmete valimine</a></li>
<li class="chapter" data-level="20.8" data-path="r.html"><a href="r.html#andmestike-ühendamine-1"><i class="fa fa-check"></i><b>20.8</b> Andmestike ühendamine</a></li>
<li class="chapter" data-level="20.9" data-path="r.html"><a href="r.html#jooniste-eksportimine"><i class="fa fa-check"></i><b>20.9</b> Jooniste eksportimine</a></li>
<li class="chapter" data-level="20.10" data-path="r.html"><a href="r.html#ülesanne-5"><i class="fa fa-check"></i><b>20.10</b> Ülesanne</a></li>
<li class="chapter" data-level="20.11" data-path="r.html"><a href="r.html#r-i-raamatud-ja-juhendid"><i class="fa fa-check"></i><b>20.11</b> R-i raamatud ja juhendid</a></li>
<li class="chapter" data-level="20.12" data-path="r.html"><a href="r.html#järgmisel-korral-19"><i class="fa fa-check"></i><b>20.12</b> Järgmisel korral</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="r2.html"><a href="r2.html"><i class="fa fa-check"></i><b>21</b> Ruumiandmete analüüs R-iga (2)</a>
<ul>
<li class="chapter" data-level="21.1" data-path="r2.html"><a href="r2.html#staatilised-kaardid"><i class="fa fa-check"></i><b>21.1</b> Staatilised kaardid</a></li>
<li class="chapter" data-level="21.2" data-path="r2.html"><a href="r2.html#shiny-rakendus"><i class="fa fa-check"></i><b>21.2</b> Shiny rakendus</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="r2.html"><a href="r2.html#pakettide-laadimine-ja-andmete-sisselugemine"><i class="fa fa-check"></i><b>21.2.1</b> Pakettide laadimine ja andmete sisselugemine</a></li>
<li class="chapter" data-level="21.2.2" data-path="r2.html"><a href="r2.html#andmete-eeltöötlemine"><i class="fa fa-check"></i><b>21.2.2</b> Andmete eeltöötlemine</a></li>
<li class="chapter" data-level="21.2.3" data-path="r2.html"><a href="r2.html#kasutajaliides"><i class="fa fa-check"></i><b>21.2.3</b> Kasutajaliides</a></li>
<li class="chapter" data-level="21.2.4" data-path="r2.html"><a href="r2.html#server"><i class="fa fa-check"></i><b>21.2.4</b> Server</a></li>
<li class="chapter" data-level="21.2.5" data-path="r2.html"><a href="r2.html#rakenduse-kokkupanemine"><i class="fa fa-check"></i><b>21.2.5</b> Rakenduse kokkupanemine</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="r2.html"><a href="r2.html#rakenduse-jagamine"><i class="fa fa-check"></i><b>21.3</b> Rakenduse jagamine</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kirjandus.html"><a href="kirjandus.html"><i class="fa fa-check"></i>Kirjandus</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r2" class="section level1 hasAnchor" number="21">
<h1><span class="header-section-number">Praktikum 21</span> Ruumiandmete analüüs R-iga (2)<a href="r2.html#r2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Eelmisel korral vaatasime, kuidas R-iga lihtsamaid kaarte teha. See hõlmas</p>
<ul>
<li><strong>vajalike pakettide laadimist</strong>,</li>
</ul>
<pre><code>library(tidyverse)
library(sf)
library(ggspatial)</code></pre>
<ul>
<li><strong>andmete sisselugemist</strong>,</li>
</ul>
<pre><code>kihelkonnad &lt;- st_read(&quot;data/kihelkonnad/kihelkonnad.shp&quot;)</code></pre>
<ul>
<li><strong>andmete filtreerimist</strong>,</li>
</ul>
<pre><code>kihelkonnad %&gt;% 
    filter(Dialect_et == &quot;Saarte&quot;)</code></pre>
<p>või</p>
<pre><code>kihelkonnad %&gt;% filter(Dialect_et == &quot;Saarte&quot;) -&gt; saarte_murre</code></pre>
<p>või</p>
<pre><code>saarte_murre &lt;- kihelkonnad %&gt;% filter(Dialect_et == &quot;Saarte&quot;)</code></pre>
<ul>
<li><strong>andmete visualiseerimist</strong>.</li>
</ul>
<pre><code>ggplot() + 
    geom_sf(data = kihelkonnad)</code></pre>
<p>Sel korral kasutame Eesti filmide andmestikku, teeme paar staatilist kaarti ning vaatame ka, kuidas teha R-is lihtsat rakendust, mis kuvaks andmestiku alamosast kaarti vastavalt kasutaja valikutele. Siin tuleb osata pisut R-i (või juhendeid lugeda), aga mitte näiteks JavaScripti ega HTMLi.</p>
<div id="staatilised-kaardid" class="section level2 hasAnchor" number="21.1">
<h2><span class="header-section-number">21.1</span> Staatilised kaardid<a href="r2.html#staatilised-kaardid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Loeme alustuseks sisse terve <a href="https://efis.ee">efis.ee</a> lehelt korjatud kohamärksõnadega tabeli failist <em>efis_kohad.csv</em>, kus on <strong>kõikide kohtadega seotud filmid</strong>, nende ilmumisaasta ning žanr. Seejärel loeme sisse ka geokodeeritud alamosa suurest tabelist, mida kasutasime 19. praktikumis (<em>efis_eesti.gpkg</em>). Seal olid ainult need Eesti kohanimed, mida esines terves andmestikus kõikide aastate peale <strong>vähemalt 5 korda</strong>. Samuti loeme sisse maakondade kihi, mida saame kasutada aluskaardina (<em>maakond_20221101.shp</em>) või millel kuvada maakonniti filmide arvu.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="r2.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># laadime paketid</span></span>
<span id="cb92-2"><a href="r2.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb92-3"><a href="r2.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="r2.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loeme sisse andmed</span></span>
<span id="cb93-2"><a href="r2.html#cb93-2" aria-hidden="true" tabindex="-1"></a>efis_suur <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;data/efis_kohad.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb93-3"><a href="r2.html#cb93-3" aria-hidden="true" tabindex="-1"></a>efis_eesti <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/efis_eesti.gpkg&quot;</span>)</span>
<span id="cb93-4"><a href="r2.html#cb93-4" aria-hidden="true" tabindex="-1"></a>maakonnad <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/maakond_shp/maakond_20221101.shp&quot;</span>)</span></code></pre></div>
<p>Ühendame kaks EFISe andmestikku nii, et meil ei oleks kaardil võimalik näidata enam mitte ainult üldist infot selle kohta, kui palju filmides teatud aastatel mingeid kohti esines, vaid saaksime kaardil kuvada andmebaasi alamosi ka nt žanri järgi.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="r2.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vaatame EFISe andmestike esimesi ridu</span></span>
<span id="cb94-2"><a href="r2.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(efis_eesti)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 412572.1 ymin: 6447768 xmax: 609980.4 ymax: 6509234
## Projected CRS: Estonian Coordinate System of 1997
##                 koht n aasta1                     geom
## 1        Abruka saar 1   1931 POINT (412572.1 6447768)
## 2        Abruka saar 1   1963 POINT (412572.1 6447768)
## 3        Abruka saar 1   1972 POINT (412572.1 6447768)
## 4        Abruka saar 1   1978 POINT (412572.1 6447768)
## 5        Abruka saar 1   2009 POINT (412572.1 6447768)
## 6 Adavere, Jõgevamaa 1   1965 POINT (609980.4 6509235)</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="r2.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(efis_suur)</span></code></pre></div>
<pre><code>##                         koht                                        pealkiri
## 1 A. Laikmaa tänav (Tallinn)                                     Must Peeter
## 2 A. Laikmaa tänav (Tallinn)                     Tallinna trammid ja trollid
## 3           Aa (Ida-Virumaa) Tootmiskoondise Eesti Põlevkivi pioneerilaagris
## 4          Aachen (Saksamaa)                             Ära mind lahti lase
## 5                    Aafrika                   Jeesus juhatab Sind kiirteele
## 6                    Aafrika                            Oma silm on kuningas
##   aasta                                                     žanr
## 1  2008                                 Mängufilm, Lühimängufilm
## 2  1965          Filmikroonika, Kroonikafilmid 1940 II pool-1991
## 3  1977          Filmikroonika, Kroonikafilmid 1940 II pool-1991
## 4  2019                                          Dokumentaalfilm
## 5  2019                            Mängufilm, Täispikk mängufilm
## 6  2018 Dokumentaalfilm, Olukirjeldusfilm, Film filmi tegemisest</code></pre>
<p>Kasutame ühendamiseks mõlema andmestiku ühist tulpa <strong><em>koht</em></strong>.</p>
<p>Kõigepealt aga tuleb andmestikus <em>efis_suur</em> viia kohanimed kujult <em>Adavere (Jõgevamaa)</em> kujule <em>Adavere, Jõgevamaa</em>, nagu need on geokodeeritud andmestikus.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="r2.html#cb98-1" aria-hidden="true" tabindex="-1"></a>efis_suur <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="r2.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">koht =</span> <span class="fu">gsub</span>(<span class="st">&quot;^(.*) </span><span class="sc">\\</span><span class="st">((.*)</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1, </span><span class="sc">\\</span><span class="st">2&quot;</span>, koht) <span class="sc">%&gt;%</span> <span class="fu">trimws</span>()) <span class="ot">-&gt;</span> efis_suur</span>
<span id="cb98-3"><a href="r2.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Käsku võib lugeda nii, et tee tabelisse &quot;efis_suur&quot; vana tulba &quot;koht&quot; asemele</span></span>
<span id="cb98-4"><a href="r2.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uus tulp &quot;koht&quot; nii, et olemasolevas tulbas võta kirje algusest &#39;^&#39;</span></span>
<span id="cb98-5"><a href="r2.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># kuni sulu ees oleva tühikuni &#39; \\(&#39;</span></span>
<span id="cb98-6"><a href="r2.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># kõik, mis seal on &#39;(.*)&#39; (. &lt;- &quot;ükskõik mis sümbol&quot;, * &lt;- &quot;ükskõik kui mitu korda&quot;),</span></span>
<span id="cb98-7"><a href="r2.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co"># seejärel võta pärast tühikut sulgude seest ükskõik, mis seal on &#39;\\((.*)\\)&#39;</span></span>
<span id="cb98-8"><a href="r2.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ja kleebi need kaks kokku nii, et esimest ja teist osa eraldaks koma ja tühik &#39;\\1, \\2&#39;.</span></span>
<span id="cb98-9"><a href="r2.html#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lõpuks kustuta kirjete eest ja tagant ka võimalikud ebavajalikud tühikud &#39;trimws()&#39;.</span></span>
<span id="cb98-10"><a href="r2.html#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Kirjuta andmestik efis_suur üle nii, et tulp &quot;koht&quot; on seal nüüd mitte sulgude, vaid komaga.</span></span></code></pre></div>
<p>Kuna tahame <em>efis_eesti</em> ruumiandmete kihilt kasutada ainult kohtade nimesid ja koordinaate, salvestame selle osa andmestikust eraldi objekti.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="r2.html#cb99-1" aria-hidden="true" tabindex="-1"></a>efis_eesti_kohad <span class="ot">&lt;-</span> efis_eesti <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="r2.html#cb99-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">select</span>(koht) <span class="sc">%&gt;%</span> <span class="co"># vali tulp &quot;koht&quot;</span></span>
<span id="cb99-3"><a href="r2.html#cb99-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">distinct</span>() <span class="co"># jäta iga unikaalne kirje alles ainult 1 korra</span></span>
<span id="cb99-4"><a href="r2.html#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="r2.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(efis_eesti_kohad)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 1 field
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 412572.1 ymin: 6447768 xmax: 695429 ymax: 6580406
## Projected CRS: Estonian Coordinate System of 1997
##                  koht                     geom
## 1         Abruka saar POINT (412572.1 6447768)
## 2  Adavere, Jõgevamaa POINT (609980.4 6509235)
## 3  Aegviidu, Harjumaa POINT (592497.8 6573457)
## 4      Ahja, Põlvamaa POINT (680762.2 6456218)
## 5  Ahtme, Ida-Virumaa   POINT (695429 6580406)
## 6 Alatskivi, Tartumaa POINT (682119.8 6499849)</code></pre>
<p>Saame andmestiku, kus on 373 unikaalset kohanime koos koordinaatidega.</p>
<p>Ühendame nüüd ruumiandmed (<em>efis_eesti_kohad</em>) ja mitteruumiandmed (<em>efis_suur</em>) funktsiooniga <code>left_join()</code>. Kuna mõlemas tabelis on olemas ühesugused tulbanimed (<em>koht</em>), ühendatakse automaatselt nende tulpade põhjal ja funktsioonis ei pea ühendamiseks kasutatavaid tulbanimesid täpsustama.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="r2.html#cb101-1" aria-hidden="true" tabindex="-1"></a>efis_suur_koord <span class="ot">&lt;-</span> <span class="fu">left_join</span>(efis_eesti_kohad, efis_suur)</span></code></pre></div>
<p>Vaatame, mis juhtus.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="r2.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Andmetabeli esimesed read</span></span>
<span id="cb102-2"><a href="r2.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(efis_suur_koord)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 412572.1 ymin: 6447768 xmax: 609980.4 ymax: 6509234
## Projected CRS: Estonian Coordinate System of 1997
##                 koht                              pealkiri aasta
## 1        Abruka saar        Armastusega Abrukale ja tagasi  2009
## 2        Abruka saar                         Saare kalurid  1978
## 3        Abruka saar                      Kivid ja kadakad  1972
## 4        Abruka saar Moldaavia NSV kunstinädal Eesti NSV-s  1963
## 5        Abruka saar                    Kas tunned maad...  1931
## 6 Adavere, Jõgevamaa      Sensatsiooniline Tartu Kevadbänd  2004
##                                              žanr                     geom
## 1                                     Amatöörfilm POINT (412572.1 6447768)
## 2 Filmikroonika, Kroonikafilmid 1940 II pool-1991 POINT (412572.1 6447768)
## 3               Dokumentaalfilm, Olukirjeldusfilm POINT (412572.1 6447768)
## 4 Filmikroonika, Kroonikafilmid 1940 II pool-1991 POINT (412572.1 6447768)
## 5                                 Dokumentaalfilm POINT (412572.1 6447768)
## 6               Dokumentaalfilm, Olukirjeldusfilm POINT (609980.4 6509235)</code></pre>
<p>Iga suure tabeli kirje, mis leidus ka geokodeeritud andmestikus, sai nüüd juurde ka koordinaadid. Need kirjed, mida geokodeeritud andmestikus ei olnud (u 5000 filmi), jäid ühendamisel loodud andmestikust välja.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="r2.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Millised erinevad žanrikirjed tabelis on? </span></span>
<span id="cb104-2"><a href="r2.html#cb104-2" aria-hidden="true" tabindex="-1"></a>efis_suur_koord <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="r2.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(žanr) <span class="co"># jäta iga unikaalne kirje alles ainult 1 korra</span></span></code></pre></div>
<pre><code>##                                                                                                žanr
## 1                                                                                       Amatöörfilm
## 2                                                   Filmikroonika, Kroonikafilmid 1940 II pool-1991
## 3                                                                 Dokumentaalfilm, Olukirjeldusfilm
## 4                                                                                   Dokumentaalfilm
## 5                                                         Filmikroonika, Kroonikafilmid alates 1992
## 6                                                                             Amatöörfilm, Kroonika
## 7                                                                      Dokumentaalfilm, Portreefilm
## 8                                                                       Dokumentaalfilm, Loodusfilm
## 9                                                                                       Muusikafilm
## 10                                                                           Populaarteaduslik film
## 11                                             Dokumentaalfilm, Muud liigitused, Eksperimentaalfilm
## 12                                  Populaarteaduslik film, Õppefilm, Tellimusfilm, Muud liigitused
## 13 Dokumentaalfilm, Loodusfilm, Probleemfilm, Populaarteaduslik film, Muud liigitused, Tellimusfilm
## 14                                                                    Mängufilm, Täispikk mängufilm
## 15                                                                       Dokumentaalfilm, Vaatefilm
## 16                                                   Filmikroonika, Kroonikafilmid 1912-1940 I pool
## 17                                                   Kroonikafilmid 1912-1940 I pool, Filmikroonika
## 18                                                                 Populaarteaduslik film, Õppefilm
## 19                                                                        Muusikafilm, Kontsertfilm
## 20                                                                    Tellimusfilm, Muud liigitused
## 21                                                         Dokumentaalfilm, Probleemfilm, Vaatefilm
## 22                                                              Dokumentaalfilm, Muusikadokumentaal
## 23                                                                    Dokumentaalfilm, Probleemfilm
## 24                                                   Dokumentaalfilm, Tellimusfilm, Muud liigitused
## 25                                                        Tudengifilm, Harjutusfilm (dokumentaalne)
## 26                                                                     Tudengifilm, Dokumentaalfilm
## 27                                                 Dokumentaalfilm, Portreefilm, Muusikadokumentaal
## 28                                                                   Muud liigitused, Võttematerjal
## 29                                                                         Mängufilm, Lühimängufilm
## 30                                                                       Vaatefilm, Dokumentaalfilm
## 31                                  Õppefilm, Muud liigitused, Tellimusfilm, Populaarteaduslik film
## 32                                 Dokumentaalfilm, Olukirjeldusfilm, Muud liigitused, Tellimusfilm
## 33                                                 Portreefilm, Muusikadokumentaal, Dokumentaalfilm
## 34                                                                     Portreefilm, Dokumentaalfilm
## 35                                                  Kroonikafilmid 1940 II pool-1991, Filmikroonika
## 36                                                                        Kontsertfilm, Muusikafilm
## 37                                                                     Amatöörfilm, Dokumentaalfilm
## 38                                                   Dokumentaalfilm, Muud liigitused, Tellimusfilm
## 39                                                               Dokumentaalfilm, Antropoloogiafilm
## 40                                  Dokumentaalfilm, Vaatefilm, Muud liigitused, Eksperimentaalfilm
## 41                                                                       Tudengifilm, Lühimängufilm
## 42                                                        Dokumentaalfilm, Loodusfilm, Probleemfilm
## 43                                                       Dokumentaalfilm, Portreefilm, Probleemfilm
## 44                                                                           Reklaamfilm, Promofilm
## 45                                  Populaarteaduslik film, Õppefilm, Muud liigitused, Tellimusfilm
## 46                                                        Dokumentaalfilm, Portreefilm, Tudengifilm
## 47                                                          Tudengifilm, Harjutusfilm (lavastuslik)
## 48                                                        Mängufilm, Lühimängufilm, Muud liigitused
## 49                                                                     Dokumentaalfilm, Tudengifilm
## 50                                                                           Amatöörfilm, Mängufilm
## 51                                                            Telemängufilm, Täispikk telemängufilm
## 52                                      Portreefilm, Tellimusfilm, Muud liigitused, Dokumentaalfilm
## 53                                                                    Täispikk mängufilm, Mängufilm
## 54                                             Dokumentaalfilm, Olukirjeldusfilm, Antropoloogiafilm
## 55                                     Dokumentaalfilm, Probleemfilm, Muud liigitused, Tellimusfilm
## 56                                                                           Mängufilm, Amatöörfilm
## 57                                            Populaarteaduslik film, Tellimusfilm, Muud liigitused
## 58                                                                Olukirjeldusfilm, Dokumentaalfilm
## 59      Mängufilm, Lühimängufilm, Dokumentaalfilm, Portreefilm, Muud liigitused, Eksperimentaalfilm
## 60                                                   Muud liigitused, Tellimusfilm, Dokumentaalfilm
## 61                                            Populaarteaduslik film, Muud liigitused, Tellimusfilm
## 62                  Filmikroonika, Kroonikafilmid 1940 II pool-1991, Muud liigitused, Võttematerjal
## 63                                                                    Probleemfilm, Dokumentaalfilm
## 64                                                                          Muusikafilm, Tantsufilm
## 65                                                                            Animafilm, Joonisfilm
## 66                                      Dokumentaalfilm, Portreefilm, Tellimusfilm, Muud liigitused
## 67                                                                 Dokumentaalfilm, Muud liigitused
## 68                                                              Muusikadokumentaal, Dokumentaalfilm
## 69                                            Tellimusfilm, Muud liigitused, Populaarteaduslik film
## 70                                                           Dokumentaalfilm, Loodusfilm, Vaatefilm
## 71                                                                              Animafilm, Nukufilm
## 72                                                Dokumentaalfilm, Portreefilm, Animafilm, Nukufilm
## 73                                     Tellimusfilm, Dokumentaalfilm, Probleemfilm, Muud liigitused
## 74                                  Muud liigitused, Populaarteaduslik film, Õppefilm, Tellimusfilm
## 75                                                                                  Muud liigitused
## 76                                                    Tudengifilm, Lühimängufilm, Reklaam/Promofilm
## 77                                                                    Muud liigitused, Tellimusfilm
## 78                                                         Muusikafilm, Kontsertfilm, Telemängufilm
## 79                                                                                        Mängufilm
## 80                                          Lühimängufilm, Muud liigitused, Tellimusfilm, Mängufilm
## 81                                                        Kroonikafilmid alates 1992, Filmikroonika
## 82                                                   Tellimusfilm, Muud liigitused, Dokumentaalfilm
## 83                                                                              Nukufilm, Animafilm
## 84                                                                      Loodusfilm, Dokumentaalfilm
## 85                                                                    2014 |  Režissöör: Tõnu Virve
## 86                                                       Dokumentaalfilm, Probleemfilm, Tudengifilm
## 87                  Võttematerjal, Filmikroonika, Kroonikafilmid 1940 II pool-1991, Muud liigitused
## 88                                                          Populaarteaduslik film, Dokumentaalfilm
## 89                                                                     Dokumentaalfilm, Muusikafilm
## 90                                                   Dokumentaalfilm, Olukirjeldusfilm, Tudengifilm
## 91                                          Mängufilm, Lühimängufilm, Muud liigitused, Tellimusfilm
## 92                                                          Dokumentaalfilm, Populaarteaduslik film
## 93                                 Tellimusfilm, Dokumentaalfilm, Olukirjeldusfilm, Muud liigitused
## 94                                              Muusikafilm, Tantsufilm, Tudengifilm, Lühimängufilm
## 95                                                                       Lühimängufilm, Tudengifilm
## 96                                                               Tudengifilm, Tehtud välisülikoolis
## 97                                                   Dokumentaalfilm, Loodusfilm, Antropoloogiafilm</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="r2.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mis on kõige sagedamad?</span></span>
<span id="cb106-2"><a href="r2.html#cb106-2" aria-hidden="true" tabindex="-1"></a>efis_suur_koord <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="r2.html#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(žanr) <span class="sc">%&gt;%</span> <span class="co"># loe kokku iga žanri esinemissagedus</span></span>
<span id="cb106-4"><a href="r2.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="co"># järjesta tabel kahanevalt tulba &quot;n&quot; väärtuste järgi</span></span></code></pre></div>
<pre><code>## Simple feature collection with 97 features and 2 fields
## Geometry type: GEOMETRY
## Dimension:     XY
## Bounding box:  xmin: 373567.5 ymin: 6388927 xmax: 738476.1 ymax: 6612672
## Projected CRS: Estonian Coordinate System of 1997
## First 10 features:
##                                               žanr   n
## 1  Filmikroonika, Kroonikafilmid 1940 II pool-1991 881
## 2                                  Dokumentaalfilm 670
## 3                     Dokumentaalfilm, Portreefilm 338
## 4                    Mängufilm, Täispikk mängufilm 131
## 5                    Dokumentaalfilm, Probleemfilm 111
## 6                Dokumentaalfilm, Olukirjeldusfilm 110
## 7                       Dokumentaalfilm, Vaatefilm  88
## 8                            Amatöörfilm, Kroonika  77
## 9   Kroonikafilmid 1912-1940 I pool, Filmikroonika  73
## 10 Kroonikafilmid 1940 II pool-1991, Filmikroonika  61
##                              geom
## 1  MULTIPOINT ((385808.3 64269...
## 2  MULTIPOINT ((373567.5 64731...
## 3  MULTIPOINT ((373567.5 64731...
## 4  MULTIPOINT ((385566.8 64710...
## 5  MULTIPOINT ((385808.3 64269...
## 6  MULTIPOINT ((373567.5 64731...
## 7  MULTIPOINT ((373567.5 64731...
## 8  MULTIPOINT ((397445.8 65317...
## 9  MULTIPOINT ((385566.8 64710...
## 10 MULTIPOINT ((507342.5 64526...</code></pre>
<p>Teeme kaardi.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="r2.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Punktide kaart (ilma aluskaardita)</span></span>
<span id="cb108-2"><a href="r2.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(efis_suur_koord) <span class="sc">+</span></span>
<span id="cb108-3"><a href="r2.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="r2.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kui tahame näidata koordinaate mitte geograafilistes kraadides,</span></span>
<span id="cb109-2"><a href="r2.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vaid projektsiooni ühikutes, võime lisada plussiga lõppu veel kihi</span></span>
<span id="cb109-3"><a href="r2.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># coord_sf(datum = st_crs(efis_suur_koord))</span></span></code></pre></div>
<p>Valime nüüd näiteks ainult need andmestiku punktid, mis käivad selliste kohtade kohta, mida näidati <strong>2021. aasta dokumentaal- ja mängufilmides</strong>. Loeme kokku, mitu korda iga koha puhul erinevaid žanre esines, ja salvestame tulemuse uude muutujasse <em>efis_2021_mngdok</em>. Lisame punktidele alla ka maakondade aluskaardi.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="r2.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aasta on 2021</span></span>
<span id="cb110-2"><a href="r2.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co"># žanri tulp sisaldab järjendit &quot;dokumentaal&quot;, &quot;Dokumentaal&quot;, &quot;mängufilm&quot; või &quot;Mängufilm&quot;</span></span>
<span id="cb110-3"><a href="r2.html#cb110-3" aria-hidden="true" tabindex="-1"></a>efis_suur_koord <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="r2.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(aasta <span class="sc">==</span> <span class="dv">2021</span>, </span>
<span id="cb110-5"><a href="r2.html#cb110-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">grepl</span>(<span class="st">&quot;[dD]okumentaal|[mM]ängufilm&quot;</span>, žanr)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-6"><a href="r2.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(koht, žanr) <span class="ot">-&gt;</span> efis_2021_mngdok</span>
<span id="cb110-7"><a href="r2.html#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="r2.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb110-9"><a href="r2.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad) <span class="sc">+</span> <span class="co"># maakondade aluskaardi kiht</span></span>
<span id="cb110-10"><a href="r2.html#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> efis_2021_mngdok, </span>
<span id="cb110-11"><a href="r2.html#cb110-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">size =</span> n, <span class="at">color =</span> žanr), <span class="co"># suurus esinemise arvu ja värv žanri järgi</span></span>
<span id="cb110-12"><a href="r2.html#cb110-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># teeme punktid läbipaistvamaks</span></span>
<span id="cb110-13"><a href="r2.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span> <span class="co"># ja suuremaks</span></span>
<span id="cb110-14"><a href="r2.html#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co"># lisame mustvalge teema</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>See ei ole kõige mugavam viis neid andmeid vaadata. Võime proovida mingile kindlale alale sisse suumida.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="r2.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb111-2"><a href="r2.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad) <span class="sc">+</span> </span>
<span id="cb111-3"><a href="r2.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> efis_2021_mngdok,</span>
<span id="cb111-4"><a href="r2.html#cb111-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">size =</span> n, <span class="at">color =</span> žanr),</span>
<span id="cb111-5"><a href="r2.html#cb111-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb111-6"><a href="r2.html#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb111-7"><a href="r2.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb111-8"><a href="r2.html#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">st_bbox</span>(maakonnad <span class="sc">%&gt;%</span> </span>
<span id="cb111-9"><a href="r2.html#cb111-9" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">filter</span>(MNIMI <span class="sc">==</span> <span class="st">&quot;Tartu maakond&quot;</span>))[<span class="fu">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>)],</span>
<span id="cb111-10"><a href="r2.html#cb111-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">st_bbox</span>(maakonnad <span class="sc">%&gt;%</span> </span>
<span id="cb111-11"><a href="r2.html#cb111-11" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">filter</span>(MNIMI <span class="sc">==</span> <span class="st">&quot;Tartu maakond&quot;</span>))[<span class="fu">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Võime proovida punkte ka näiteks žanride kaupa eraldi paneelidel kuvada. Kuna aga ühel filmil võib olla mitu kategooriat, tuleks meil filmid esmalt binaarselt klassifitseerida: kui žanri märksõnade hulgas on (muu hulgas) ka sõna <em>Dokumentaal</em> või <em>dokumentaal</em>, klassifitseerime selle dokumentaalfilmiks; kui žanri märksõnade hulgas on (muu hulgas) ka sõna <em>Mängufilm</em> või <em>mängufilm</em>, klassifitseerime selle mängufilmiks. Kasutame selleks juba QGISist tuttavat <em>kui - siis</em> ehk <code>ifelse</code> funktsiooni (QGISis lihtsalt <code>if()</code>).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="r2.html#cb112-1" aria-hidden="true" tabindex="-1"></a>efis_suur_koord <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="r2.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(aasta <span class="sc">==</span> <span class="dv">2021</span>, </span>
<span id="cb112-3"><a href="r2.html#cb112-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">grepl</span>(<span class="st">&quot;[dD]okumentaal|[mM]ängufilm&quot;</span>, žanr)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-4"><a href="r2.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(koht, žanr) <span class="sc">%&gt;%</span></span>
<span id="cb112-5"><a href="r2.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(ž<span class="at">anr_bin =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;[dD]okumentaal&quot;</span>, žanr), <span class="st">&quot;dokumentaal&quot;</span>, <span class="st">&quot;mängufilm&quot;</span>)) <span class="ot">-&gt;</span> efis_2021_mngdok_bin</span>
<span id="cb112-6"><a href="r2.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="r2.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb112-8"><a href="r2.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad) <span class="sc">+</span></span>
<span id="cb112-9"><a href="r2.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> efis_2021_mngdok_bin, </span>
<span id="cb112-10"><a href="r2.html#cb112-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">size =</span> n, <span class="at">color =</span> žanr_bin), </span>
<span id="cb112-11"><a href="r2.html#cb112-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb112-12"><a href="r2.html#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span> </span>
<span id="cb112-13"><a href="r2.html#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb112-14"><a href="r2.html#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">&quot;žanr_bin&quot;</span>) <span class="co"># jagame andmed žanri tulba järgi eri paneelidele</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>Loeme kokku, mitu punkti igasse maakonda jääb, ja värvime maakonnad vastavalt punktide arvule. Lugemata jäävad praegu punktid, mille koordinaadid ei jää maismaa peale. Esmalt peame mõlema andmekihi CRSi täpselt ühesuguseks muutma (<code>st_transform()</code>).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="r2.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># muudame efis_suur_koord CRSi täpselt samaks, mis on kihil maakonnad</span></span>
<span id="cb113-2"><a href="r2.html#cb113-2" aria-hidden="true" tabindex="-1"></a>efis_suur_koord <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(efis_suur_koord, <span class="at">crs =</span> <span class="fu">st_crs</span>(maakonnad))</span>
<span id="cb113-3"><a href="r2.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="r2.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># leiame, palju efis_suur_koord punkte iga maakonna piiridesse jääb</span></span>
<span id="cb113-5"><a href="r2.html#cb113-5" aria-hidden="true" tabindex="-1"></a>maakonnad <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="r2.html#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">punkte =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(maakonnad, efis_suur_koord))) <span class="ot">-&gt;</span> maakonnad</span>
<span id="cb113-7"><a href="r2.html#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="r2.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb113-9"><a href="r2.html#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad, <span class="fu">aes</span>(<span class="at">fill =</span> punkte)) <span class="sc">+</span></span>
<span id="cb113-10"><a href="r2.html#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">&quot;log&quot;</span>) <span class="sc">+</span> <span class="co"># suurendame erinevusi väiksemate väärtuste vahel</span></span>
<span id="cb113-11"><a href="r2.html#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>Võime lõpetuseks lisada maakondade polügoonidele ka sildid, mis ütlevad täpselt, kui mitu punkti sellesse maakonda jääb.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="r2.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb114-2"><a href="r2.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad, <span class="fu">aes</span>(<span class="at">fill =</span> punkte)) <span class="sc">+</span></span>
<span id="cb114-3"><a href="r2.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_label</span>(<span class="at">data =</span> maakonnad, <span class="fu">aes</span>(<span class="at">label =</span> punkte), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb114-4"><a href="r2.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">&quot;log&quot;</span>) <span class="sc">+</span> </span>
<span id="cb114-5"><a href="r2.html#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>Salvestame faili <em>efis_suur_koord</em> kihi faili funktsiooniga <code>st_write</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="r2.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(efis_suur_koord, <span class="st">&quot;data/efis_suur_koord.gpkg&quot;</span>, <span class="at">crs =</span> <span class="dv">3301</span>)</span></code></pre></div>
</div>
<div id="shiny-rakendus" class="section level2 hasAnchor" number="21.2">
<h2><span class="header-section-number">21.2</span> Shiny rakendus<a href="r2.html#shiny-rakendus" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R-is saab interaktiivsete rakenduste tegemiseks kasutada <strong><a href="https://shiny.rstudio.com/">Shiny</a></strong> paketti. Kui sinu RStudios ei ole veel Shiny võimalust, tuleb pakett esmalt installida.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="r2.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trüki konsooli</span></span>
<span id="cb116-2"><a href="r2.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">&quot;shiny&quot;</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">&quot;shiny&quot;</span>)</span>
<span id="cb116-3"><a href="r2.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Käsus kontrollitakse, kas shiny pakett sisaldub</span></span>
<span id="cb116-4"><a href="r2.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># installitud pakettide nimede hulgas</span></span>
<span id="cb116-5"><a href="r2.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ning kui ei sisaldu (hüüumärki kasutatakse mingi tingimuse eitamiseks),</span></span>
<span id="cb116-6"><a href="r2.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co"># siis installitakse.</span></span></code></pre></div>
<p>Seejärel valime <em>File → New File → Shiny Web App</em>, anname oma rakendusele nime (nt <em>efis_shiny</em> vmt) ning jätame rakenduse tüübi (<em>Application type</em>) valikuks <em>Single File</em>. See tähendab, et nii kasutajaliides (<em>ui</em> - <em>user interface</em> e see osa, mida kasutaja näeb ja mille abil rakendusega suhtleb) kui ka serveri loogika (<em>server</em> - see osa, mis vastavalt kasutaja valikutele tegelikult andmetega midagi teeb) on ühes R-i failis koos ning selle faili nimi on <em>app.R</em>.<br />
<em>Multiple File</em> tähendaks, et ühes failis on kasutajaliidese osa ning teises serveri osa ning kui tahta rakendust kasutada, peavad olemas olema mõlemad failid.
Kasutuses kahel variandil praktiliselt vahet ei ole.</p>
<p>Valime ka kausta, milles tahame oma rakendust hoida. Selle kausta sisse tekib omakorda kaust rakenduse nimega (nt <em>efis_shiny</em>), mille sees on fail <em>app.R</em> ja mille sisse võiksid minna ka kõik rakenduses kasutatavad failid (nt tabelandmestikud, ruumiandete failid, pildid jm).</p>
<p>Avaneb fail <strong><em>app.R</em></strong>, kus on juba valmis põhi, mille sisse saab oma rakendust kirjutada. Vaikimisi põhi on tehtud <a href="https://et.wikipedia.org/wiki/Histogramm">histogrammi</a> joonistamiseks. Vajutame rohelise noolekesega nupul <em>Run App</em>. Võib valida ka <em>Run in Viewer Pane</em>, et kuvada rakendust RStudio enda keskkonnas.
Kui tahta nüüd näha rakenduse endaga paralleelselt koodi, millega rakendus on tehtud, võib trükkida konsooli <code>runExample("01_hello", display.mode = "showcase")</code>.</p>
<p>Rakenduse minimaalne nõutud struktuur koosneb neljast-viiest osast ning näeb välja selline (trellidega on tähistatud kommentaarid):</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="r2.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Rakenduse töötamiseks vajaliku shiny paketi laadimine.</span></span>
<span id="cb117-2"><a href="r2.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Siin saab sisse lugeda ka teised paketid,</span></span>
<span id="cb117-3"><a href="r2.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vajalikud andmed ning neid andmeid vajadusel töödelda.</span></span>
<span id="cb117-4"><a href="r2.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny) </span>
<span id="cb117-5"><a href="r2.html#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="r2.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Vahepeal võib veel andmeid töödelda.</span></span>
<span id="cb117-7"><a href="r2.html#cb117-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-8"><a href="r2.html#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Kasutajaliides</span></span>
<span id="cb117-9"><a href="r2.html#cb117-9" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb117-10"><a href="r2.html#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Siin saab defineerida, kuidas kasutajaliides välja näeb, sh</span></span>
<span id="cb117-11"><a href="r2.html#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># kus ja kuidas lasta kasutajal teha mingeid valikuid,</span></span>
<span id="cb117-12"><a href="r2.html#cb117-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># milliseid valikuid kasutaja teha saab </span></span>
<span id="cb117-13"><a href="r2.html#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (nt filtreerida algandmetest mingeid andmeid, </span></span>
<span id="cb117-14"><a href="r2.html#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># muuta mingitel väljundi elementidel värvi, </span></span>
<span id="cb117-15"><a href="r2.html#cb117-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># kujundeid, teksti suurust, väljundit salvestada jne),</span></span>
<span id="cb117-16"><a href="r2.html#cb117-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># milline on kasutaja valikute põhjal genereeritud väljund </span></span>
<span id="cb117-17"><a href="r2.html#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (nt kaart, tabel, joonis, tekst jne)</span></span>
<span id="cb117-18"><a href="r2.html#cb117-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ja kus see paikneb.</span></span>
<span id="cb117-19"><a href="r2.html#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fluidPage() teeb lehe, mis kohandub kasutaja brauseriakna suurusega,</span></span>
<span id="cb117-20"><a href="r2.html#cb117-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fixedPage() teeb lehe, mis on vaikimisi 940 piksli laiune.</span></span>
<span id="cb117-21"><a href="r2.html#cb117-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb117-22"><a href="r2.html#cb117-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-23"><a href="r2.html#cb117-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Serveri loogika</span></span>
<span id="cb117-24"><a href="r2.html#cb117-24" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output){</span>
<span id="cb117-25"><a href="r2.html#cb117-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Siin saab defineerida, mida rakendus kasutaja valikute põhjal teeb </span></span>
<span id="cb117-26"><a href="r2.html#cb117-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ning kuidas soovitud väljundini jõuda, </span></span>
<span id="cb117-27"><a href="r2.html#cb117-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nt kui kasutaja valib A, siis tehakse väljund niisugustest andmetest,</span></span>
<span id="cb117-28"><a href="r2.html#cb117-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># kui kasutaja valib B, siis tehakse väljund naasugustest andmetest jne,</span></span>
<span id="cb117-29"><a href="r2.html#cb117-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># väljund ise on kaart.</span></span>
<span id="cb117-30"><a href="r2.html#cb117-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-31"><a href="r2.html#cb117-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-32"><a href="r2.html#cb117-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Rakenduse kokkupanemine</span></span>
<span id="cb117-33"><a href="r2.html#cb117-33" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>Vaatame nüüd rakenduse struktuuri lähemalt ning teeme ise ühe lihtsa rakenduse, mis</p>
<ul>
<li>võtaks sisendiks failid <em>maakond_20221101.shp</em> (polügoonid) ja <em>efis_suur_koord.gpkg</em> (punktid),<br />
</li>
<li>laseks kasutajal valida, mis aastatest ja mis žanrist filmide kohti näidata ning kas näidata neid punktikaardil või horopleetkaardil. Lisaks näitab rakendus ka kasutaja tehtud valikuid ning valitud alamandmestikku tabeli kujul.</li>
</ul>
<p>Võib kasutada vaikimisi avatud rakenduse malli, ent sel juhul peab ära kustutama kommentaarid ning <em>ui</em>- ja <em>server</em>-funktsioonide sisu.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="r2.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb118-2"><a href="r2.html#cb118-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>()</span>
<span id="cb118-3"><a href="r2.html#cb118-3" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output){}</span>
<span id="cb118-4"><a href="r2.html#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>Asetame rakenduse kausta (kus on fail <em>app.R</em>) ka vajalikud failid (<em>maakond_shp/maakond_20221101.shp</em> ja <em>efis_suur_koord.gpkg</em>).</p>
<div id="pakettide-laadimine-ja-andmete-sisselugemine" class="section level3 hasAnchor" number="21.2.1">
<h3><span class="header-section-number">21.2.1</span> Pakettide laadimine ja andmete sisselugemine<a href="r2.html#pakettide-laadimine-ja-andmete-sisselugemine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kõigepealt võiks faili päisesse lisada kommentaarid (kõik #-märkidega read on kommentaarid) selle kohta, mida rakendus teeb, milliseid faile ja pakette kasutab ning kes ja millal on rakenduse teinud. Kommentaarid rakenduses kuskil näha ei jää ega ole rakenduse töötamise seisukohast olulised.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="r2.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See rakendus kuvab veebikaardi Eesti filmidega seotud kohtadest erinevatel aastatel.</span></span>
<span id="cb119-2"><a href="r2.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lisaks näidatakse konkreetse ajavahemiku ja žanriga seotud filmide andmeid tabelis.</span></span>
<span id="cb119-3"><a href="r2.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb119-4"><a href="r2.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rakenduse sisendfailideks on</span></span>
<span id="cb119-5"><a href="r2.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># maakond_20221101.shp ja efis_suur_koord.gpkg.</span></span>
<span id="cb119-6"><a href="r2.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb119-7"><a href="r2.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Rakendus kasutab pakette shiny, sf ja tidyverse (sh ggplot2 ja dplyr).</span></span>
<span id="cb119-8"><a href="r2.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb119-9"><a href="r2.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Maarja-Liisa Pilvik</span></span>
<span id="cb119-10"><a href="r2.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 28.11.2022</span></span></code></pre></div>
<p>Järgmiseks laadime rakenduse töötamiseks vajalikud paketid. Kuna vaikimisi avaneval rakendusel pole aimugi, mida rakendusega päriselt tegema hakatakse, on tema ainukeseks nõudeks see, et <em>shiny</em> pakett oleks installitud ja laaditud.<br />
Meie laadime lisaks <code>shiny</code>-paketile ka paketid <code>sf</code> ja <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="r2.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------#</span></span>
<span id="cb120-2"><a href="r2.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---1. Laadime paketid ja loeme sisse andmed---####</span></span>
<span id="cb120-3"><a href="r2.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------#</span></span>
<span id="cb120-4"><a href="r2.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Paketid</span></span>
<span id="cb120-5"><a href="r2.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny) <span class="co"># vajalik rakenduse töötamiseks</span></span>
<span id="cb120-6"><a href="r2.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co"># vajalik ruumiandmete sisselugemiseks ja analüüsiks</span></span>
<span id="cb120-7"><a href="r2.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># sisaldab paketti ggplot2 (visualiseerimiseks) ning </span></span>
<span id="cb120-8"><a href="r2.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr ja tidyr (andmetöötluseks)</span></span></code></pre></div>
<p>Loeme sisse ka rakenduses kasutatavad andmed ning töötleme neid selleks, et saada sobivam failistruktuur.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="r2.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Andmed</span></span>
<span id="cb121-2"><a href="r2.html#cb121-2" aria-hidden="true" tabindex="-1"></a>maakonnad <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;maakond_shp/maakond_20221101.shp&quot;</span>)</span>
<span id="cb121-3"><a href="r2.html#cb121-3" aria-hidden="true" tabindex="-1"></a>efis <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;efis_suur_koord.gpkg&quot;</span>)</span></code></pre></div>
</div>
<div id="andmete-eeltöötlemine" class="section level3 hasAnchor" number="21.2.2">
<h3><span class="header-section-number">21.2.2</span> Andmete eeltöötlemine<a href="r2.html#andmete-eeltöötlemine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="r2.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------#</span></span>
<span id="cb122-2"><a href="r2.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---2. Eeltöötleme andmeid---####</span></span>
<span id="cb122-3"><a href="r2.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------#</span></span>
<span id="cb122-4"><a href="r2.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Eraldame kõik võimalikud kategooriad, mille järgi otsida</span></span>
<span id="cb122-5"><a href="r2.html#cb122-5" aria-hidden="true" tabindex="-1"></a>efis<span class="sc">$</span>žanr <span class="sc">%&gt;%</span> <span class="co"># võtame tabelist ainult žanri tulba</span></span>
<span id="cb122-6"><a href="r2.html#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="st">&quot;,&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># lõikame kategooriad koma koha pealt tükkideks</span></span>
<span id="cb122-7"><a href="r2.html#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="co"># teeme saadud listist vektori (= tavalise loendi)</span></span>
<span id="cb122-8"><a href="r2.html#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>() <span class="sc">%&gt;%</span> <span class="co"># kustutame kategooriate eest ja tagant ära üleliigsed tühikud</span></span>
<span id="cb122-9"><a href="r2.html#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> <span class="co"># teeme kõik kategooriad väiketähelisteks</span></span>
<span id="cb122-10"><a href="r2.html#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">(&quot;</span>, <span class="st">&quot;-&quot;</span>, .) <span class="sc">%&gt;%</span> <span class="co"># asendame alustava sulu sidekriipsuga</span></span>
<span id="cb122-11"><a href="r2.html#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;-&quot;</span>, .) <span class="sc">%&gt;%</span> <span class="co"># asendame lõpetava sulu sidekriipsuga</span></span>
<span id="cb122-12"><a href="r2.html#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="co"># jätame iga kategooria kohta alles ainult ühe unikaalse kirje</span></span>
<span id="cb122-13"><a href="r2.html#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>() <span class="sc">%&gt;%</span> <span class="co"># järjestame kategooriad tähestiku järjekorras kasvavalt</span></span>
<span id="cb122-14"><a href="r2.html#cb122-14" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">-</span><span class="dv">1</span>] <span class="ot">-&gt;</span> kategooriad <span class="co"># eemaldame esimese sodikategooria ja salvestame loetelu muutujasse &quot;kategooriad&quot;</span></span>
<span id="cb122-15"><a href="r2.html#cb122-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-16"><a href="r2.html#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Ühendame dokumentaalfilmid, mängufilmid, kroonikad</span></span>
<span id="cb122-17"><a href="r2.html#cb122-17" aria-hidden="true" tabindex="-1"></a>kategooriad[<span class="fu">grepl</span>(<span class="st">&quot;dokumentaal&quot;</span>, kategooriad)] <span class="ot">&lt;-</span> <span class="st">&quot;dokumentaal&quot;</span></span>
<span id="cb122-18"><a href="r2.html#cb122-18" aria-hidden="true" tabindex="-1"></a>kategooriad[<span class="fu">grepl</span>(<span class="st">&quot;mängufilm&quot;</span>, kategooriad)] <span class="ot">&lt;-</span> <span class="st">&quot;mängufilm&quot;</span></span>
<span id="cb122-19"><a href="r2.html#cb122-19" aria-hidden="true" tabindex="-1"></a>kategooriad[<span class="fu">grepl</span>(<span class="st">&quot;kroonika&quot;</span>, kategooriad)] <span class="ot">&lt;-</span> <span class="st">&quot;kroonika&quot;</span></span>
<span id="cb122-20"><a href="r2.html#cb122-20" aria-hidden="true" tabindex="-1"></a>kategooriad <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="ot">-&gt;</span> kategooriad <span class="co"># jätame alles jälle anult unikaalsed kirjed</span></span>
<span id="cb122-21"><a href="r2.html#cb122-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-22"><a href="r2.html#cb122-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Teeme ka filmide andmestikus žanrid väiketäheliseks ja asendame sulud</span></span>
<span id="cb122-23"><a href="r2.html#cb122-23" aria-hidden="true" tabindex="-1"></a>efis <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(ž<span class="at">anr =</span> <span class="fu">tolower</span>(žanr) <span class="sc">%&gt;%</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">(&quot;</span>, <span class="st">&quot;-&quot;</span>, .) <span class="sc">%&gt;%</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;-&quot;</span>, .)) <span class="ot">-&gt;</span> efis</span>
<span id="cb122-24"><a href="r2.html#cb122-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-25"><a href="r2.html#cb122-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Võtame aastast ainult 4 esimest numbrit ja teeme selle arvuliseks tunnuseks</span></span>
<span id="cb122-26"><a href="r2.html#cb122-26" aria-hidden="true" tabindex="-1"></a>efis <span class="sc">%&gt;%</span></span>
<span id="cb122-27"><a href="r2.html#cb122-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aasta =</span> <span class="fu">substr</span>(aasta, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()) <span class="ot">-&gt;</span> efis</span>
<span id="cb122-28"><a href="r2.html#cb122-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-29"><a href="r2.html#cb122-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Määrame efise kihile täpselt sama CRSi, mis maakondadel</span></span>
<span id="cb122-30"><a href="r2.html#cb122-30" aria-hidden="true" tabindex="-1"></a>efis <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(efis, <span class="at">crs =</span> <span class="fu">st_crs</span>(maakonnad))</span></code></pre></div>
</div>
<div id="kasutajaliides" class="section level3 hasAnchor" number="21.2.3">
<h3><span class="header-section-number">21.2.3</span> Kasutajaliides<a href="r2.html#kasutajaliides" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Edasi tuleb kasutajaliidese (<em>ui</em>) osa, mis määrab ära selle, kuidas kasutaja rakendust näeb. Kasutajaliides moodustub hierarhilistest funktsioonidest (funktsioonid tähistatud sulgudega, mille sees täpsustatakse funktsioonide argumente).<br />
Meie teeme lihtsa kasutajaliidese, kus on</p>
<ul>
<li>rakenduse pealkiri (<code>titlePanel</code>);<br />
</li>
<li>menüü, kus saab valida
<ul>
<li>rippmenüüs (<code>selectInput</code>) žanri, mille filmide kohti kaardil kuvada;<br />
</li>
<li>liuguril (<code>sliderInput</code>) aastate vahemiku, millest filmide kohti kaardil kuvada;<br />
</li>
<li>valikunuppudega (<code>radioButtons</code>) selle, kas kuvada punktikaarti või horopleetkaarti;<br />
</li>
</ul></li>
<li>väljundi ala, kus kuvatakse kasutaja valikuid (<code>verbatimTextOutput</code>);<br />
</li>
<li>väljundi ala, kus näidatakse kasutaja valikutest sõltuvalt kaarti (<code>plotOutput</code>);<br />
</li>
<li>väljundi ala, kus näidatakse kasutaja valikutest sõltuvalt andmetabelit (<code>dataTableOutput</code>).</li>
</ul>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="r2.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------#</span></span>
<span id="cb123-2"><a href="r2.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---3. Ehitame rakenduse kasutajaliidese---####</span></span>
<span id="cb123-3"><a href="r2.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------#</span></span>
<span id="cb123-4"><a href="r2.html#cb123-4" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>( <span class="co"># teeme brauseri akna suurusega sobituva lehekülje, kus on...</span></span>
<span id="cb123-5"><a href="r2.html#cb123-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-6"><a href="r2.html#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">titlePanel</span>(<span class="st">&quot;Eesti filmide kohad&quot;</span>), <span class="co"># rakenduse pealkiri</span></span>
<span id="cb123-7"><a href="r2.html#cb123-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-8"><a href="r2.html#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fluidRow</span>( <span class="co"># rida, kus on kõik kasutaja sisendid:</span></span>
<span id="cb123-9"><a href="r2.html#cb123-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">4</span>, <span class="co"># kolmandikul kogu akna laiusest</span></span>
<span id="cb123-10"><a href="r2.html#cb123-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">selectInput</span>( <span class="co"># valiku rippmenüü</span></span>
<span id="cb123-11"><a href="r2.html#cb123-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">&quot;genre&quot;</span>, <span class="co"># millele viitame edaspidi nimega &quot;genre&quot;</span></span>
<span id="cb123-12"><a href="r2.html#cb123-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">&quot;Vali žanr:&quot;</span>, <span class="co"># mille juures on juhis &quot;Vali žanr:&quot;</span></span>
<span id="cb123-13"><a href="r2.html#cb123-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, kategooriad), <span class="co"># rippmenüüs on tühi valik + kategooriate loend</span></span>
<span id="cb123-14"><a href="r2.html#cb123-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="st">&quot;&quot;</span>, <span class="co"># vaikimisi on valitud tühi valik</span></span>
<span id="cb123-15"><a href="r2.html#cb123-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">multiple =</span> <span class="cn">FALSE</span>) <span class="co"># mitut kategooriat korraga ei saa valida</span></span>
<span id="cb123-16"><a href="r2.html#cb123-16" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb123-17"><a href="r2.html#cb123-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">4</span>, <span class="co"># teisel kolmandikul kogu akna laiusest on</span></span>
<span id="cb123-18"><a href="r2.html#cb123-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">sliderInput</span>( <span class="co"># liugur</span></span>
<span id="cb123-19"><a href="r2.html#cb123-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">inputId =</span> <span class="st">&quot;year&quot;</span>, <span class="co"># millele viitame edaspidi nimega &quot;year&quot;</span></span>
<span id="cb123-20"><a href="r2.html#cb123-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label =</span> <span class="st">&quot;Vali aasta(d):&quot;</span>, <span class="co"># mille juures on juhis &quot;Vali aasta(d):&quot;</span></span>
<span id="cb123-21"><a href="r2.html#cb123-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fu">min</span>(efis<span class="sc">$</span>aasta), <span class="co"># mille vähim valitav väärtus on varaseim aasta</span></span>
<span id="cb123-22"><a href="r2.html#cb123-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max =</span> <span class="fu">max</span>(efis<span class="sc">$</span>aasta), <span class="co"># mille suurim valitav väärtus on hiliseim aasta</span></span>
<span id="cb123-23"><a href="r2.html#cb123-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">c</span>(<span class="fu">min</span>(efis<span class="sc">$</span>aasta), <span class="co"># vaikimisi on valitud kogu liuguri ulatus</span></span>
<span id="cb123-24"><a href="r2.html#cb123-24" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">max</span>(efis<span class="sc">$</span>aasta)), <span class="co"># (siin 1921-2021)</span></span>
<span id="cb123-25"><a href="r2.html#cb123-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) <span class="co"># ära näita aastaarvudes tuhandete eraldajaid (nt 1,921)</span></span>
<span id="cb123-26"><a href="r2.html#cb123-26" aria-hidden="true" tabindex="-1"></a>              ),</span>
<span id="cb123-27"><a href="r2.html#cb123-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">4</span>, <span class="co"># viimasel kolmandikul kogu akna laiusest on</span></span>
<span id="cb123-28"><a href="r2.html#cb123-28" aria-hidden="true" tabindex="-1"></a>               <span class="fu">radioButtons</span>( <span class="co"># valikunupud</span></span>
<span id="cb123-29"><a href="r2.html#cb123-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">&quot;type&quot;</span>, <span class="co"># millele viitame edaspidi nimega &quot;type&quot;</span></span>
<span id="cb123-30"><a href="r2.html#cb123-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">&quot;Vali kaarditüüp:&quot;</span>, <span class="co"># mille juures on juhis &quot;Vali kaarditüüp:&quot;</span></span>
<span id="cb123-31"><a href="r2.html#cb123-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;punktid&quot;</span>, <span class="st">&quot;horopleetkaart&quot;</span>), <span class="co"># võimalikud valikud</span></span>
<span id="cb123-32"><a href="r2.html#cb123-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="st">&quot;punktid&quot;</span>) <span class="co"># vaikimisi on valitud punktikaart</span></span>
<span id="cb123-33"><a href="r2.html#cb123-33" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb123-34"><a href="r2.html#cb123-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb123-35"><a href="r2.html#cb123-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-36"><a href="r2.html#cb123-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hr</span>(), <span class="co"># horisontaalne eraldusjoon, mille all on...</span></span>
<span id="cb123-37"><a href="r2.html#cb123-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-38"><a href="r2.html#cb123-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">verbatimTextOutput</span>(<span class="st">&quot;valik&quot;</span>), <span class="co"># väljund, mis näitab kasutaja tehtud valikuid tekstina</span></span>
<span id="cb123-39"><a href="r2.html#cb123-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-40"><a href="r2.html#cb123-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabsetPanel</span>( <span class="co"># vahekaartide paneel</span></span>
<span id="cb123-41"><a href="r2.html#cb123-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tabPanel</span>( <span class="co"># esimesel vahekaardil on</span></span>
<span id="cb123-42"><a href="r2.html#cb123-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Kaart&quot;</span>, <span class="co"># pealkiri &quot;Kaart&quot;</span></span>
<span id="cb123-43"><a href="r2.html#cb123-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">plotOutput</span>( <span class="co"># ja graafik, mis näitab kohtade jaotumist Eesti kaardil</span></span>
<span id="cb123-44"><a href="r2.html#cb123-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">outputId =</span> <span class="st">&quot;map&quot;</span> <span class="co"># viitame sellele edaspidi nimega &quot;map&quot;</span></span>
<span id="cb123-45"><a href="r2.html#cb123-45" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb123-46"><a href="r2.html#cb123-46" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb123-47"><a href="r2.html#cb123-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tabPanel</span>( <span class="co"># teisel vahekaardil on</span></span>
<span id="cb123-48"><a href="r2.html#cb123-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Tabel&quot;</span>, <span class="co"># pealkiri &quot;Tabel&quot;</span></span>
<span id="cb123-49"><a href="r2.html#cb123-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">dataTableOutput</span>( <span class="co"># ja tabel, mis näitab küsitud tabeli alamosa</span></span>
<span id="cb123-50"><a href="r2.html#cb123-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">outputId =</span> <span class="st">&quot;tab&quot;</span> <span class="co"># viitame sellele edaspidi nimega &quot;tab&quot;</span></span>
<span id="cb123-51"><a href="r2.html#cb123-51" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb123-52"><a href="r2.html#cb123-52" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb123-53"><a href="r2.html#cb123-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb123-54"><a href="r2.html#cb123-54" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Meie rakendusel on niisiis 3 sisendit (<code>genre</code>, <code>year</code> ja <code>type</code>) ja 3 väljundit (<code>valik</code>, <code>map</code> ja <code>tab</code>).</p>
<p>Teisi võimalikke sisendi (<em>input</em>) ja väljundi (<em>output</em>) tüüpe saad näha nt <a href="https://shiny.rstudio.com/images/shiny-cheatsheet.pdf">siin</a>.</p>
</div>
<div id="server" class="section level3 hasAnchor" number="21.2.4">
<h3><span class="header-section-number">21.2.4</span> Server<a href="r2.html#server" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Järgmiseks defineerime selle, mis juhtub, kui kasutaja mingeid valikuid teeb.</p>
<p>Kasutajaliidese <code>Input</code>-klassi elementidele viidatakse serveriosas dollarimärgi ja omistatud id-ga kujul <code>input$...</code> (nt <code>input$genre</code> või <code>input$year</code>). <code>Output</code>-klassi elementidele viidatakse kujul <code>output$...</code> (nt <code>output$map</code>). Kõiki väljundeid peab kuidagi tekitama (<em>render</em>), nt <code>renderText</code>, <code>renderPlot</code>, <code>renderDataTable</code>.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="r2.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------#</span></span>
<span id="cb124-2"><a href="r2.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---4. Ehitame rakenduse sisu---####</span></span>
<span id="cb124-3"><a href="r2.html#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------#</span></span>
<span id="cb124-4"><a href="r2.html#cb124-4" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output){</span>
<span id="cb124-5"><a href="r2.html#cb124-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-6"><a href="r2.html#cb124-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kõigepealt teeme funktsiooni, mis reageerib kasutaja sisendi valikutele</span></span>
<span id="cb124-7"><a href="r2.html#cb124-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ja filtreerib andmebaasist soovitud read</span></span>
<span id="cb124-8"><a href="r2.html#cb124-8" aria-hidden="true" tabindex="-1"></a>    andmed <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb124-9"><a href="r2.html#cb124-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(input<span class="sc">$</span>genre <span class="sc">!=</span> <span class="st">&quot;&quot;</span>){ <span class="co"># kui žanri valik ei ole tühi</span></span>
<span id="cb124-10"><a href="r2.html#cb124-10" aria-hidden="true" tabindex="-1"></a>            efis <span class="sc">%&gt;%</span> <span class="co"># võta efise andmebaas</span></span>
<span id="cb124-11"><a href="r2.html#cb124-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>( <span class="co"># ja filtreeri sealt välja read, kus</span></span>
<span id="cb124-12"><a href="r2.html#cb124-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">grepl</span>(input<span class="sc">$</span>genre, žanr), <span class="co"># žanri tulp sisaldaks (mh) küsitud žanri</span></span>
<span id="cb124-13"><a href="r2.html#cb124-13" aria-hidden="true" tabindex="-1"></a>                    aasta <span class="sc">&gt;=</span> input<span class="sc">$</span>year[<span class="dv">1</span>], <span class="co"># aasta tulbas oleks liuguri alumisest otsast suurem/võrdne väärtus</span></span>
<span id="cb124-14"><a href="r2.html#cb124-14" aria-hidden="true" tabindex="-1"></a>                    aasta <span class="sc">&lt;=</span> input<span class="sc">$</span>year[<span class="dv">2</span>]) <span class="co"># aasta tulbas oleks liuguri ülemisest otsast väiksem/võrdne väärtus</span></span>
<span id="cb124-15"><a href="r2.html#cb124-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb124-16"><a href="r2.html#cb124-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb124-17"><a href="r2.html#cb124-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-18"><a href="r2.html#cb124-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Täidame kõigepealt kasutaja valikute väljundiosa</span></span>
<span id="cb124-19"><a href="r2.html#cb124-19" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>valik <span class="ot">&lt;-</span> <span class="fu">renderText</span>({ <span class="co"># Näita väljundiosas teksti, kus...</span></span>
<span id="cb124-20"><a href="r2.html#cb124-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">&quot;Valitud &quot;</span>, <span class="co"># on kokku kleebitud sõna &quot;Valitud&quot;</span></span>
<span id="cb124-21"><a href="r2.html#cb124-21" aria-hidden="true" tabindex="-1"></a>               input<span class="sc">$</span>genre, <span class="co"># valitud žanri nimi</span></span>
<span id="cb124-22"><a href="r2.html#cb124-22" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot; (&quot;</span>, <span class="co"># tühik ja algav sulg</span></span>
<span id="cb124-23"><a href="r2.html#cb124-23" aria-hidden="true" tabindex="-1"></a>               input<span class="sc">$</span>year[<span class="dv">1</span>], <span class="co"># valitud kõige varasem aasta</span></span>
<span id="cb124-24"><a href="r2.html#cb124-24" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;-&quot;</span>, <span class="co"># sidekriips</span></span>
<span id="cb124-25"><a href="r2.html#cb124-25" aria-hidden="true" tabindex="-1"></a>               input<span class="sc">$</span>year[<span class="dv">2</span>], <span class="co"># valitud kõige pikem aasta</span></span>
<span id="cb124-26"><a href="r2.html#cb124-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;)&quot;</span>) <span class="co"># ja lõpetav sulg</span></span>
<span id="cb124-27"><a href="r2.html#cb124-27" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb124-28"><a href="r2.html#cb124-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-29"><a href="r2.html#cb124-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Täidame kaardi vahelehe</span></span>
<span id="cb124-30"><a href="r2.html#cb124-30" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>map <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({ <span class="co"># Joonistame vahelehele joonise, kus...</span></span>
<span id="cb124-31"><a href="r2.html#cb124-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(input<span class="sc">$</span>genre <span class="sc">!=</span> <span class="st">&quot;&quot;</span>){ <span class="co"># juhul, kui žanri valik ei ole tühi</span></span>
<span id="cb124-32"><a href="r2.html#cb124-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb124-33"><a href="r2.html#cb124-33" aria-hidden="true" tabindex="-1"></a>            dat <span class="ot">&lt;-</span> <span class="fu">andmed</span>() <span class="co"># jooksutame serveri funktsiooni alguses loodud funktsiooni &quot;andmed()&quot; ja salvestame tulemuse objekti &quot;dat&quot;</span></span>
<span id="cb124-34"><a href="r2.html#cb124-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb124-35"><a href="r2.html#cb124-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(input<span class="sc">$</span>type <span class="sc">==</span> <span class="st">&quot;punktid&quot;</span>){ <span class="co"># kui kasutaja tahab näha punktikaarti</span></span>
<span id="cb124-36"><a href="r2.html#cb124-36" aria-hidden="true" tabindex="-1"></a>                <span class="co"># loeme konkreetse ajaperioodi ja konkreetse žanri filmid kokku</span></span>
<span id="cb124-37"><a href="r2.html#cb124-37" aria-hidden="true" tabindex="-1"></a>                dat <span class="sc">%&gt;%</span> <span class="fu">count</span>(koht) <span class="ot">-&gt;</span> punktidat</span>
<span id="cb124-38"><a href="r2.html#cb124-38" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb124-39"><a href="r2.html#cb124-39" aria-hidden="true" tabindex="-1"></a>                <span class="co"># joonistame punktikaardi</span></span>
<span id="cb124-40"><a href="r2.html#cb124-40" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb124-41"><a href="r2.html#cb124-41" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad) <span class="sc">+</span> <span class="co"># maakondade aluskaardi kiht, millele lisame</span></span>
<span id="cb124-42"><a href="r2.html#cb124-42" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_sf</span>(<span class="at">data =</span> punktidat, <span class="co"># kokku loetud punktid</span></span>
<span id="cb124-43"><a href="r2.html#cb124-43" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">aes</span>(<span class="at">size =</span> n), <span class="co"># punktide suurus näitab konkreetse koha esinemise arvu</span></span>
<span id="cb124-44"><a href="r2.html#cb124-44" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="co"># punktid on tehtud üsna läbipaistvaks</span></span>
<span id="cb124-45"><a href="r2.html#cb124-45" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="co"># ja värvitud punaseks</span></span>
<span id="cb124-46"><a href="r2.html#cb124-46" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">theme_bw</span>() <span class="co"># kasutame mustvalget teemat</span></span>
<span id="cb124-47"><a href="r2.html#cb124-47" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb124-48"><a href="r2.html#cb124-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>{ <span class="co"># kui kasutaja ei taha näha punktikaarti (= tahab näha horopleetkaarti)</span></span>
<span id="cb124-49"><a href="r2.html#cb124-49" aria-hidden="true" tabindex="-1"></a>                <span class="co"># loeme kokku, mitu valitud žanri punkti igas maakonnas on</span></span>
<span id="cb124-50"><a href="r2.html#cb124-50" aria-hidden="true" tabindex="-1"></a>                maakonnad <span class="sc">%&gt;%</span></span>
<span id="cb124-51"><a href="r2.html#cb124-51" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">punkte =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(maakonnad, dat))) <span class="ot">-&gt;</span> maakonnad</span>
<span id="cb124-52"><a href="r2.html#cb124-52" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb124-53"><a href="r2.html#cb124-53" aria-hidden="true" tabindex="-1"></a>                <span class="co"># joonistame horopleetkaardi</span></span>
<span id="cb124-54"><a href="r2.html#cb124-54" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb124-55"><a href="r2.html#cb124-55" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_sf</span>(<span class="at">data =</span> maakonnad, <span class="co"># andmed on maakondade kihilt</span></span>
<span id="cb124-56"><a href="r2.html#cb124-56" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">aes</span>(<span class="at">fill =</span> punkte)) <span class="sc">+</span> <span class="co"># täitevärv väljendab punktide arvu</span></span>
<span id="cb124-57"><a href="r2.html#cb124-57" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_sf_label</span>(<span class="at">data =</span> maakonnad, <span class="co"># lisame samade andmete põhjal tekstikihi</span></span>
<span id="cb124-58"><a href="r2.html#cb124-58" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">label =</span> punkte), <span class="co"># silt ütleb täpse punktide arvu</span></span>
<span id="cb124-59"><a href="r2.html#cb124-59" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>, <span class="co"># teksti värv on hall</span></span>
<span id="cb124-60"><a href="r2.html#cb124-60" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># silt on poolenisti läbipaistev</span></span>
<span id="cb124-61"><a href="r2.html#cb124-61" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">&quot;log&quot;</span>) <span class="sc">+</span> <span class="co"># kasutame Viridise log-skaalat</span></span>
<span id="cb124-62"><a href="r2.html#cb124-62" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="co"># ja mustvalget teemat</span></span>
<span id="cb124-63"><a href="r2.html#cb124-63" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="co"># peidame x- ja y-telje pealkirjad</span></span>
<span id="cb124-64"><a href="r2.html#cb124-64" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb124-65"><a href="r2.html#cb124-65" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb124-66"><a href="r2.html#cb124-66" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb124-67"><a href="r2.html#cb124-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-68"><a href="r2.html#cb124-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Täidame alamandmestiku vahelehe</span></span>
<span id="cb124-69"><a href="r2.html#cb124-69" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>tab <span class="ot">&lt;-</span> <span class="fu">renderDataTable</span>({ <span class="co"># Teeme andmetabeli, kus...</span></span>
<span id="cb124-70"><a href="r2.html#cb124-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(input<span class="sc">$</span>genre <span class="sc">!=</span> <span class="st">&quot;&quot;</span>){ <span class="co"># juhul, kui žanri valik ei ole tühi,</span></span>
<span id="cb124-71"><a href="r2.html#cb124-71" aria-hidden="true" tabindex="-1"></a>            <span class="fu">andmed</span>() <span class="sc">%&gt;%</span> <span class="co"># näitame kasutaja valitud alamandmestikku</span></span>
<span id="cb124-72"><a href="r2.html#cb124-72" aria-hidden="true" tabindex="-1"></a>                <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="co"># ilma ruumiinfota</span></span>
<span id="cb124-73"><a href="r2.html#cb124-73" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb124-74"><a href="r2.html#cb124-74" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb124-75"><a href="r2.html#cb124-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-76"><a href="r2.html#cb124-76" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="rakenduse-kokkupanemine" class="section level3 hasAnchor" number="21.2.5">
<h3><span class="header-section-number">21.2.5</span> Rakenduse kokkupanemine<a href="r2.html#rakenduse-kokkupanemine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kõige lõpuks on vaja rakendus kasutajaliidesest ja serverist kokku panna.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="r2.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------#</span></span>
<span id="cb125-2"><a href="r2.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---5. Paneme kasutajaliidese ja sisu kokku---####</span></span>
<span id="cb125-3"><a href="r2.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------#</span></span>
<span id="cb125-4"><a href="r2.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>Jooksutame rakendust ning vaatame, mis saab.</p>
<p>Meie rakendus teeb oma töö ära, ent on nii kujunduselt kui ka kasutusmugavuse mõttes üsna algeline. Shinys saab aga muuta ja lisada veel lugematul hulgal asju, parandada rakenduse kiirust jne. Hea samm-sammulise sissejuhatuse rakenduste tegemisse leiab <a href="https://shiny.rstudio.com/tutorial/#written-tutorials">siit</a>.</p>
</div>
</div>
<div id="rakenduse-jagamine" class="section level2 hasAnchor" number="21.3">
<h2><span class="header-section-number">21.3</span> Rakenduse jagamine<a href="r2.html#rakenduse-jagamine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Shiny rakendusi saab jagada ainult kas lokaalselt (<em>app.R</em> + selle juurde kuuluvad failid) või üles laadituna serverisse, kuhu on installitud ka R ja <em><a href="https://rstudio.com/products/shiny/download-server/">Shiny Server</a></em> (viimast saab installida ainult Linuxis). See tähendab, et tavalist HTML-faili Shiny rakendusest otse teha ei saa, sest JavaScript ei tea, mida R-i kooditükkidega pihta hakata.
Küll aga saab rakenduse üles laadida näiteks <strong><em><a href="https://www.shinyapps.io/">shinyapps.io</a></em></strong> serverisse ning lisada rakenduse seejärel <em>iframe</em>’i abil mõne teise (HTMLis) veebilehe sisse.
<em>Shinyapps.io</em> pakub Shiny rakenduste majutuse teenust, kusjuures tasuta saab üles laadida kuni 5 rakendust ja neid ei saa serveris ühes kuus aktiivselt kasutada rohkem kui 25 tundi.</p>
<p>Rakenduse laadimiseks serverisse tuleb esmalt teha endale <em>shinyapps.io</em> kasutaja, logida sisse ning valida seejärel <em>Account → Tokens</em>.
Samal ajal tuleb installida endale R-is pakett <code>rsconnect</code> ja see laadida.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="r2.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rsconnect&quot;</span>)</span>
<span id="cb126-2"><a href="r2.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsconnect)</span></code></pre></div>
<p>Nüüd valime <em>shinyapps.io</em> lehel <em>Tokens</em> alamlehel <em>Show → Show secret → Copy to clipboard</em>, kopeerime esitatud koodi ning teeme RStudio konsoolis paremkliki → <em>Paste</em> või vajutame <em>Ctrl+V</em>. Nii ühendame lokaalselt installitud R-i ja enda kasutaja <em>shinyapps.io</em> serveris.</p>
<p>Rakenduse üleslaadimiseks trükime konsooli <code>deployApp()</code> ning anname argumendiks selle kausta teekonna, kus rakendus on.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="r2.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deployApp</span>(<span class="st">&quot;efis_shiny&quot;</span>)</span></code></pre></div>
<p>Selle tulemusel avaneb lõpuks lehekülg <code>https://sinukasutajanimi.shinyapps.io/rakendusenimi/</code>.<br />
Vaata täpsemalt <a href="https://shiny.rstudio.com/articles/shinyapps.html">siit</a>.</p>
<p>Üles laaditud rakenduse saab panna <em>iframe</em>-i abil HTML-faili.</p>
<iframe src="https://vallakohtudmorf.shinyapps.io/efis_shiny/" width="100%" height="700" style="border:none;" title="Veebirakendus Shinyga">
</iframe>
<p>Vaata rohkem näiteid <a href="https://shiny.rstudio.com/gallery/">siit</a>. R-i ja ruumiandmete kohta on hea ja ülevaatlik kursus ka aadressil <a href="http://aasa.ut.ee/Rspatial/">http://aasa.ut.ee/Rspatial/</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="kirjandus.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
