[["index.html", "HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes Praktikum 1 Sissejuhatus 1.1 Kursuse korraldusest 1.2 Mis on geoinfosüsteemid? 1.3 Geoinfosüsteemide ajaloost 1.4 Ruumiandmed ja GIS humanitaarteadustes 1.5 Küsitlus 1.6 Järgmisel korral", " HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes Maarja-Liisa Pilvik, Andres Kimber sügis 2023 Praktikum 1 Sissejuhatus 1.1 Kursuse korraldusest 3 EAP E ja K 12.15-13.45 Nädalad 4.-9., 11.-16. 10. nädal vaba, st 6. ja 8. novembril praktikume ei toimu. Lossi 3-425 Kontakt ja info: maarja-liisa.pilvik@ut.ee Hindamine arvestuslik. Kursuse lõpuks peavad olema esitatud vabal valikul 2 kodutööd 3st. Esitamiseks aega kursuse lõpuni; lõpuprojekt. Esitlused 13. ja 18. detsembril. Lõpuprojekti esitamise tähtaeg 12.12 kell 12.00 päeval. Soovijatele konsultatsioon 11. detsembril praktikumi tavalisel toimumisajal. Kodutööde teemad: story map’i (kaardiloo) tegemine, kaardi georefereerimine, andmestike ühendamine ja visualiseerimine. Arvestuse saamiseks tuleb võtta osa vähemalt 70% auditoorselt toimuvatest praktikumidest, st kohapeal tuleb osaleda vähemalt 16 kohtumisel 23st. Tänase praktikumi, 11., 13. ja 18. detsembri praktikumide eest läheb kohalkäimine kõikidel automaatselt kirja. Vajadusel on võimalikud erikokkulepped. Materjale hoitakse ja täiendatakse kursuse kodulehel ja Moodle’is. 1.2 Mis on geoinfosüsteemid? Joonis 1.1: Eesti kujutatud “Sõrmuste Isanda” kaartide stiilis, twitter.com/evelynuuemaa Geoinfosüsteem on arvutipõhine süsteem ruumiliste ja mitteruumiliste andmete kogumiseks, haldamiseks, analüüsiks, visualiseerimiseks ja jagamiseks. Selle abil on võimalik ruumisuhete kaudu mõista oma andmeid paremini või teisest vaatepunktist ning sedakaudu teha kaalutletumaid otsuseid. Joonis 1.2: Mida GISiga tehakse? (Wallentin et al. 2015) Joonis 1.3: Sõnapilv Wikipedia artiklist ‘Geographic information system’ Andmete kogumine (nt paberkaartide digiteerimine, päringud repositooriumidest, käsitsi sisestamine); haldamine (nt andmebaaside struktureerimine, dokumenteerimine); analüüs (nt erinevate andmekihtide ühendamine, kattuvate alade arvutamine, puuduvate väärtuste arvutamine, puhveralade arvutamine); visualiseerimine (nt kaartide koostamine ja kujundamine); jagamine (nt projektide majutamine veebis, andmete ja metaandmete publitseerimine). Joonis 1.4: GIS kui vihmavari, What are Geographic Information Systems Ehkki vahel käsitletakse geoinfosüsteeme kui mingit kindlat tarkvara (nt ArcGIS), on GIS definitsioonilt pigem mingite funktsionaalsuste kogum. See tähendab ka seda, et erinevad tarkvarad või selle osad võivad spetsialiseeruda erinevatele GISi funktsioonidele ning mingeid funktsioone (nt andmete kogumine) ei pea üldse tarkvara abil täitma. Joonis 1.5: Populaarsed GIS tarkvarad Kuigi GIS võib talletada ka mitteruumilist infot, moodustavad kõige olemuslikuma osa geoinfosüsteemidest siiski just ruumiandmed. Kõige sagedamini kasutatakse GISi geograafiliste andmete töötlemiseks, ent neid saab põhimõtteliselt kasutada mis tahes andmete jaoks, millel on mingid dimensioonid (nt väljamõeldud kohad; inimkeha; planeetide pinnad; puuviljad jne). Geoinfosüsteemidest võib seega kõige lihtsamal moel mõelda kui koordinaatidega varustatud andmebaasidest ja nende sisu analüüsimiseks ja visualiseerimiseks mõeldud tööriistadest. Tüüpiliselt toimub andmete analüüs GISis kihtide põhimõttel: eri tüüpi infot hoitakse erinevatel andmekihtidel ning nende ühendamisel sünteesitakse uut teadmist. Joonis 1.6: Andmete hoidmine GISis kihtidena, GIS NatGeo Nagu öeldud, võivad GIS-andmebaasid sisaldada nii ruumilist kui ka mitteruumilist infot. Ruumilist infot väljendatakse koordinaatidega (nt x, y, z, pikkus- ja laiuskraad, kõrgus merepinnast) ning need määravad iga objekti asukoha, kasutades kas punkti, joont, polügooni või pikslit. Mitteruumilist infot, mis mingit kohaga seotud on, väljendavad atribuudid. Atribuudid on tüüpiliselt salvestatud tabelina, kus iga objekt on eraldi real ning iga atribuut eraldi tulbas, või mingis muus (nt hierarhilises) andmebaasistruktuuris. Joonis 1.7: Näide QGISi atribuuttabelist Infotehnoloogia arenguga on muutunud võimalikuks säilitada digitaalsel kujul atribuutidena peaaegu mis tahes tüüpi andmeid, nt struktureerimata tekste (raamatuid, veebilehti), pilte, videoid, helifaile. Kuna geoinfosüsteemid on arvutipõhised, nõuavad need siiski, et andmed oleksid mingil moel formaliseeritud. See tähendab ka vahel seda, et tuleb andmetele suruda peale jäigad kategooriad ka seal, kus kategooriatevahelised piirid on tegelikult sujuvad ning on palju üleminekualasid. 1.3 Geoinfosüsteemide ajaloost Joonis 1.8: John Snow koolera leviku kaart (1855) (Wikimedia Commons) Joonis 1.9: GISi ajajoon Geoinfosüsteeme hakati arendama ja kasutama 1960ndatel, kui akadeemilistes ringkondades hakati uurima kvantitatiivse ja arvutusliku geograafia võimalusi. GISi “isaks” peetakse Roger Tomlinsoni (1933-2014), kes 60ndate alguses arendas Kanadas välja kõige esimese geoinfosüsteemi maailmas (Canada Geographical Information System CGIS). Süsteemi ülesandeks oli talletada, võrrelda ja analüüsida Kanada maakasutuse andmeid. GISi ulatuslikum areng toimus 1970ndatel ning 1980ndate lõpuks oli fookus juba sellel, kuidas parandada GISi kasutuskogemust. Esimestel aastakümnetel oli GIS põhiliselt haldus- ja militaarkasutuses. 1982. aastal tõi ESRI (Environmental Systems Research Institute, Inc.) välja esimese kommertsliku GIS-toote, ARC/INFO, mis põhines Harvard Laboratory Computer Graphicsi poolt arendatud esimesel vektoritega töötaval GISil. ESRI roll GIS-tarkvara arendajana on sellest alates ainult kasvanud. 1990ndatest alates hakkas GISi kasutajaskond kiiresti kasvama. Seda soodustas järjest väiksemate, odavamate ja kiiremate arvutite tootmine, andmete ulatuslikum kättesaadavus ning uute satelliitide ja kaugseiretehnoloogia kasutuselevõtt. Viimast kaht kümnendit on iseloomustanud lisaks tehnoloogia jätkuvale arengule ka vabavaralise GIS-tarkvara teke, mis on teinud ruumiandmete kasutamise ja analüüsi kättesaadavamaks nii tavakasutajale kui ka talle pakutavate toodete arendajatele. On toimunud nn ruumiline revolutsioon (Geospatial Revolution), mis on muutnud nii seda, kuidas me liigume, otsuseid teeme ja oma lugusid jagame. Praeguseks kasutatakse geoinfosüsteeme näiteks telekommunikatsioonis, linnaplaneerimises (näiteks Tallinna Ligipääsetavuse infosüsteem), logistikas, navigeerimises (näiteks Veeteede Ameti Nutimer), meteoroloogias, katastroofide ohjamisel ja leevendamisel, tervishoius, kuritegevuse analüüsil, … Vt veel rakendusvaldkondi nt siit. 1.4 Ruumiandmed ja GIS humanitaarteadustes Ehkki näiteks arheoloogias on ruum ja ruumiandmed olnud alati kesksel kohal, on teistes humanitaaria valdkondades (nt ajaloos, kirjandusteadustes) toimunud viimase paarikümne aasta jooksul nn ruumiline pööre (Spatial Turn). Ruumiline pööre algas tegelikult geograafia valdkonna seest: pelga inimelu või -tegevuse mahuti või “lava” tõlgenduse asemel seati fookusesse ruum kui pidevalt muutuv ja kompleksne sotsiaalne moodustis. See võimaldas leida enam ühist keelt ka sotsiaal- ja humanitaarteadlastega. Humanitaarteadustes on küll ruumi ja koha mõistetel olnud alati üsna prominentne roll, ent ruumilise pöörde käigus seati fookus eksplitsiitselt sellele, kuidas sotsiaalsete muutuste ning laiemalt inimtegevuse seletamiseks tuleb võtta arvesse ka ruumilist komponenti. Sealjuures rõhutatakse, et ruum võib ajas muutuda ning et ruumid võivad olla nii füüsilis-geograafilised kui ka abstraktsed, metafoorsed või väljamõeldud (vt nt üle-eelmisel aastal ilmunud Keele &amp; Kirjanduse erinumbrit “Keel ja ruum”). Nõnda on näiteks keskaegses kirjanduses narratiivi loomise seisukohast võrdselt olulised nii London kui ka Camelot; erinevate keelte kohaväljendeid (nt kaassõnu ees, kõrval, taga) uurides saame teada, kuidas mingi keele kõneleja end mõtteliselt millegi suhtes positsioneerib (kas absoluutselt või relatiivselt), kuidas tajutakse aega ruumisuhete kaudu jne. Ruumi asetamine kesksele positsioonile on digihumanitaaria katusmõiste alla sünnitanud interdistsiplinaarsed valdkonnad nimega geohumanitaaria (GeoHumanities) ja ruumihumanitaaria (Spatial Humanities), mis ühendavad GISi ja klassikalised ruumianalüüsi meetodid (nt teekondade arvutamine, kaartide koostamine) uuemate arvutuslike meetoditega (nt loomuliku keele töötlus, võrgustikuanalüüs, simulatsioonimudelid, tehisnärvivõrgud). Ruumihumanitaaria ja geohumanitaaria vaheline piir ei ole päris selge ning sageli kasutatakse mõisteid sünonüümidena, samuti on mõlemal valdkonnal suur ühisosa inimgeograafiaga. Kui aga eristust tehakse, siis loetakse geohumanitaaria valdkonda pigem konkreetsete, geograafiliste kohtade ja ruumidega tegelevad uurimused ning ruumihumanitaaria alla ka uurimused, mis analüüsivad sümboolseid, ähmaseid või väljamõeldud ruume. Ehkki mingites humanitaaria valdkondades (nt arheoloogia) on ka geoinfosüsteemid olnud kasutusel juba aastakümneid, on nende võimalusi hakatud teistes humanitaarteaduste harudes rohkem kasutama alles viimase kümne-viieteistkümne aasta jooksul. See on ühelt poolt seotud arvutite võimsuse ning tarkvara ja andmete kättesaadavuse plahvatusliku kasvuga, ent ka teatava suhtumise muutusega humanitaaride seas. Ehkki humanitaaria uurimisobjektid ja andmed on sageli ebatäpsed, hägusad, täpselt määramatud ja fragmentaarsed ning nende analüüs GISi abil pakub endiselt rohkelt väljakutseid, ei nähta tehnoloogias kõigest positivistlikku ja humanitaaraladele olemuslikult sobimatut analüüsivahendit. GISi väärtus humanitaarteadustele seisneb eeskätt selles, et kohainfo (nt kohanime või koordinaatide) kaudu on võimalik ühendada eri formaatides väga erinevat infot, seda visualiseerida ning erinevatest infokihtidest sünteesida uut teadmist. Sealjuures on nõuded absoluutsele täpsusele humanitaarias oluliselt leebemad. Joonis 1.10: Andrus Saareste käsikirjaline murdekaart sõna ‘keegi’ alaleütleva käände (‘kellelegi’, ‘kellegile’ jm) varieerumisest. Vt rohkem kaarte siit. Geo- ja ruumihumanitaaria fookus ei ole aga pelgalt tehniliste analüüsimeetodite ja tööriistade kasutamisel ja arendamisel, vaid ka (või isegi eelkõige) ruumide ja kohtade teoreetilistel konstruktsioonidel ning nende muutumisel ajas ning eri kultuurides: kuidas mingites ruumides elatakse, kuidas mingeid ruume sotsiaalselt konstrueeritakse ja kuidas need ruumid omakorda mõjutavad majandust, poliitikat, kultuuri jne. Siiski on vahest enamgi neid, kes ühel või teisel moel ruumiandmeid ja geoinfosüsteeme oma töös ära kasutavad, ilma et ennast või oma uurimistööd spetsiifiliselt ruumi- või geohumanitaaria valdkonna kaudu defineeriksid. Sellise üldise ruumiandmete analüüsi tööriistakasti koostamisega tegeleme ka siin kursusel. 1.4.1 Lugude jutustamine 1.4.2 Arheoloogia Joonis 1.11: Muististe jaotumise visualiseerimine ja maastiku nähtavuse analüüsimine (Kimber 2016) Joonis 1.12: Muinasaegsete asulakohtade ennustav mudeldamine (Haav 2014) ja kiviaegse maastiku rekonstruktsioonid (9700 - 5300 eKr) (Rosentau et al. 2013) 1.4.3 Keeleteadus Joonis 1.13: ‘ei ole’/‘pole’ levikuandmed (murdeatlasest) ja ‘pole’ sagedusandmed (murdekorpusest) (Lindström et al. 2019) 1.4.4 Keele-/sotsiaalteadus Joonis 1.14: Keeleline mitmekesisus Helsingi piirkonnas rahvastikuregistri vs. sotsiaalmeeedia postituste andmete põhjal (Väisänen et al. 2022) 1.4.5 Veel näiteid Joonis 1.15: Rongiliikluse areng Prantsusmaal (Gregory et al. 2014) Joonis 1.16: Pariisi tänavate nimetamine kirjanduses (Moncla et al. 2019) 1.5 Küsitlus Palun täida Moodle’is lühike küsimustik. 1.6 Järgmisel korral Seminar. Lugemiseks valida üks artikkel kahest järgmisest: David J. Bodenhamer (2010). The Potential of Spatial Humanities Todd Presner &amp; David Shepard (2015). Mapping the Geospatial Turn Artiklite pdf-id leiad Moodle’ist. Arutlemiseks Milliseid võimalusi geoinfosüsteemid humanitaariale pakuvad? Milliseid humanitaarteaduste ja GISi põrkumise probleemkohti artiklites kirjeldatakse? Kas need probleemkohad on maailma kontekstis endiselt aktuaalsed? Aga Eesti kontekstis? Milliseid murekohti näed arvutuslike meetodite ja arvutipõhiste tehnoloogiate laiema leviku juures humanitaarteadustes? Kas humanitaarteadused on omavahel ühildatavad? Aga teiste valdkondadega? Milline on interdistsiplinaarsete uurimuste/projektide olevik, milline tulevik? "],["seminar.html", "Praktikum 2 Seminar 2.1 Mõisted 2.2 Rühmatöö 1: GISi ja ruumi-/geohumanitaaria projekte ja rakendusi 2.3 Rühmatöö 2: humanitaaria ja kvantitatiivsed meetodid 2.4 Järgmisel korral", " Praktikum 2 Seminar Artiklites käsitletud põhiteemad ja märksõnad: GISi ajalugu, levik militaar-, haldus- ja ärikasutusest tavakasutusse satelliidid (GPS) veebitehnoloogia, veebikaardid -&gt; dünaamiline, interaktiivne andmete kättesaadavus, andmete paljusus ja mitmekülgsus vabavaraline tarkvara, kaardirakenduste liidesed (API - Application Programming Interface) Kaardid ja kättesaadavad ruumiandmed kui ametlike ideoloogiate ja võimusuhete kinnistajad alternatiivne kaardistamine, osaluskaardistamine kogukondade võimestamine, kodanikuteadus Humanitaarteaduste vajadused ebatäpsed andmed, võib olla raske matemaatiliselt formaliseerida ebamäärased, abstraktsed, metafoorsed ruumid ruumilise kogemuse olulisus ruumi ja ruumisuhete kultuurispetsiifiline mõistestamine paljude andmeallikate, andmetüüpide ja perspektiivide kihitamine teadmise sünteesimiseks ruumi ja aja (dünaamiliselt) koos käsitlemine GISi rakendusi humanitaarteadustes, mis loovad (või kasutavad) nt kaarte andmebaase 3D mudeleid veebikeskkondi mängutehnoloogiat, virtuaalreaalsust 2.1 Mõisted Mõne artiklites kasutatud mõiste seletusi: Cognitive maps - kujutluskaart. Inimese (või muu elusolendi) kogemuste põhjal ajju talletatud ettekujutus/mudel mingist reaalsest või irreaalsest ruumist; laiemas käsituses mis tahes protsessist või mõistest. Community mapping, participatory mapping - kogukondlik ja/või osaluskaardistamine. Kaartide tegemine n-ö tavaliste inimeste poolt tavaliste inimeste jaoks, praktikas sageli mingil ühiskondlikul-kultuurilisel või poliitilisel eesmärgil (nt pärandi, keele kaitsmiseks, mingi kogukonna arengu planeerimiseks, mingi piirkonna ressursside õiglasemaks jaotamiseks). Nende mõistetega on lähedalt seotud ka mõiste counter-mapping, mis veelgi selgemalt tegeleb alternatiivse kaardistamise abil traditsiooniliste võimusuhete lammutamise ja õõnestamisega. Nii osaluskaardistamine kui ka vastukaardistamine esindavad kriitilise kartograafia rakendusi. Kriitilise kartograafia põhitees on, et kaardid peegeldavad ja kinnistavad võimusuhteid ning seda enamasti ühiskonnas domineeriva klassi positsioonilt. Gazetteer - kohanimeloend. Koondab tavaliselt infot kohanimega seotud koordinaatide ja koha tüübi kohta (nt mägi, jõgi, linn, küla), aga võib lisaks sisaldada ka nt rööpnimekujusid, asustuse infot, seoseid teiste sõnastiku kirjetega jm infot. Geocoding - geokodeerimine ehk kohtade tekstiliste viidete (nt kohanimede, aadresside) muutmine geograafilisteks koordinaatideks. Tagurpidi geokodeerimine muudab omakorda geograafilised koordinaadid kohanimedeks või aadressideks. Locative media - 1) digitaalne sisu (nt pildid, videod, helid), millele on lisatud asukohainfo; 2) vahendid, mis kasutavad digitaalse sisu edastamiseks asukohainfot. Digihumanitaaria kontekstis ka raamistik, mille kaudu uurida üksikisiku suhteid ja vastastikuseid mõjusid koha ja tehnoloogiaga. Memory map - enamasti interaktiivne kaart, mis väljendab mingi koha ajalugu suuliste või kirjalike narratiivide ja neid toetava visuaalse materjali kaudu. Psychogeography - 20. sajandi keskpaigas tekkinud kunsti- ja teadussuund, mille fookuses on see, kuidas kogetakse (eeskätt) linnakeskkondi ning kuidas keskkond mõjutab meie emotsioone ja käitumist. Sealjuures pööratakse tähelepanu viisidele, kuidas saada ümbritsevast uusi ja ootamatuid elamusi ning avastada “tavapärasest erinevat”. Väljundiks enamasti mingid kaardid, joonistused või tekstid, mis kogemusi kirjeldavad. Thick mapping - paljude erinevate geograafiliste ja/või kohaspetsiifiliste andmete (pildid, narratiivid, kaardid, suulised ja kirjalikud mälestused jne) kogumine, koondamine/agregeerimine ja visualiseerimine selleks, et pakkuda kohtadele ja neis toimunud sündmustele erinevaid perspektiive (ka nt millegi alusel marginaliseeritud või vähem häälekate gruppide omi). Kasutatud on ka terminit deep mapping. 2.2 Rühmatöö 1: GISi ja ruumi-/geohumanitaaria projekte ja rakendusi Võite osaleda üksi või kahekesi. Otsige üks enda erialaga (lähemalt või kaugemalt) seotud projekt, mis kasutaks GISi või tegeleks ruumi- või geohumanitaariaga. Alustada võib näiteks siit, aga kindlasti võiks lähemalt uurida ka artiklites olnud viiteid ja märksõnu. Lisage virtuaalsele tahvlile: projekti nimi, projekti link, valdkond, kirjeldus selle kohta, millega projektis tegeletakse, võimalusel visuaalset lisamaterjali (nt pilte rakendustest, kaartidest vm). 2.3 Rühmatöö 2: humanitaaria ja kvantitatiivsed meetodid Moodustage 4-5 inimesest koosnevad rühmad. Üks rühm saab skeptikute/pessimistide rolli: teie arvates ei saa GISi ja laiemalt praeguste arvutuslike meetodite ja kvantitatiivse lähenemisega humanitaaria andmete ja küsimustega töötada (või siis mitte vähemalt väga hästi). Ka interdistsiplinaarsus on teie meelest praktikas väga raskesti saavutatav. Teine rühm saab optimistide rolli: teie arvates on humanitaaria eri suunad ka metodoloogiliselt pidevas arengus ning analüüsimeetodite vahetamine, laenamine ja kohandamine eri distsipliinide vahel ja sees annab humanitaariale väga palju juurde. Koondage siia võimalikult palju argumente ja lihtsalt arvamusi, näiteid jm, mis teie rühma esindatavat seisukohta toetaksid. Võite sealjuures loomulikult ära kasutada artikleid, guugeldada, aga ka rühma sees ise ideid genereerida. 2.4 Järgmisel korral Ruumiobjektid ja ruumiandmed: millisel kujul reaalse maailma objekte geoinfosüsteemides kujutada? "],["ruumiobjektid.html", "Praktikum 3 Ruumiobjektid ja ruumiandmed 3.1 Vektorandmed 3.2 Rasterandmed 3.3 Vektor vs. raster 3.4 Ülesanne 3.5 Järgmisel korral", " Praktikum 3 Ruumiobjektid ja ruumiandmed Meid ümbritsevas maailmas on palju erinevaid ruumiga seotud nähtusi, näiteks konkreetsed füüsilised objektid (teed, hooned), kokuleppelised või abstraktsed objektid (nt riigipiir), sündmused (nt katastroofid, meeleavaldused, spordiüritused) või ka mingid pidevad nähtused, nagu temperatuur, mis esinevad väljana terves ruumis ning mille konkreetset väärtust on mingites ruumi punktides võimalik määrata. Humanitaarteaduste kontekstis võime mõelda ka sellistest ruumiga seotud nähtustest ja objektidest, nagu migratsioon ja asustus, kirjandusteoste sündmused, (tajutavad) murdepiirid, keelekasutus (sõnad, konstruktsioonid), lahingud, sõjakäigud, uskumused ja usundid jne. Nähtustel on omakorda mingid omadused, mille abil neid nähtusi või ruumi ennast kirjeldada. (Geo)infosüsteemide abil saame reaalse maailma objekte ja nähtusi hallata, kujutada ja analüüsida aga ainult nende mingil moel abstraheeritud ja formaliseeritud kujul, ruumiobjektina. Ruumiandmete seaduse definitsioon (§ 3, lg 3): Ruumiobjekt käesoleva seaduse tähenduses on konkreetse asukoha või geograafilise alaga seotud reaalmaailma nähtuse abstraktne kujutis. Ruumiandmed omakorda kirjeldavad … ruumiobjektide asukohta, omadusi ja kuju geograafilises ruumis. (Ruumiandmete seaduse § 3, lg 1.) Objektidele ja nähtustele sobiva kujutamisviisi valimine sõltub eeskätt sellest, kas läheneme ruumile ja selles asuvatele objektidele ja nähtustele objektikeskselt või asukohakeskselt. Objektikeskses lähenemises seame fookusesse objektid. Need täidavad kindlates punktides mingit ruumi, neid saab loendada, need võivad külgneda ja kattuda, neil on mingid kindlad omadused, need on võib-olla seotud mingite teiste objektidega jne. Ruum ja selle omadused on ainult üks atribuut, mille kaudu objekte kirjeldada. Sellises lähenemises on objektid diskreetsed: neil on kindel asukoht ja ruumikuju (nt hoone, mälestusmärk, riigipiir). Asukohakeskses lähenemises on fookus ruumil. Ruum on sama objektiga otsast otsani täidetud. Objektid ja nende omadused kirjeldavad ruumi, on ruumi atribuutideks. Asukohakeskses lähenemises on objektid pidevad: objekt esineb terves ruumis, aga saab ruumi erinevates punktides erineva väärtuse (nt maapinna reljeef, temperatuur ja õhurõhk maapinnal, kultuurikihi intensiivsus/kontsentratsioon). Need kaks lähenemist on aluseks sellele, kuidas ruumiobjekte geoinfosüsteemis kujutada: kas vektorkujul või rasterkujul. Vastavaid kujutusviise nimetatakse ka ruumiandmete mudeliteks. Joonis 3.1: Vektor- vs. rasterandmed (Bolstad 2016 : 41) 3.1 Vektorandmed Vektormudelis kujutatakse andmeobjekte geomeetriliste kujundite abil. Geomeetrilisi põhiobjekte ehk primitiive on 3: punkt (nt torn, kivi), joon (nt tee, jõgi), pind/areaal/polügoon/ala (nt põld, mets, linn). Joonis 3.2: Punktid, jooned, polügoonid (Ballas et al. 2018 : 13) Punkt on eukleidilises mõttes nullmõõtmeline ning seda esitatakse koordinaatsüsteemis kujul P(x; y). Mitmest punktist moodustub ühemõõtmeline joon, enamasti murdjoon, mille (käänu)punktid saab ühendada sirglõiguga. Joonest omakorda saab moodustada polügooni, mispuhul joone algus- ja lõpp-punkt kattuvad. Joonis 3.3: Geomeetrilised objektid (Bolstad 2016 : 43) Geomeetrilise objekti valik sõltub sealjuures sellest, kui täpselt mingit andmeobjekti soovitakse kujutada. Näiteks võib Eesti pühapaikade kaardistamisel kasutada punkti ruumikuju, pühapaiga lähemal vaatlusel aga kasutada hoopis polügooni ruumikuju, eristada selle sees omakorda teisi polügoone või punkte jne. Joonis 3.4: Pringi Ohvrimägi punktina ja polügoonina (Hiite Maja looduslike pühapaikade kaardirakendus) Joonis 3.5: Pringi Ohvrimäe raietööd (Kaasik 2018) Vektorandmete struktuur võib olla väga erinev. Kõige lihtsamas struktuuris on iga objekt (punkt, joon või polügoon) kirjeldatud x- ja y-koordinaatide jada kaudu. See tähendab ka näiteks, et teineteisega külgnevad polügoonid on kirjeldatud eraldi joonelõikude kaudu, olgugi et neil on osa lõike ühised. Sellises struktuuris ei ole objektidevahelised suhted kuidagi kirjeldatud ning külgnemissuhe on implitseeritud ainult samasuguste koordinaatide kaudu. Teine levinud viis andmeid struktureerida on kasutada topoloogilisi suhteid, mis kirjeldaksid ruumiobjektide paiknemissuhteid nii, et need mingite teisenduste (nt pööramise või suumimise) käigus ei muutuks. Näiteks külgnevate polügoonide puhul teaks sellisel juhul polügoonide ühine joonelõik, et tema parem pool kuulub ühte polügooni ja vasak pool teise ning kaob ära vajadus samu koordinaate kaks korda määrata. Topoloogilised suhted võivad niisiis kirjeldada nt seda, kas kaks objekti on kõrvuti või puutuvad kokku, kas üks objekt on täielikult või osaliselt teise sees, kas kaks objekti jagavad ühist piiri/serva, kas kaks objekti on üksteisest täiesti eraldi jne. Joonis 3.6: Spagetistruktuur vs. topoloogiline struktuur (Bolstad 2016 : 48) Topoloogilised suhted on aluseks topoloogiareeglitele, mis defineerivad, kuidas geomeetrilised objektid geoinfosüsteemi andmebaasis tohivad üksteise suhtes paikneda. Topoloogiareeglid ArcGISis Topoloogilisi suhteid ja reegleid kasutatakse näiteks siis, kui tahetakse planeerida võimalikult kiiret teekonda ühest punktist teise või hoonestuse paiknemist, aga ka paljuks muuks. Pelgaks visualiseerimiseks pole aga topoloogilisi suhteid andmebaasis vaja defineerida. Vektorandmeid hoitakse GISis enamasti kas SHP, GML, TAB või VPF formaatides. Nii vektor- kui ka rasterandmeid saab hoida geopackage’i (GPKG) formaadis. 3.2 Rasterandmed Rastermudelit kasutatakse eeskätt pidevate andmeobjektide (nn väljade) kujutamiseks. Rastermudelis jagatakse kogu ruum ühesuguste (kindla kujuga) osadega korrapäraseks võrguks ehk rastriks, nii et igale rastri elemendile saab koordinaatide abil ühtmoodi viidata ning et väljal ei oleks kattumisi ega tühimikke. Rastermudel peaks olema tõenäoliselt juba tuttav, kui oled kokku puutunud näiteks digifotodega või muude digiteeritud piltidega. Formaadid, nagu JPEG, TIFF, GIF jm, põhinevad kõik rastermudelil. Samuti põhinevad rastertehnoloogial nt kõiksugu LCD-monitorid. Joonis 3.7: Rastermudeli struktuur (Bolstad 2016 : 54) Rastri üht elementi nimetatakse tavaliselt piksliks (pixel ehk picture element). Pikslid võivad olla igasuguse kujuga (nt kolmnurgad, kuusnurgad), ent enamasti on need siiski ruudukujulised. Olgugi, et piksel on olemuselt alati kahemõõtmeline, on piksli koordinaatideks selle keskpunkti koordinaadid. Ühel pikslil on terves oma ulatuses üks väärtus (vastaval alal kõige tüüpilisem või keskmine väärtus), mis täpsustab näiteks selle piksli värvi ja/või heleduse ning iseloomustab selle kaudu piksliga piiratud alas asuva ruumilise nähtuse mingit omadust. Selline omadus võib olla nii pidev (nt kõrgusinfo, mingi keelelise konstruktsiooni suhteline kasutussagedus) kui ka diskreetne (nt keelendi A vs. keelendi B kasutus). See, kui täpselt rastermudel mingile reaalse maailma andmeobjekti kujule vastab, sõltub sellest, kui suured on ühe rastri elemendi ehk piksli mõõtmed, ehk sellest, kui suur on resolutsioon ehk eraldusvõime/lahutusvõime. Mida kõrgem on eraldusvõime, seda täpsem rastermudel on, ent seda suurem on ka rasterandmete faili suurus; mida madalam on eraldusvõime, seda enam infot läheb kaotsi. Efektiivseks eraldusvõime määramiseks tuleks arvesse võtta nii kaardi mõõtkava kui ka muude kaardistatavate andmete väikseimat ühikut. Joonis 3.8: Rastri resolutsioon (Bolstad 2016 : 55) GISi seisukohast on eraldi liik rasterandmeid satelliitpildid, aerofotod ja ortofotod, mis pakuvad GISile olulist kontekstilist infot. Satelliitide eri sensorite ja kaamerate abil saadud info abil on võimalik kuvada suurt hulka maapinna omadusi ja protsesse. Erinevad satelliidid annavad erineva kvaliteediga pilte. Joonis 3.9: EstCube-1 tehtud satelliitpilt (https://www.estcube.com/) Vaata värskemaid NASA satelliitpilte siit. Aerofotosid saab teha näiteks õhupallist, kopterist või lennukist, üha enam kasutatakse fotoroboteid. Aerofotod võivad oma läätse tõttu olla servadest moonutatud ning samuti võivad moonutatud olla maapinnast kõrgel olevad objektid (nt tornid, korstnad, tipud). Ortofotod on geomeetriliselt parandatud aerofotod. Joonis 3.10: Aerofotod vs. ortofotod (Open Geospatial Education) Rastreid võib aga saada ka vektorandmete teisendamisel või interpoleerimisel rasterkujule. Sellisel juhul võib pidada üheks rastri elemendiks nn rakslit ning selle väärtus viitab enamasti mingi ruumiobjekti ID-le või mingi atribuudi väärtusele. Joonis 3.11: Vektorandmetest rasterandmeteni (Timo Grossenbacher, 2018) Rasterandmete levinumad formaadid on näiteks JPEG, PNG, TIFF, BMP. 3.3 Vektor vs. raster Vektorandmed Rasterandmed andmestruktuur võib olla keerukas andmestruktuur on lihtne vähem mahukad võivad olla väga mahukad sobivad ruumiobjektide piiritlemiseks või nende asukoha keskpunktide määramiseks sobivad paremini mingil alal esineva (pideva) nähtuse iseloomustamiseks sobivad paremini inimtegevuse kujutamise jaoks sobivad paremini keskkonna- või loodusnähtuste jaoks sobivad paremini konkreetsetele nähtustele paljude atribuutidega sobivad paremini komplekssetele nähtustele väheste atribuutidega sobivad paremini täpsete, konkreetsete andmetega sobivad paremini ebatäpsete/puudulike või üldistavate andmetega võib arvestada ka topoloogilisi suhteid enamasti objektidevahelisi suhteid ei arvesta on vähem tundlikud projektsiooni muutmisele võivad olla väga tundlikud projektsiooni muutmisele kaardid on visuaalselt ilusamad kaardid suhteliselt robustsed Mõttepaus: Kumba mudelit kasutaksid riigimaanteede kaardistamiseks? Miks? Kumba mudelit kasutaksid rahvastikutiheduse mudeldamiseks? Miks? Millisel kujul saaksid kujutada enda uurimisainest? Paljud tänapäeva GIS-tehnoloogiad võimaldavad kasutada mõlemat mudelit paralleelselt. Näiteks digitaalsed maastikumudelid kuvavad sageli rasterandmete abil mingi piirkonna reljeefi või maakasutust, punktide abil huvipakkuvaid hooneid, joonte abil jõgesid ja teid ning polügoonide abil haldusjaotust. Sealjuures võib otsustada, kas kuvada näiteks kirikud, haiglad ja haridusasutused eraldi kihtidel või ühe kihina, milles sisaldub hoone funktsiooni määrav atribuut. Joonis 3.12: Maastiku nähtavuse analüüsimine (Kimber 2016) Samuti võib üht ja sama nähtust kuvada erinevat moodi, nii vektori kui ka rastrina. Joonis 3.13: Tänavaröövid Saitamas (Okabe 2006 : 8) Vaata natuke ringi siin ja siin. Kas saad aru, millist tüüpi mudeleid on kasutatud? Vaata ka 30 Day Map Challenge käigus tehtud kaarte (siin). 3.4 Ülesanne Kujuta ette, et Google Mapsi ei ole veel leiutatud ja paberkaardid on väga kallid, aga sulle on Tartusse külla tulnud sõber / perekonnaliige / tuttav / välismaa sõber, kes ei ole siin kunagi varem käinud. Joonista tema jaoks paberile Tartu kesklinna kaart ning lisa kaardile enda või tema jaoks tähtsamad kohad ning tagaküljele kirjuta ka, kellele kaart on mõeldud. 3.5 Järgmisel korral Kolmapäeval räägime lähemalt kaartidest ja nende omadustest, koordinaatsüsteemidest ja projektsioonidest. "],["kaardid.html", "Praktikum 4 Kaardid, koordinaatsüsteemid ja projektsioonid 4.1 Kaart 4.2 Kaardi elemendid 4.3 Kaartide liigitus 4.4 Kaartide koostamine ja kujundamine veebis 4.5 Järgmisel korral", " Praktikum 4 Kaardid, koordinaatsüsteemid ja projektsioonid 4.1 Kaart Kaart on maapinna või muu taevakeha vähendatud, üldistatud ja leppemärkidega seletatud mõõtkavaline tasapinnaline kujutis. (Mõisja 2019: 533) Kaardi tunnusteks on seega matemaatilised seaduspärad: kuidas reaalne maailm kaardile kanda? leppemärgid: mille kaudu reaalset maailma kaardil kujutada? üldistatus: kui abstraheeritud pilti reaalsest maailmast kujutada?. Kitsamas tähenduses on kaart niisiis geograafilise informatsiooni visuaalne esitusviis. Joonis 4.1: Väljavõte Maa-ameti Eesti aluskaardist (Maa-amet) Laiemalt räägitakse ka kartograafilistest kujutistest (või kaarditoodetest) (Mõisja 2019: 534), mille hulka võivad lisaks klassikalistele kaartidele kuuluda veel näiteks joonised (väike mõõtkava, suur üldistusaste, ei peegelda täpseid asukohti), Joonis 4.2: Tallinna transpordiühenduste kaart/joonis (Eesti Disaini Keskus) kartogrammid (väike mõõtkava, esitab kvantitatiivset infot, vastab mõõtkavatäpsusele; sageli sama, mis horopleetkaart), ingliskeelne cartogram viitab natuke erinevale asjale: nn pindalakaardile, mis moonutab alasid vastavalt mingile kvantitatiivsele tunnusele; Joonis 4.3: Vaadeldud ja ennustatavad suve keskmised temperatuurid Euroopas (horopleetkaart) (Evelyn Uuemaa) plaanid (suur mõõtkava, topograafiline või tehniline, ei kasuta projektsiooni). Joonis 4.4: Kvartali keskuse planeeritav juurdeehituse plaan (Tartu Linnavalitsus) Samuti võib käsitleda eraldi nn piltkaarte, kus oluline pole geograafiline täpsus, vaid kunstiline esteetika. Joonis 4.5: Marleen Eino Tartu kaart Joonis 4.6: Puise küla kaart (Herald Eelma, Ilmar Randmaa, Merike Liivlaid) Piir piltkaartide ja kunsti vahel ei ole siinjuures sugugi selge. Joonis 4.7: Markus Kasemaa töid Kaarti (või siis kartograafilist kujutist) tehes peame niisiis alati esmalt läbi mõtlema, mis on kaardi tegemise eesmärk ning kes on kaardi lõppkasutaja. Seejärel tuleb mõelda, mida ja mis kujul reaalsest maailmast esitada ning kui täpne peab esitus olema. Lõpuks tuleb mõelda ka tehnilistele aspektidele: mis formaadis andmed meil on kasutada, mis formaadis need andmed peavad olema kaardi tegemiseks ning mis formaadis tuleb kaart ise. 4.2 Kaardi elemendid Klassikalisel kaardil on lisaks sisule (sellele, mida kaardiväljal leppemärkide kaudu kujutatakse) hulk elemente, mis aitavad kaardil kujutatut paremini mõista, näiteks legend (seletab leppemärke), pealkiri, diagrammid, põhjasuund, kaardivõrgud, -kirjad, marginaalkirjad, matemaatiline alus (mõõtkava, projektsioon), lisainfo (väljalõiked, pildid, tekstid jne). Joonis 4.8: Kaardi elemendid (Mõisja 2019: 539) 4.2.1 Mõõtkava Kaardi mõõtkava näitab, kui palju reaalset objekti on vähendatud. Tavaliselt väljendatakse mõõtkava murdosa või suhtena, mis seob kaardil esitatud mingi pikkusega joonlõigu sama joonlõiguga maapinnal. Näiteks mõõtkava 1/20 000 või 1:20 000 näitab, et 1 ühik kaardil vastab 20 000 samale ühikule reaalses maailmas. Kui ühik on cm, siis esitab 1 cm kaardil 20 000 cm ehk 200 m maapinnal. Kaardid jagatakse üldiselt suuremõõtkavalisteks (nt 1:10 000) ja väikesemõõtkavalisteks (nt 1:1 000 000), ehkki seda, kust läheb nendevaheline piir, ei ole selgelt kokku lepitud. Väikesemõõtkavalised kaardid katavad niisiis suuremat ala ja suuremõõtkavalised kaardid väiksemat ala, ehkki intuitiivselt võidakse tajuda neid mõisteid vastupidiselt (“väike kujutab väikest ja suur suurt”). Digitaalsetel kaartidel esitatakse mõõtkava sageli dünaamiliselt, mis tähendab, et mõõtkava saab sisse või välja suumides muuta. Samuti on tüüpiline mõõtkava esitamine mitte arvmõõtkavana, vaid visuaalselt: mingile ekraanil määratletud joonlõigule vastab tegelikkuses kindel vahemaa maapinnal, ent me ei pruugi täpselt näha, kui pika joonlõiguga on ekraanil tegemist. Kui liigume suurelt mõõtkavalt väiksemale, peame andmeid loetavuse huvides üldistama ning valima, mida ja mis detailsusastmega esitada. Üldistada võib lihtsustades, siludes, ühendades jne. 4.2.2 Koordinaatsüsteemid ja projektsioonid Ruumiandmed on alati seotud mingi kohaga. Maakera on kolmemõõtmeline ja põhimõtteliselt võiksime üsna hästi kasutada objektide asukoha ja omaduste kujutamiseks gloobust. See aga ei ole sageli kuigi praktiline. Kaardil, mis on märksa praktilisem visualiseerimisvahend, on üldjuhul aga ainult kaks mõõdet. Kuidas siis kolmemõõtmelist ning ebakorrapärast kujundit kujutada kahemõõtmelise ja korrapärase meediumi kaudu ning kuidas paigutada reaalse maailma objekte ja alasid nii, et saaksime kaardi põhjal öelda, kus need maakeral asuvad? Esmalt tuleb objektid ja nähtused siduda mingite koordinaatidega. Koordinaadid on arvud, mis määravad punkti asendi tasandil või ruumis ning koordinaatsüsteem vastavalt teatud reeglitel põhinev raamistik, mida nende arvude määramiseks kahe- või kolmemõõtmelises ruumis kasutatakse. Ühtse koordinaatsüsteemi abil on võimalik siduda ja koos esitada erinevaid andmeid, ent kui tahame määrata koordinaate maapinnal, siis koordinaatsüsteemist üksi ei piisa. Vaja on siduda see ka Maa kui füüsilise keha ja selle kujuga. Maa tegelik füüsiline kuju on ebakorrapärane ja pidevalt muutuv ning seda on väga raske adekvaatselt mõõta. Maa pinna geofüüsilist mudelit nimetatakse geodeesias geoidiks, mis esitab Maa kuju tingimustes, kus see sõltuks ainult gravitatsiooniväljast ja Maa pöörlemisest. See on samuti üpris keerukas ning korrapäratu vorm ning ehkki see võimaldab üsna täpselt määrata nt objektide kõrgust, ei sobi see väga hästi nn horisontaalsete koordinaatide määramiseks. Seepärast kasutatakse pikkus- ja laiuskraadide määramiseks, kauguste ja pindalade arvutamiseks ning kaartide tegemiseks referentspinnana enamasti ellipsoidi kui Maa idealiseeritud matemaatilist mudelit. Erinevate ellipsoidide mõõtmed võivad pisut erineda (nt nende pooltelgede pikkused või ellipsoidi lapikus). Joonis 4.9: Geoid, ellipsoid ja maapind (allikas: Maa-amet) Ellipsoid ja selle orienteerimise parameetrid (nt kus on ellipsoidi keskpunkt või millise maapinna punkti järgi see on orienteeritud) moodustavad nn daatumi ehk geodeetilise referentssüsteemi. Daatum määrab ära, kui täpselt mingi ellipsoid geoidi pinnale vastab (kui lähedal need teineteisele on). Lokaalsed daatumid, mis ei ole tingimata seotud Maa keskpunktiga, sobivad mingile väikesele maa-alale paremini, sest järgivad selles konkreetses kohas paremini Maa tegelikku kuju, ent ei ole hästi kasutatavad teistes kohtades. Eestis kasutatakse tänapäeval globaalset geotsentrilist ellipsoidi GRS80, mis on praktiliselt identne palju laialdasemalt kasutusel oleva globaalse WGS84 ellipsoidiga. Joonis 4.10: Erinevad daatumid: globaalne, geotsentriline WGS84 ja lokaalne NAD27 (allikas) Daatumi ja sobiliku koordinaatsüsteemi abil saamegi määrata objektide asukohti Maa pinnal: teame, millise kujuga ja mõõtmetega kujutame Maad ette, ning teame ka, millistes ühikutes ja millisest nullpunktist lugedes me sellel kujul objektide asukohti määravaid koordinaate arvestame. Geograafilised koordinaadid on alati seotud mingi daatumiga ning aitavad meil määrata objekti asukoha, kasutades pikkus- ja laiuskraade. Pikkuskraade loetakse kahele poole mingit meridiaani, tüüpiliselt Greenwichi observatooriumi meridiaani, (idapikkus ja läänepikkus), laiuskraade kahele poole ekvaatorit (lõunalaius ja põhjalaius). Asukohta esitatakse kraadides (°), minutites (’) ja sekundites (“) või kraadides kümnendsüsteemis. Mõtteharjutus: Kui iga kraad on jagatud 60 minutiks ja iga minut 60 sekundiks, siis kuidas kujutada kümnendsüsteemis koordinaate 58°22’48”N, 26°43’20”E? Selleks aga, et nüüd geograafilises ruumis paiknevaid objekte kujutada tasapinnalisel mudelil ehk kaardil, peame valima kaardi projektsiooni, mis määrab matemaatilise viisi, kuidas sfääriline pind tasapinnal esitatakse ning kuidas ruumilised koordinaadid (GCS) konverteeritakse ümber tasapinnalisteks koordinaatideks (PCS ehk projected coordinate system), mida väljendatakse x-i ja y abil. Sisuliselt määrab projektsioon ära ka selle, milliseid alasid maakeral me oleme nõus oma kaardil rohkem moonutama ja milliseid vähem ning mispidi me mingeid alasid kaardil venitame või kokku surume. Kui tahame kujutada ümmargust Maad kahemõõtmelisel tasapinnal, siis paratamatult peame mingit osa maakerast moonutama. Ühe või teise projektsiooni valimisel moonutame rohkem kas pindalasid, nurkasid, kujusid või joonpikkuseid. Joonis 4.11: Erinevad projektsioonid (allikas: Compare Map Projections) Projektsioonid jagunevad üldisteks tüüpideks selle järgi, kas ruumilist maakera üritatakse projitseerida silindrile, koonusele või tasandile. Need üldised tüübid jaotatakse omakorda selle järgi, kuidas vastav siirdepind on maaellipsoidi suhtes orienteeritud (normaal-, põik- või kaldaspekt). Joonis 4.12: Projektsioonitüübid (Aunap 2019: 169) Kõige tuntum ja enimkasutatud projektsioon on silindriline Mercatori projektsioon, mis on 16. sajandil nime saanud hollandi meresõitja Gerardus Mercatori järgi. Projektsioon moonutab nende alade suurusi ja kaugusi, mis jäävad ekvaatorist kaugemale põhja või lõuna poole, ent säilitab samas hästi nurgad. Nii oli võimalik merel näiteks otse mööda mingit pikkus- või laiuskraadi sõites jõuda välja õigesse kohta. Mercatori projektsiooni on 20. ja 21. sajandi jooksul palju kritiseeritud just alade suuruse moonutamise pärast, kuna see mõjutab mh inimeste ettekujutust kehtivatest võimusuhetest. Ehkki Mercatori (või õigemini veebi-Mercatori) projektsioon on põhiline projektsioon, mida kasutatakse veebikaartidel, on atlastes sellest tänapäeval suuresti loobutud ning kasutatakse pigem muid projektsioone (nt Robinsoni, Mollweide või Winkel-Tripeli projektsiooni). Projektsioonide arv on aga põhimõtteliselt lõpmatu, kuna olemasolevaid projektsioone on võimalik matemaatiliselt pidevalt muuta, et teha need sobivaks justnimelt mingile alale või mingiks ülesandeks (nt lennunduse jaoks). Riikidel on üldjuhul välja kujunenud oma riiklikud standardid (sh projektsioonid), mida riiklike ruumiandmete puhul kasutatakse. Eestis kasutatakse üldjuhul projektsiooni koodiga EPSG:3301, mis põhineb Lamberti konformsel koonilisel projektsioonil. Toredaid vidinaid projektsioonide võrdlemiseks leiab näiteks järgmistelt lehekülgedelt: Comparing Map Projections Projection Face World map projection comparison Map Projection Transitions Lõpetuseks. GIS-tarkvarades kohtad mõistet koordinaatide referentssüsteem (CRS - Coordinate reference system), mis koosneb daatumist ja projektsioonist. 4.3 Kaartide liigitus Kaarte võib liigitada põhimõtteliselt kõikide tema omaduste või elementide põhjal, samuti sisu põhjal. Levinud liigitusalused on näiteks teema: üldgeograafilised (nt looduslikud nähtused ja inimtekkelised objektid maapinnal), temaatilised (esitab mingi kategooria infot kaardil, nt majandus, kultuur, ajalugu, rahvastik, kliima vm; sageli koos aluskaartidega), erikaardid; mõõtkava: suuremõõtkavalised, keskmisemõõtkavalised, väikesemõõtkavalised, funktsioon: teaduslik kaart, katastrikaart, propagandakaart, turismikaart, teekaart, merekaart, … 4.3.1 Digitaalkaardid Üha rohkem puutume tänapäeval paberkaartide asemel kokku digitaalkaartidega. Ehkki mõlemal juhul näeme kaardil seda infot, mida kaardi tegija soovib edastada, ning sellisel kujul, nagu tema vajalikuks peab, on paber- ja digitaalkaartidel olulisi erinevusi. Joonis 4.13: Digitaal- vs. paberkaart (Suurna et al. 2010: 26) Digitaalkaardi eriliik on omakorda veebikaart, millest räägime lähemalt hilisemates praktikumides. 4.3.2 Viguriga kaardid Eri Eestiga seotud nähtuste (kohati väga loomingulist) kujutamist kaartidel võib vaadata näiteks Taavi Pae koostatud raamatust “Viguriga kaardid” (2022). 4.4 Kaartide koostamine ja kujundamine veebis Veebis on üksjagu valmis kaardirakendusi (nt Google My Maps, HERE Map Creator, PinMaps, Scribble Maps, ZeeMaps või spetsiaalselt humanitaarteadlastele mõeldud Palladio), mis võimaldavad teha ruumiandmete päringuid, võrdlemisi vähese vaevaga lihtsamaid analüüse (nt leia lühim/kiireim teekond punktist A punkti B) ning lisaks pakuvad mõned platvormid lisaks platvormi kaudu leitava info kasutamisele võimalust integreerida nendega ka enda andmeid ning kas või luua uusi ruumiandmeid. Lisaks sellele, et on võimalik enda andmeid n-ö olemasolevas süsteemis kuvada, pakuvad mõned platvormid võimalust ka ise aluskaardi tegemisel kaasa lüüa. Sellised on näiteks OpenStreetMap, WikiMapia ja Here WeGo, mis töötavad sarnaselt Vikipeediale: kasutajad saavad kaardi informatiivsust ja kvaliteeti ise parandada, lisades kaardile hooneid, teid jm objekte ning täiendades või parandades olemasolevate objektide infot. 4.4.1 ArcGIS Online Vaatame täna lähemalt ArcGIS Online’i võimalusi kaartide kujundamiseks ja enda andmete kujutamiseks. Selleks tuleb endale kõigepealt luua keskkonnas avalik konto ning seejärel keskkonda sisse logida. Kui oled sisse loginud, vali menüüribalt jaotis Map, mis viib sind nende Map Vieweri rakendusse. Joonis 4.14: ArcGis Online’i Map Viewer Vasakul vertikaalsel menüüribal saad lisada oma kaardile andmekihte (plussmärk), vaadata olemasolevaid kihte (Layers), atribuuttabeleid (Tables), valida aluskaarte (Basemap), lisada ja vaadata diagramme (Charts), kaardi legendi (Legend), kaarti salvestada ja salvestatud kaarte avada (Save and Open), vaadata üldisi kaardi sätteid (Map properties) ning kaarti välja printida. Parempoolsel vertikaalsel menüüribal saab määrata, kuidas meie erinevad kaardikihid välja näevad. 4.4.1.1 Aluskaart Valime esmalt oma andmetele aluskaardi. Aluskaart toimib tavaliselt teemakaardi kontekstina ega paku uurijale omaette huvi. Aluskaardi valimiseks vali vasakult menüüst Basemap ja seal pakutute hulgas mõni endale meelepärane kaardistiil. Joonis 4.15: Aluskaardi valimine Kaardistiili on võimalik ka pisut oma maitse järgi kohandada, valides nt Basemap -&gt; Current basemap, sealt muudetav aluskaardi kiht. Parempoolsest menüüst saab seejärel teha kaarti heledamaks või tumedamaks, muuta värvigammat, läbipaistvust jms. Näiteks võiksime püüda ära kaotada kohanimesildid, tänavad jms, kui neid meie teemakaardi jaoks tingimata vaja ei lähe (näiteks siis, kui meie kaart on väikese mõõtkavaga), ning teha kaarti veidi heledamaks. Joonis 4.16: Aluskaardi muutmine 4.4.1.2 Andmekihi üleslaadimine Nüüd lisame aluskaardile enda andmete kihi. Kasutame siin näitlikustamiseks üht väikest osa 19. sajandi teise poole Lõuna-Eesti vallakohtuprotokollidest, mille 2000. aastatel sisestas digitaalsel kujul Tõnis Türna (Rahvusarhiiv). 2016. aastal taastati algselt http://www.history.ee/vallakohus lehel olnud protokollid veebiarhiivide põhjal ning 2018-2019 katsetati nende peal eesti keele automaatset morfoloogilist analüsaatorit (Pilvik et al. 2019). Morfoloogilise analüsaatori ülesandeks on tunda ära sõnavorm (nt obbesel) ning pakkuda sellele sõnaraamatukuju (hobune), sõnaliik (S ehk substantiiv ehk nimisõna), vormiinfo (sg ad ehk singulari adessiiv ehk ainsuse alalütlev kääne) jm. Automaatses analüüsis tundmatuteks jäänud sõnavormide osakaal on umbkaudseks indikaatoriks sellele, kui erinev oli vastava protokolli keel tänapäeva keelest. Joonis 4.17: Vallakohtuprotokolli näide xml-kujul (Pilvik et al. 2019) Laadi endale Moodle’ist alla andmetabeli fail vallakohtuprotokollid1.csv, mis sisaldab semikoolonitega eraldatud tulpades järgmist infot: - Vald - valla nimi, - L/P - kas vald kuulus 19. sajandil põhja- või lõunaeesti keele kõnelemispiirkonda, - Norm - kas selle valla kohtuprotokollide keelt oli sisestamisel normaliseeritud kirjakeelele vastavamaks või mitte, - Kihelkond - kihelkond, mille alla vald paigutub, - Kih_id - kihelkonna lühend, - Murre - murdeala, mille alla vald paigutub, - Maakond - maakond, mille alla vald paigutub (NB! tänapäevane!) - Latitude - laiuskraad (põhi-lõuna), - Longitude - pikkuskraad (ida-lääs), - Protokolle - sisestatud protokollide arv, - TundmatuteProtsent - keskmine selle valla protokollides tundmatuks jäänud sõnade protsent, - Algus - kõige varasema protokolli kuupäev, - Lõpp - kõige hilisema protokolli kuupäev. Selleks, et andmed ArcGIS Online’i saada, valime vasakult vertikaalsest menüüst plussmärgi Add -&gt; Add layer from file. Lubatud formaadid on CSV (Comma-separated values ehk andmetabel, mille välju/tulpasid eraldavad komad), GeoJSON (ruumiandmete andmebaasiformaat) ja KML (Keyhole markup language ehk üks ruumiandmete standardformaate, mh kasutab seda nt Google Earth). Meie andmed on CSV-formaadis. Üleslaadimisel kuvatakse andmetabelis olevad atribuudid ja nende tüübid. Näeme näiteks, et pikkus- ja laiuskraadid, protokollide arv ja tundmatute analüüside protsent on õigesti tuvastatud arvuliste atribuutidena, protokollide kuupäevad kuupäevadena ja ülejäänud tunnused on tekstilised/kategoriaalsed. Joonis 4.18: Andmete atribuuttabel Järgmiseks küsitakse, millises tulbas on pikkus- ja laiuskraadid, et oleks punkte kuskile paigutada. Meie punktide koordinaadid on sobivasti juba Longitude- ja Latitude-nimelistes tulpades. Laadime punktid kaardile. 4.4.1.3 Andmekihi stiliseerimine Parempoolsest menüüst saame muuta punktide kuju, suurust, läbipaistvust, nähtavust (nt kas punktid on näha alles mingil sissesuumimise tasemel või kogu aeg) jpm. Teeme esmalt punktid pisut suuremaks ja veidi läbipaistvamaks, et näha paremini ka neid, mis üksteise alla jäävad. Selleks valime Styles -&gt; 2 Pick a style -&gt; Location (single symbol) -&gt; Style options -&gt; Symbol style. Joonis 4.19: Punktide muutmine Võime punktide konkreetse paiknemise asemel vaadata rastrina ka punktitihedust (mis piirkondadesse punktid koonduvad? kust meil rohkem andmeid on?), ehkki nii väheste punktide arvu korral pole see kuigi otstarbekas. Selleks valime Styles -&gt; 2 Pick a style -&gt; Heat Map. Heat map’idest ehk tiheduskaartidest räägime sel kursusel lähemalt geostatistika praktikumides. Joonis 4.20: Heat map 4.4.1.4 Atribuutide väärtuste kujutamine Selle asemel, et näidata lihtsalt meie andmepunktide paiknemist, võime kaardi muuta ka pisut informatiivsemaks ning kujutada punktide suuruse, kuju, värvi, läbipaistvuse vm kujunduslike omaduste mingeid andmetabeli atribuute ehk tunnuseid, mis neid punkte kuidagi iseloomustavad. Map Vieweris saame korraga valida ühe tekstilise/kategoorilise ja ühe arvulise tunnuse. Valime tekstilise tunnuse L/P, et näidata, millised vallad kuuluvad põhjaeesti ja millised lõunaeesti keele kõnelemise piirkonda. Valime arvulise tunnuse TundmatuteProtsent, et näidata, kui suur protsent sõnadest endale tänapäevase keele automaatanalüüsi vahenditega mingit analüüsi ei saanud (= milliste valdade protokollide keel on tänapäeva keelest kõige erinevam?). Selleks valime parempoolsest menüüst Styles -&gt; 1 Choose attributes ja lisame + Field nupust tunnused L/P ja TundmatuteProtsent. Vajutame Add. Nüüd näeme, et punktide värvi kaudu näidatakse, kumma keelevariandi kõnelemise alale vallad jäävad, ning suuruse kaudu seda, kui keeruline on automaatse analüüsi vahendite jaoks vastava valla protokolli keel (mida suurem punkt, seda keerulisem). Saame neid kujutusviise omakorda muuta, kui valime nüüd Styles -&gt; 2 Pick a style -&gt; Types and Size -&gt; Style options. Kategoriaalsete tunnuste väljanägemise muutmiseks valime Types (unique symbols) -&gt; Style options ning arvuliste tunnuste jaoks Counts and Amounts (size) -&gt; Style options. Tegeleme kõigepealt kategoriaalsete tunnustega: Types (unique symbols) -&gt; Style options: Muudame kõik punktid läbipaistvamaks: Symbol style -&gt; Fill transparency. Punktide piirjooned võiksime teha mingit muud värvi ja ka suhteliselt läbipaistvaks: Symbol style -&gt; Outline color ja Outline transparency. Teeme põhjaeesti keele punktid roheliseks ja lõunaeesti omad kollaseks: L/P -&gt; vajuta kummagi väärtuse sümboli peal (Change symbol). Joonis 4.21: Punktide kujundamine kategoriaalse tunnuse alusel Seejärel muudame punktide suuruse skaalat, mis näitab seda, kui suur on tundmatute analüüside protsent igas vallas: Counts and Amounts (size) -&gt; Style options: Määrame punktide suuruse lineaarselt vastavalt protsentide absoluutväärtustele: Size range (7-52). Joonis 4.22: Punktide kujundamine arvulise tunnuse alusel Lõpetuseks võiksime veel lisada punktidele juurde vastavate valdade nimed. Selleks valime paremalt menüüst Labels -&gt; Enable labels -&gt; Add label class ja määrame Label field väärtuseks tunnuse Vald. Selleks, et muuta seda, kuidas sildid välja näevad, valime Label style -&gt; Edit label style. Joonis 4.23: Siltide lisamine 4.4.1.5 Kaardi salvestamine ja jagamine Nüüd võime oma kaardi näiteks välja printida või faili salvestada, kui valime vasakult menüüst Print. Selleks, et kaarti oma ArcGISi keskkonda salvestada, valime vasakult Save and Open -&gt; Save as. Kaardi jagamiseks valime vasakult Share -&gt; Everyone (public). Saame kasutada kaarti nüüd näiteks oma ArcGISi kaardilugude põhjana või jagada seda URLi. Kui tahame kaardi nt HTMLi iframe’i märgendite abil teiste veebilehtede koodi sisse panna, peame kasutama Map Vieweri asemel praegu aga veel Map Viewer Classic rakendust. Joonis 4.24: Sama kaart Map Viewer Classicus Sealt võib valida Share -&gt; Embed this map -&gt; Embed in website ning kopeerida sobivate sätetega HTML-koodi oma veebilehe koodi sisse. Joonis 4.25: Kaardi kasutamine HTML-veebilehtedel Selle abil (või lihtsama iframe’i koodi abil) saab näidata sama kaarti ka nt siin kursuse kodulehe materjalides. &lt;iframe width=&quot;100%&quot; height=&quot;400&quot; frameborder=&quot;0&quot; src=&quot;https://www.arcgis.com/apps/Embed/index.html?webmap=9ff1cac51443442ca997ad7e606cf97e&amp;extent=23.5967,56.8847,28.601,59.0629&amp;zoom=true&amp;previewImage=false&amp;scale=true&amp;legend=true&amp;disable_scroll=false&amp;theme=light&quot;&gt;&lt;/iframe&gt; 4.4.2 Mapbox Studio Varasematel aastatel oleme kasutanud ka Mapbox Studiot. Ehkki suur osa Mapboxi teenuseid on tegelikult sellisele tavakasutajale, kelle kaarte ei vaadata veebis ühes kuus kümneid tuhandeid kordi, tasuta ning arve esitatakse alles siis, kui tasuta kasutuse limiit on ületatud, nõutakse nüüd konto registreerimisel ka krediitkaardi numbrit. Seetõttu on Mapboxi kasutamine sellel kursusel vabatahtlik ja järgnev materjal pigem lisa neile, kel asja vastu huvi. Mapbox on platvorm, mis pakub erinevaid tööriistu kaartide tegemise ja ruumiandmete analüüsiga seotud probleemide lahendamiseks (eelkõige veebis). Lisaks paljule muule võimaldab ka Mapbox veebipõhiselt oma andmete kujutamist kaardil ning üsna ulatuslikku kaartide stiliseerimist (Mapbox Studio). Mapboxis võid muuta näiteks kaardi värviskaalat, läbipaistvust, piirjoonte paksust, teksti suurust, fonti, keelt, objektide omadusi, ikoone, ühendada satelliitpildi jpm. Kaarti saab ka teha täiesti nullist ning valida olenevalt kaardi tegemist eesmärgist, milliseid kihte kaardil kuvada. Kaardi saab eksportida pildifailina ning kaardi stiili svg-failidena; stiili saab eksportida ka otse QGISi või ArcGISi või ka muudele platvormidele. Kuna Mapbox pakub ulatuslikku kontrolli kaardi väljanägemise üle, sobib see hästi ka story map’ide aluskaartide tegemiseks, kui on oluline, loo juurde käiks kvaliteetne visuaal (story map’ist räägime järgmisel korral). Mapboxi kasutamine eeldab, et oled registreerinud end kasutajaks. Kui oled sisse loginud, mine lehele Studio. Avaneb leht, mille ülaosas on kolm sakki: Styles, Tilesets ja Datasets. Joonis 4.26: Mapbox Studio Tileset on Mapboxi ruumiandmete formaat (nii raster- kui ka vektorandmetele), mida kasutatakse andmete kaardil esitamiseks. Võid importida oma andmed Mapboxi valmis tileset’ina või kasutada Datasets sakki, et laadida oma andmed üles, neid soovi korral töödelda (nt muuta arvulised atribuudid tekstiks või vastupidi, nt “6” -&gt; 6) ning seejärel tileset’i vormingusse konverteerida. 4.4.2.1 Kaardistiili kohandamine Proovime võtta esmalt lahti mingi olemasoleva stiili, uurida pisut selle komponente ning muuta mingeid kaardi parameetreid. Selleks vali sakk Styles -&gt; New style. Joonis 4.27: Vali kohandatav stiil Vaatame esmalt, mis projektsioonis kaart on esitatud, ning mängime pisut ka teiste projektsioonidega. Selleks vali 3D -&gt; Projection. Mapboxi projektsioonide kohta võid lugeda rohkem siit ja siit. Joonis 4.28: Kaardi projektsioon Sisse suumides kohandab Mapbox mis tahes projektsiooni tasapisi veebikaartidele kõige tüüpilisema projektsiooni ehk Mercatori projektsiooni suunas. Saame lisada kaardile soovitud komponente (nt teed, loodusobjektid, kultuuriobjektid jne) ja üleliigseid kustutada (Components). Samuti saame modifitseerida iga kaardikomponendi kihtide omadusi (Layers). Joonis 4.29: Komponendid ja kihid Suumime sisse Eesti alale. Kohandame olemasolevat stiili näiteks nii, et muudame põhivärvi (Base), veekogude (Water), administratiivpiiride (Administrative boundaries) ja kohanimede (Place labels) värvi Components -&gt; Colors -&gt; Manage colors, määra igale komponendile sobiv värv muudame riiginimede (Countries) fonti (mh läbivalt suurtäheliseks) ja suurust Components -&gt; Typography -&gt; Countries, vali sobiv suurus ja värv ning Text transform väärtuseks uppercase kustutame transpordisõlmede (Transit), huviväärsuste (Point of interest labels) ja looduslike objektide nimede (Natural features) kihi Components -&gt; Transit -&gt; Delete component teeme sama kihtidega Point of interest ja Natural features käsitleme teid-tänavaid ühtmoodi ning peidame kõikide teede ja tänavate (Road network) nimed Components -&gt; Road network -&gt; vali Simple -&gt; Labels, teeme valiku mitteaktiivseks muudame kõik teed-tänavad nähtavaks alles siis, kui sissesuumimise tase on vähemalt 13 Layers -&gt; Road network surface -&gt; Opacity -&gt; Override -&gt; Style across zoom range -&gt; määra Rate of change väärtuseks Step -&gt; Zoom 0 väärtuseks määra 0 (täiesti läbipaistev), Zoom 22 muuda Zoom 13ks ja määra sellele väärtus 1 (täiesti läbipaistmatu) peidame maismaa ja veekogude puhul (Land &amp; water) maakasutuse (landuse) ja maapinnakatte (landcover) andmed Components -&gt; Land &amp; water -&gt; Land -&gt; Simple jätame alles ainult riigipiirid, kaotame nende tagant halo, muudame piirjoone katkendjooneks, muudame selle paksust Components -&gt; Administrative boundaries, teeme mitteaktiivseks valikud Sate/province boundaries ja County/district boundaries, valime Country boundaries alt Dash pattern -&gt; Long dash Layers -&gt; Administrative boundaries admin -&gt; teeme nähtamatuks admin-0-boundary-bg admin-0-boundary -&gt; Width -&gt; Override, vali uus paksus eri suumimise astmetel peidame ära mandrite, osariikide ja maakondade ning asulasiseste alamjaotuste nimed. Muid kohanimesid näitame kohalikus keeles, riikide nimedel muudame taustahalo värvi Components -&gt; Place labels -&gt; Language -&gt; Local Components -&gt; Place labels, teeme mitteaktiivseks valikud Continents, States/provinces ja Settlement subdivisions Layers -&gt; Place labels place-labels -&gt; country-label -&gt; Halo color -&gt; Override -&gt; valime ainult ühe värvi kõikidele sissesuumimise tasemetele riigisisestest kohanimedest näitame ainult linnade (ja väikelinnade) nimesid teise värviga ja kaldkirjas, ilma taustahalo ja ikoonita alles siis, kui sissesuumimise tase on vähemalt 7. Components -&gt; Place labels -&gt; Settelements -&gt; Label style -&gt; Text only Layers -&gt; Place labels place-labels -&gt; settlement-minor-label, peidame kihi Layers -&gt; Place labels place-labels -&gt; settlement-major-label -&gt; Color -&gt; Override, määrame uue värvi Layers -&gt; Place labels place-labels -&gt; settlement-major-label -&gt; Font -&gt; Override -&gt; määrame mõne kaldkirjas fondi Layers -&gt; Place labels place-labels -&gt; settlement-major-label -&gt; Halo color -&gt; Override -&gt; määrame α väärtuseks 0 Selleks, et nüüd valida, mis üksusi kaardil mingi suumi tasemega kuvatakse, peame natuke muutma alusandmete filtreid. Alusandmetena kasutatakse vaikimisi Mapbox Streets v8 vektorkihtide tileset’i, kus on info kõikide nende objektide kohta, mida komponentidena lisada ja muuta saab. Selleks, et selle kihi andmetele ligi pääseda, peame valima Components -&gt; Place labels -&gt; Eject component -&gt; Eject 3 layers. Komponendi kihid muudetakse nüüd eraldiseisvateks kihtideks, mille andmeid saab ükshaaval muuta. Layers -&gt; settlement-major-label -&gt; Select data -&gt; Filter, kustutame kõik 3 olemasolevat filtreerimise tingimust (Edit -&gt; Delete condition). Loome uue tingimuse: Create filter -&gt; type, valime ainult väärtused city ja town Layers -&gt; settelement-major-label -&gt; Select data -&gt; Zoom extent, määrame Min väärtuseks 7 ja Max väärtuseks 22. See tähendab, et linnade nimesid hakatakse näitama alles siis, kui oleme sissesuumimise tase on vähemalt 7, ja nimesid näidatakse kuni viimase sissesuumimise tasemeni välja. Läheme andmete valimise juurest tagasi andmete stiliseerimise juurde (Style) Joonis 4.30: Stiliseeritud kaardipõhi Kui meil on tegelikult vaja ainult mingit väga üldist kaarti nt ainult administratiivpiiridega ja ilma igasuguste veeniredeta jms-ta, saame lisada eraldi Mapboxi riikide kihi Mapboxi vektorandmete lehelt. Selleks Layers -&gt; Source -&gt; None selected -&gt; Unused sources -&gt; Mapbox Countries v1 -&gt; Country boundaries liigutame riikide kihi kohanimede (Place labels) ja halduspiiride (Administrative boundaries) alla. värvime Eesti teist värvi: Layers -&gt; country-boundaries -&gt; Color -&gt; Style with data conditions -&gt; Choose a data field from -&gt; name_en -&gt; “Estonia”, vali sobiv värv. Teiste riikide ala (Fallback value ehk kõik, mis ei vasta tingimusele nimi == Estonia) võid muuta muud värvi. Joonis 4.31: Mapboxi riikide vektorkihi lisamine ja polügoonide värvimine tingimuse alusel 4.4.2.2 Oma andmete lisamine Nagu öeldud, lubab Mapbox visualiseerida ka enda andmeid. Selleks, et kujutada neid andmeid Mapboxis loodud aluskaardil, vali Layers -&gt; Add new layer -&gt; Source -&gt; Upload data, vali Moodle’ist alla laaditud fail vallakohtuprotokollid1.csv oota, kuni andmed on üles laaditud. Tasuta saab oma andmestikku ühes kuus üles laadida 20 korda. Kui andmed on üles laetud, vali Source alt kiht, mis algab tekstiga vallakohtuprotokollid1. Saad valida, millisena soovid andmekihti kuvada (nt punktidena, joontena, sümbolitena vm-na). Saki Style alt saad omakorda määrata, milline valitud objektitüüp täpselt välja näeb. Joonis 4.32: Mapboxi üles laaditud valdade punktid Kõiki elemente võib värvida ühtmoodi konkreetse väärtusega (nt kõik punktid olgu punased). Võimalik on aga kasutada värvi, läbipaistvust, suurust ka selleks, et väljendada mingit andmestiku atribuuti (= tunnust = tulpa). Värvime punktid esmalt näiteks selle järgi, millised vallad kuuluvad põhja- ja millised lõunaeesti murrete kõnelemispiirkonda (kvalitatiivne rühmitav atribuut), ning seejärel muudame punktide suurust selle järgi, kui palju oli valdade protokollides keskmiselt selliseid sõnu, mida tänapäeva kirjakeelel treenitud morfoloogiline analüsaator ära ei tundnud (kvantitatiivne atribuut). Layers -&gt; vallakohtuprotokollid1 -&gt; Color -&gt; Style with data conditions -&gt; data field on L/P. Määrame põhjaeestile ehk P-le näiteks mõne külmema tooni ja lõunaeestile ehk L-le mõne soojema tooni. Layers -&gt; vallakohtuprotokollid1 -&gt; Radius -&gt; Style across data range -&gt; data field on TundmatuteProtsent. Kõige väiksem protsent andmestikus on 7%, määrame sellele suuruseks näiteks 3 pikslit. Kõige suurem protsent on 52%, määrame selle suuruseks näiteks 12 pikslit. Kõik ülejäänud punktisuurused paigutatakse tundmatute analüüside protsendi järgi nende kahe vahele. Võime lisaks määrata veel ühe tingimuse, et punktide suurust hakataks eristama alles siis, kui sissesuumimise tase on näiteks 5, enne seda on kõik punktid 3 piksli suurused. Kuna osa punkte kattub, võiksime teha punkte pisut läbipaistvamaks. Selleks vali Layers -&gt; vallakohtuprotokollid1 -&gt; Opacity -&gt; määra väärtuseks näiteks 0.5, nii on punktid poole läbipaistvamad. Joonis 4.33: Lõuna- ja põhjaeestikeelsed protokollid ning tundmatute analüüside protsent Näeme nüüd, et lõunaeestikeelsete protokollidega on tänapäeva kirjakeelel treenitud keeleanalüsaatoril palju keerulisem hakkama saada kui põjaeestikeelsete protokollidega. Ometi on ka põhjaeestikeelsete protokollide hulgas kaks valda, milles oli oluliselt rohkem analüsaatorile tundmatuid sõnavorme. Milles asi? Püüame eristada valdu veel ühe kvalitatiivse tunnuse, normaliseerimise alusel. Selleks saaksime ühesuguste punktide asemel kasutada näiteks erinevaid sümboleid normaliseeritud ja normaliseerimata protokollide kohta. Kuna aga selle jaoks peaksime minema algusesse tagasi ning Select data alt valima punkti asemel sümbolid ja kogu senine töö protokollidega läheks kaotsi, eristame normaliseeritud ja normaliseerimata tekste punktide äärejoonte paksuse kaudu. Layers -&gt; vallakohtuprotokollid1 -&gt; Stroke width -&gt; Style width data conditions -&gt; Data field on Norm. Määrame normaliseeritud (J) protokollidele väärtuseks 0 ja normaliseerimata (E) protokollidele väärtuseks 1. Võime muuta ka piirjoone värvi, kui muudame Stroke Color väärtust. Joonis 4.34: Normaliseeritud ja normaliseerimata tekstid Nüüd näeme, et lisaks lõuna- ja põhjaeesti keelele mängib analüsaatori jaoks olulist rolli ka see, kas teksti on püütud sisestamisel tänapäeva kirjakeelele lähendada või mitte. Lõpetuseks võiksime näidata sisse suumides ka valdade nimesid. Selleks peame lisama teise samasuguse vallakohtuprotokollide kihi, ent punktide asemel valima nüüd sümbolid ja sümbolite alt teksti, mille abil kuvada tunnust Vald. Joonis 4.35: Valdade nimed eraldi kihil Kihtide järjekorda muutes saame kontrollida, mida meie kaardilt näha on (näiteks võib riigipiiride kihi tõsta kohanimede kihist ettepoole, kui ei taha, et sisse suumides ilmuksid nähtavale linnade nimed). Kahjuks ei võimalda Mapbox Studio praegusel hetkel lisada kaardile legendi jms kaardi elemente. Mapbox Studio võimaluste kohta võid põhjalikumalt lugeda sellest juhendist. 4.4.2.3 Kaardi jagamine Loodud kaarti saame printida/faili salvestada või eksportida kuskile veebikeskkonda. Kaardi eksportimiseks ja selle kasutamiseks nt mõnes muus veebikeskkonnas aluskaardina, vali ülevalt menüüst Share. Preview only linki jagades saab kes tahes lingiga sinu kaarti vaadata. Mujal keskkondades kasutamiseks või stiili jagamiseks teiste Mapboxi kasutajatega tuleb loodud stiil esmalt teha avalikuks: Allow copying: Make public. Website embed annab iframe’i koodi, mille saab kleepida mis tahes veebilehe HTML-koodi sisse, et kaart ilmuks mingil veebilehel. Developer resources lubab kaardistiili kasutada muudes veebi- või telefonirakendustes. Näiteks Web saki alt leiab stiili aadressi (Style URL) ja juurdepääsuloa (Access token), mille abil on võimalik kasutada Mapboxis loodud stiili mõnes veebirakenduses (nt StoryMapJS). Saki Third party alt leiad aadressi, millega saab kasutada loodud stiili suuremate GIS-tarkvarade rakendustes (ArcGIS, Carto, QGIS). Sellest järgmisel korral veel. Joonis 4.36: Kaardistiili jagamine 4.5 Järgmisel korral Esmaspäeval tegeleme sellega, kuidas kaardi abil lugusid jutustada (Story Maps). "],["storymaps.html", "Praktikum 5 Story maps 5.1 Story maps 5.2 Ülesanne: tänane kuupäev story map’is 5.3 Järgmisel korral", " Praktikum 5 Story maps 5.1 Story maps Story map, mida on eesti keelde tõlgitud kui kaardilugu, on formaat, mis võimaldab piltide, teksti, video ja kohainfo kaudu jutustada lugusid fotograafiast, kunstist, kirjandusest, spordist, ajaloost, teadusest, ühiskonnast ja paljust muust. Kontseptsioon on lihtne: kaardile märgitakse punktid, mille juurde saab lisada nii tekstilist kui ka pildilist infot selles kohas toimunud sündmuse või selles kohas paikneva objekti kohta. Kaardi punkte omavahel ühendades tekibki mingi narratiiv. Laiemas tõlgenduses ei pea story map’i kaart olema tingimata geograafiline. Kontekstina võib toimida ka näiteks mõni maal, foto või muu visuaal, ent taust on sel juhul siiski käsitletav ruumina, milles saab loogiliselt liikuda. Klassikalises story map’is on lähtepunktiks siiski mingi narratiiv, mida mööda liikudes liigume ka vastavatesse paikadesse geograafilisel kaardil. Ühest küljest on story map’il palju ühist tavaliste veebilehtedega, kus jutustatakse mingit lugu, mida illustreerivad muu materjali kõrval ka kaardid, ent story map’il on koht (ja aeg) oluliselt prominentsemal kohal. Teiselt poolt on story map’il ühisjooni tavaliste kaardirakendustega, kuhu saab lisada ruumiobjekte, mida iseloomustavad teatud atribuudid. Atribuudina võib näiteks lisada ka pikema teksti, lingi pildile või videole jpm. Väga selget piiri story map’i ja kindlasti-mitte-story-map’i vahele on raske tõmmata, ent kuna story map’i fookus on selgelt mingi loo jutustamisel või argumendi esitamisel, on see enamasti visuaalselt esteetilisem ja sujuvam ning oluliseks omaduseks on väljundi võimalikult lihtne ja kiire integreeritavus erinevate veebiplatvormidega. Story map on hea meedium näiteks esitluste ja ettekannete jaoks, kui aeg ja koht (õigemini kohad) on narratiivi või argumendi esitamise seisukohast olulised. Kõige rohkemate funktsioonide ja võimalustega teenust story map’ide tegemiseks pakub ilmselt ESRI oma ArcGIS StoryMaps rakenduse kaudu. ESRI-l on ka eraldi digihumanitaaria story map’ide kollektsioon. Mõned näited: Kaardilugusid on üha enam hakatud tegema ka Eestis, vaata näiteks Keskkonnaagentuuri, statistikaameti kaardilugusid. Ka 2023. aasta konkursil “Andmepärl” parima infograafika tiitliga pärjatud Eesti Ekspressi lugu Tallinna elanike kohta on oma olemuselt kaardilugu. Sel korral vaatleme esmalt vabavaralist platvormi StoryMapJS ning võrdleme seda seejärel ESRI platvormi tasuta funktsioonidega. 5.1.1 StoryMapJS Loo tegemiseks pead Google’i kasutajakontoga sisse logima. Kui oled sisse loginud, vajuta nupul New. Nimeta oma lugu. Loo nimi saab ühtlasi sinu projekti ID-ks, mida kasutatakse hiljem loole viitava lingi nimes. Kui kasutad mitmesõnalist nime, milles tühikud eraldavad sõnu, siis asendatakse need ID-s sidekriipsudega. Sätete (Options) alt saad valida: kaardi suuruse (kõrgus (Height) pikslites, laius (Width) protsentides ekraani laiusest); keele. Keel määrab ära, mis keeles kuvatakse kasutajale igasugu nupud ja juhised. Valikus on ka eesti keel; teksti fondi (küsimärgile vajutades näed ka, millised eri variandid välja näevad); kas soovid, et kaardi erinevate punktide vahele tõmmataks joon (treat as cartography) või mitte (treat as image); esilehel kuvatava nupu nt vaatama kutsuva tekstiga (call to action); aluskaardi. Saad valida nii olemasolevate põhjade vahel kui ka omaenda või teiste kohandatud kaartide vahel. Näiteks on võimalik integreerida Mapboxi kaarte, kui kopeerid sinna Mapboxi stiili veebiaadressi ja juurdepääsuloa (vt eelmise korra materjale). Joonis 5.1: Storymaps JS sätted Kui oled oma loo n-ö ära seadistanud, siis saad hakata lisama sisu. Kõigepealt saad valida pildi, mida avalehel näidatakse (Media), lisada pealkirja ja tutvustava teksti ja muuta soovi korral tausta (Background Options). Joonis 5.2: Storymaps JS avakuva seadistamine Preview vahelehel näidatakse story map’i väljundit, lehe vasakul poolel hakatakse kuvama loo kaarti, kui mingid kohad on juba ära märgitud. Sisu lisamiseks lisa slaid (Add slide). Iga slaid on seotud ühe kohaga. Esmalt otsi koordinaatide või kohanime järgi koht, millega slaidil esitatav loo osa seotud on. Saad vahetada koha markerit ka mõne enda üles laetud pildi/ikooni vastu (Marker Options). Võid lisada nii pilte kui ka videoid, samuti saab teksti sisse lisada linke. Kui oled loo valmis saanud, siis salvesta see (vasakul ülemises menüüs nupp Save). Oma lugu võib jagada (paremal ülemises menüüs nupp Share) lingiga või ka näiteks otse Twitteri, Facebooki, Google+’i või Redditi kaudu. Samuti võib selle iframe’i koodi abil lisada otse enda veebilehele (näiteks Wordpressi, Mediumi või mujale, kasvõi sellele kursuse lehele siin). Joonis 5.3: Storymaps JS väljundi kuvamine iframe’i kaudu (väga lihtsal) veebilehel 5.1.2 ArcGIS StoryMaps Loo tegemiseks pead looma (avaliku) kasutajakonto. Seejärel saad meilile aktiveerimislingi ning sellele vajutades saabki konto loomise lõpule viia (määrata kasutajanime ja parooli jms). Kindluse mõttes võib esmalt ära vahetada vaikimisi platvormi keele, kui see ei ole inglise keel. Vastasel juhul võivad mõned tõlked arusaamatuks jääda (nt sõna heading tõlkena võib kohata sõna suund). Selleks saab minna üleval paremas nurgas enda profiili lingile ning vaadata lähemalt seadeid (Kuva minu seaded või View my settings) ning uuenda keelt, numbri- ja kuupäevavorminguid. Seejärel trüki aadressiribale uuesti https://storymaps.arcgis.com. Uue loo tegemiseks vajuta nupul New story. Võib alustada tühja malliga või valida mallitüübi Sidecar (tekst ja visuaal kuvatud kõrvuti paneelidel, sobib hästi, kui suurem rõhk on näiteks tekstil) Guided map tour (tekst ja visuaal kuvatud kaardil, vaataja liigub mööda punkte kindlaks määratud järjekorras) Explorer map tour (nagu eelmine vormel, aga vaataja saab valida, mis järjekorras mööda punkte liigub). Kasutame siin tühja malli, millele saame lisada teisi malle juurde. Tiitellehele saab märkida oma projekti nime ja lühikese tutvustuse. Võib lisada juurde ka pildi või video (NB! Kui kasutad teiste tehtud materjale, viita kindlasti ka autorile). Joonis 5.4: ArcGIS StoryMapsi avakuva Plussikestest saad lisada uusi plokke: teksti (Text), nupu, mis viib nt mingile lingile (Button), horisontaalse eraldusriba eri tekstiplokkide vahele (Separator), koodiploki (Code), tabeli (Table) kuni 8 tulba ja 10 reaga, kaardi (Map), pildi (Image), video (Video), liuguri, mis lubab kõrvutada kaht kaarti või pilti (Swipe), teisi loomalle (Slideshow, Sidecar, Map tour), mille sisse omakorda võib lisada üleval nimetatud elemente. Tasulises versioonis on võimalik kasutada veel plokitüüpe. Kaardi (Map) võid lisada juba varem valmis tehtud kaartide hulgast (nt eelmisel korral tehtud vallakohtuprotokollide kaart) või teha kohapeal uus. Selleks tuleks valida esmalt aluskaart (basemap), seejärel lisada tekst, meedia ja siduda punktid konkreetsete kohtadega. Kõige lihtsam on seda teha nii, kui valid Map -&gt; New express map Joonis 5.5: ArcGIS StoryMapsi kaardi lisamine Joonis 5.6: Joonistamise võimalused kaardi tegemisel Võid aluskaardina kasutada ka Mapboxis stiliseeritud kaarti. Joonis 5.7: Mapboxi kaardi kasutamine aluskaardina Saad kaardi lisada ka Map tour formaadis. Joonis 5.8: ArcGIS StoryMapsi kaardi lisamine Map tour formaadis Kui lugu on valmis, avalikusta lugu (ülemises menüüs nupp Publish). Kaarti saab jagada samuti lingiga (kui lugu on avalik) ning lisada iframe’i koodiga teistele veebilehtedele (More actions -&gt; Embed this story). Vaata lähemalt kõikide ArcGIS-i story map’ide võimalusi siit. Veel paar aastat tagasi oli võimalik vähese vaevaga kasutada story map’ide tegemiseks ka platvorme nagu MapStory või Odyssey.js, ent nende kasutamine on praeguseks oluliselt raskendatud (nõuab veidi koodikirjutamisoskust ning kõik funktsioonid ei ole enam toetatud). 5.2 Ülesanne: tänane kuupäev story map’is Otsi Vikipeediast tänase kuupäevaga seotud sündmus (nt ajalooline sündmus, mõne kuulsa isiku sünni- või surmakuupäev), võid kasutada ka eestikeelset nimekirja, ning kujuta vastavat Vikipeedia artiklit või selle olulisemaid osi story map’il kas StoryMap JS või ArcGis Story Maps keskkonnas. Lisa võimalusel pilte, linke ja muud, mis loo käiku aitavad jälgida. Avalikusta valmis story map ning lisa iframe’i kood ühisesse faili: Manusta -&gt; Manusta kood -&gt; sisesta iframe’i kood -&gt; Järgmine -&gt; Sisesta. 5.3 Järgmisel korral Kolmapäeval kolime lõpuks QGISi ning teeme esimesed sammud tarkvaraga tutvumisel. "],["qgis_1.html", "Praktikum 6 Sissejuhatus QGISi (1) 6.1 Installimine 6.2 Andmed ja failihaldus 6.3 Esimene seadistamine ja kasutajaliides 6.4 Andmete avamine 6.5 Kihtide visualiseerimine 6.6 Aluskaardid 6.7 Järgmisel korral", " Praktikum 6 Sissejuhatus QGISi (1) QGIS (varasemalt Quantum GIS) on vabavaraline ja avatud lähtekoodiga geoinfosüsteemide tarkvara, mida saab kasutada kõikide tuntumate operatsioonisüsteemidega. QGISis saab rakendada kõiki põhilisi ruumiandmete analüüsi meetodeid ning funktsionaalsuselt ei jää see sugugi alla kommertstarkvarale (nt ArcGIS). 6.1 Installimine QGISil on alati kaks hetkeversiooni: stabiilne Long term release (LTR) ja uusimate võimalustega Latest release (LR). Väga suuri erinevusi nende versioonide vahel ei ole, eriti selle kursuse raames käsitletavate tööriistade osas. Arvutiklassi arvutitesse peaks olema installitud kõige hiljutisem stabiilne versioon 3.28, järgmine stabiilne versioon tuleb aga välja juba 27. oktoobril. Kel huvi, võib vaadata ka väljalaskegraafikut. QGIS 3.28 saab alla laadida ametlikult kodulehelt, valides enda arvuti operatsioonisüsteemile sobiva variandi. Allalaadimine võib pisut aega võtta. Kui allalaadimine on lõppenud, ava fail ning installi programm. Kasuta vaikimisi valikuid. 6.2 Andmed ja failihaldus Segaduste vältimiseks on soovitatav kursusel kasutada kaustade struktuuri, kus selle kursuse kaustas on QGISi projekti fail(id) laiendiga .qgz ja kaustad andmed ja kaardid, kuhu panete vastavalt kõik praktikumides kasutatavad andmed ja valminud kaardid. Võimalike probleemide vältimiseks (eriti Windowsi operatsioonisüsteemis) võiks kursuse kaust olla kohas (directory path), kus ei ole täpitähti. Nt C:/ut/magistrantuur/sygis_2023/geohum2023/. Näiteks: C:/…/geohum2023/ praktikum_6.qgz andmed/ kirikud.gpkg vallakohtuprotokollid1.csv jne kaardid/ pr6_ylesanne_1.png pr6_ylesanne_2.jpeg jne Praktikumis kasutatavad andmed leiate Moodle’ist. Laadige need alla, pakkige lahti (parempoolne klikk ja Extract here) ja asetage kausta andmed. Soovi korral võite Eesti maakondade kihi ka ise Maa-ameti Geoportaalist alla laadida, kuna tegu on avalike ruumiandmetega. Siin kasutame shapefile-formaadis maakondade vektorandmeid (Maakond SHP). Klikkides jaotisel Ruumiandmed leiab ka rohkelt muid andmeid. 6.3 Esimene seadistamine ja kasutajaliides Avame programmi QGIS Desktop 3.28. Sageli on esimisel korral avades QGIS eestikeelne. See on küll tore, kuid kahjuks on tõlge poolik ning internetist abi otsides on eestikeelsetest terminitest vähe kasu. Niisiis kasutame kursusel ingliskeelset versiooni. Selleks saab valida ülaserva menüüst Seaded → Suvandid → Üldine (vasakul servas). Teeme linnukese Override System Locale ette. Valime User Interface Translation rippmenüüst American English. Locale (numbers, date and currency formats) juures ei tule midagi muuta. See peab jääma Estonian Estonia (et_EE). Vajuta all servas OK. Sulge QGIS ning ava uuesti. Nüüd on programm ingliskeelne. Joonis 6.1: Keele muutmine QGISis 6.3.1 Vaikimisi koordinaatide referentssüsteemi sätestamine. Kuna enamik harjutusi kursusel käsitlevad Eesti ruumiandmeid, siis oleks mõistlik valida vaikimisi koordinaatide referentsüssteemiks (CRS) ka Eesti süsteem: Ülevalt servast menüüst valime Settings → Options → CRS and Transforms → CRS Handling. Alumisel gif-il on kasutatud eelmist QGISi stabiilset versiooni, kus seda nimetati lihtsalt CRS-iks. CRS for Projects alt valime Use a default CRS, klikime rippmenüü kõrval ikoonil ja kirjutame seal Filter otsinguse Estonian Coordinate System of 1997 ehk L-EST97. Vajutame sellele otsingu tulemusele ning menüü alumises servas OK. Teeme sama CRS for Layers juures. vajutame OK ja sulgeme seaded. Vahetame ka praeguse projekti CRS-i. Selleks klikime ekraani alumises paremas nurgas maakera ikooni kõrval ning valime ka seal EPSG:3301 koodiga CRS-i. Joonis 6.2: Koordinaatsüsteemi sätestamine Salvestame QGISi projekti oma kursuse kausta, valides ülevalt vasakult Project → Save. Failinimeks võib panna näiteks praktikum_6. Praktikumi jooksul võiks projekti aeg-ajalt salvestada! Vaata QGISi kasutajaliidest. Suurde keskel olevasse aknasse ilmuvad kaardid ja ruumiandmete kihid graafiliselt. Vasakul on kihtide aken Layers. Allservas näeme kursori asukoha koordinaate, mõõtkava, mida saab seal ka muuta, ning paremal nurgas on koordinaatsüsteem, mis peaks nüüd olema EPSG:3301. Üleval servas on menüüd ja kõiksugused tööriistad. 6.4 Andmete avamine Nagu varasematest mäletame, on põhilised ruumiandmete tüübid raster- ja vektorandmed. Viimased neist võivad koosneda punktidest, joontest või polügoonidest. Avame kõigist andmetüüpidest näite. Avame Eesti maakondade kihi. Layer → Add layer → Add vector layer. Kliki Vector Dataset(s) juures sirvimise ikoonil (kolm punkti). Vali andmete kaustast shape-fail maakond_20231001.shp ja vajuta Open. Seejärel menüü all servas Add ja Close. Nüüd on avatud kiht kõigi Eesti maakondade piirjoontega. Avame muinsuskaitse all olevate kirikute kihi. Kõik samamoodi nagu eelmise kihiga, valida tuleb lihtsalt geopackage’i fail kirikud.gpkg. Avame suuremate jõgede kihi joed.gpkg. Kui on juba selge, kuidas käib menüü kaudu kihi avamine, siis võib selle kihi avamiseks faili ka lihtsalt kaardiaknasse lohistada. Joonis 6.3: Vektorkihtide lisamine Kihtide paneelil Layers saab kihte välja ja sisse lülitada ning hiirega tõstes muuta nende järjekorda. Peaaknas saab hiire rullikuga suumida (all servas muutub ka mõõtkava). Hiire vasakpoolset klahvi all hoides ja ka klaviatuuri nooltega saab kaardil liikuda. Mingi kihi terve ulatuse nägemiseks vali Layers paneelil kiht, tee sellel paremklikk ning vali Zoom to Layer. Sellest on abi ka siis, kui oled kaardil n-ö eksinud ja ei suuda kihti enam üles leida. Kihtide atribuuttabelit saab vaadata, kui teha kihil paremklikk ja valida Open Attribute Table. Proovime kaardil ringi liikuda ning vaatame kõikide kihtide atribuuttabelit. Joonis 6.4: Maakondade vektorkihi atribuuttabel Vaatame ka näidet rasterandmetest ortofotode näol. Ava 2020. a ja 1995. a ortofotod kasutades Layer → Add Layer → Add Raster Layer ning vali vastavalt failid orto_2020.tif ja orto_1995.tif. Vajuta Add ja Close. Esmapilgul ei ole midagi näha, kuna ortofotod on väga suure mõõtkavaga (=väga väikese ala kohta). Liigu kihtide juurde (paremklikk -&gt; Zoom to Layer(s)) ja vaata nende erinevusi. Selleks lülita vastavaid kihte Layers paneelil sisse ja välja. Proovi ka lähedale suumida, et näha eraldiseisvaid piksleid. 1995. aasta ortofotol on oluliselt vähem piksleid, mis tähendab, et ühe piksli mõõtmed on palju suuremad. Rasteri pikslisuuruse vaatamiseks tee kihil paremklikk → Properties. Vali jaotis Information. Information from provider juures on kirjas Pixel size, antud juhul piksli küljepikkus meetrites. Pärast seda võib rasterkihid eemaldada. Selleks tee kihtide aknas kihil paremklikk → Remove layer. Võid mõlemad kihid ka korraga eemaldada. Joonis 6.5: Rasterkihtide lisamine Ortofotode kohta saab rohkem lugeda ja neid ka ise kaardiruutude kaupa alla laadida Maa-ameti Geoportaalist. 6.5 Kihtide visualiseerimine Selleks, et kõik kihid välja paistaksid, peaksid need olema ülevalt alla järjekorras kirikud, jõed, maakonnad. Andmete visualiseerisemiseks on meil punktide puhul kasutada värv, kuju ja suurus. Joonte ja alade puhul on meil kuju ette antud, kuid saame lisaks värvile ja suurusele vahetada mustrit (nt katkendjoon või viirutatud ala). 6.5.1 Harjutus 1 Muudame kihtide stiili nii, et kirikud paistaksid selgelt välja, jõed oleksid sinised ja nähtavad ning maakondi tähistaksid ainult nende piirjooned. Lisame ka maakonnanimed. Sümbolite muutmiseks teeme kihil topeltkliki (või paremkliki ja valime Properties) ning avanenud aknas valime vasakul servas jaotise Symbology. Avanenud menüüs valime punkt- ja joonobjektidele värvi (Color) ja suuruse (Size, joonte puhul Width). Võib mängida ka läbipaistvusega (Opacity). Kui tahad vahetulemust näha, aga ei taha Properties akent kinni panna, võid vajutada avanenud akna alumises servas nupule Apply. Kui oled tulemusega rahul ja rohkem midagi muuta ei taha, vajuta OK. Pindobjektidele ehk maakondade polügoonidele valime sümbolitüübiks Simple fill asemel Outline: Simple Line. See tähendab, et kogu ala pole mitte mingi värviga täidetud (fill), vaid näeme ainult ala piirjooni. Võib muuta ka piirjoonte värvi ja paksust (Stroke width). Alternatiivina võib kihi stiili muutmiseks sisse lülitada paneeli Layer Styling. Selleks valime üleval menüüribal View → Panels → Layer Styling. Nüüd on seesama Symbology aken kaardiakna kõrval ning muudatused on kohe paremini näha. Lisame maakonnanimed, valides maakondade vektorkihi puhul samas menüüs vasakult Labels ning seal No Labels asemel Single Labels. Value alt vali MNIMI. Joonis 6.6: Harjutus 1 tulemus Kas see on hea visualiseerimine? Mis on hea, mis on puudu, mis on üleliigne, kui eesmärgiks on näidata kaitse all olevate kirikute arvu maakonnas? 6.5.2 Harjutus 2 Harjutuse eesmärk on luua kaart, mis näitab maakondade värvi abil, kui palju on muinsuskaitse all olevaid kirikuid maakondades (nn horopleetkaart 4.3). Teisisõnu: klassifitseerime maakonnad selle järgi, millist kirikute arvu põhjal moodustuvat sagedusklassi nad esindavad. Selleks tuleb maakondade polügoonide kihiga siduda tabel, kus on kirjas iga maakonna kirikute arv, ning värvida seejärel maakonnad vastavalt sellele arvule. Avame Exceli, Notepad++-i vms programmiga faili kirikud_maakonniti.csv. Nagu näha, on tegu väga lihtsa andmestikuga, kus on ainult kaks tulpa ja 15 rida (iga maakonna kohta üks rida). Avame sama faili QGISis: Layer → Add Layer → Add Delimited Text Layer Klikime File name juures sirvimise ikoonil (kolm punkti). Valime kaustast faili kirikud_maakonniti.csv. Valime File Format juures CSV (comma-separated values ehk tabel, kus tulpasid eraldavad komad). Record and Fields Options juures teeme linnukese First record has field names ette. See on vajalik, et QGIS arvestaks tabeli esimest rida kui tulpade pealkirju. Geometry Definition juures valime No geometry (attribute only table). See tuleb valida, kuna antud tabelis ei ole ühtegi koordinaatidega tulpa. Kui oleks, saaksime siin määrata, millise nimega tulbas paiknevad pikkus- ja millise nimega tulbas laiuskraade kuvavad koordinaadid, samuti selle, millises CRSis koordinaadid on määratud. Vaatame nüüd, kas all Sample Data aknas on andmed kujutatud eraldi tulpades ja täpitähed olemas. Kui täpitähti pole, peame valima üleval Encoding rippmenüüst iso8859_15, mis on ametlik eesti keele kodeering, või windows-1252. Tegelikult töötavad veel paar kodeeringut. Add → Close. Nagu näha, ei ilmunud QGISi peaaknasse midagi, kuna tegu pole ruumiandmete kihiga, vaid lihtsalt tabeliga. Vaatame kihtide paneelis lisatud CSV-faili atribuuttabelit. See on samasugune nagu Excelis/Notepadis. Ühendame kultuurimälestiste tabeli maakondade kihiga: Andmestike ühendamiseks peab olema mõlemas andmestikus tulp, mille sisu kattub teise andmestiku ühe tulba sisuga. Käesoleva kahe andmestiku puhul on mõlemal tulp maakondade nimedega: maakondade vektorkihil on selle atribuudi nimi MNIMI ja csv-kihil maakond. Kuna ühendame ruumiandmetega mitteruumiandmeid (ja mitte vastupidi), valime Layers paneelil maakondade polügoonide vektorkihi, teeme sellel topeltkliki, valime vasakul servas jaotise Joins ning vajutame all servas rohelisele plussmärgile. Täidame avanenud aknas väljad järgmiselt: Join layer: kirikud_maakonniti (see on see mitteruumiandmete kiht, mida ruumiandmetega liidame) Join field: maakond (mitteruumiandmete kihi tulp, mille sisu kattub ruumiandmete kihi ühe tulba sisuga) Target field: MNIMI (ruumiandmete kihi tulp, mille sisu kattub mitteruumiandmete kihi ühe tulba sisuga) Joined fields ette teeme linnukese ja seal omakorda linnukese ainult tulbanime kirikuid ette, kuna me ei soovi tabelist võtta ka maakondade nimesid, mis on polügoonide vektorkihil juba olemas. Custom Field Name Prefix ette teeme linnukese ja kustutame sealses lahtris oleva teksti, et lisatavatele tulpadele (antud juhul tulbale kirikuid) ei kirjutataks ühendatud andmestikus ette ka liidetava kihi nime: tahame, et uues andmestikus oleks lihtsalt tulp kirikuid, mitte kirikud_maakonniti_kirikuid. OK → OK Vaatame uuesti maakondade vektorkihi atribuuttabelit (kiirklahv F6), et näha, kas igale maakonnale said lisatud kirikute arvud. Joonis 6.7: Kirikute tabel ühendatud maakondade kihiga Mis juhtub, kui ühendad kaks andmestikku teistpidi: kirikute arvu tabelile liidad maakondade polügoonide kihi? Värvime maakonnad vastavalt kirikute arvule. Maakondade kihil teeme topeltkliki või paremkliki ja valime Properties. Liigume jaotisesse Symbology. Simple line asemel vali uuesti Symbol layer type juurest Simple fill Jaotise ülaservast valime Single Symbol asemel Graduated selleks, et värvida valitud kihi elemendid vastavalt mingile arvulisele, pidevale tunnusele (siin on selleks kirikute arv): Value juures valime tunnuse kirikuid. See määrab, millise tulba väärtuste põhjal maakonnad värvitakse. Color ramp juures valime rippmenüüst värviskaala, millel on ühtlane 2–3 tooni üleminek. Näiteks helekollasest tumeroheliseks (vt All Color Ramps -&gt; YlGn). Klikime Classify. Proovime ka erinevate jaotumistega (nt Equal interval ja Pretty breaks) ja klasside hulgaga (Classes). Näiteks Pretty breaks ja kolm klassi annab ilusa tulemuse. Jälgime, et enamik maakondi ei oleks ühte värvi. Räägime klassifitseerimismeetoditest edaspidi ka lähemalt. Vajutame OK. Nüüd on kõik maakonnad värvitud valitud värviskaalaga vastavalt sellele, kui palju on neis kirikuid. Kas see kaart on informatiivne? Mida peaks lisama või ära võtma? Joonis 6.8: Harjutus 2 tulemus 6.6 Aluskaardid Nagu varasemates loengutes nägime, on olemas rohkelt aluskaarte, mida erinevates rakendustes põhiliselt teemakaartide tegemisel kasutatakse. QGISis saab neid kasutada läbi pistikprogrammide ehk Plugins või WMS- ja WFS-teenuste (vastavalt web map service ja web feature service). WMS-teenuse kaudu saab kasutada peaaegu kõiki Maa-ameti XGISis olevaid kihte. Täpsemalt saab sellest lugeda WMS teenuste lehel. Lisaks saab kasutada paljusid muid andmeid kogu maailmast. WMS-teenuse kaarte saab kasutada sisuliselt ainult visualiseerimiseks. Päringuid, valikuid vmt nende põhjal teha ei saa. Lisame WMS-teenusest aluskaardi: Layer → Add Layer → Add WMS/WMTS layer. Lisame ühenduse (New). Avanenud aknas määrame nimeks (Name) näiteks Maa-ameti aluskaart ning URLi juurde kopeerime aadressi https://kaart.maaamet.ee/wms/alus?. Vajutame OK. Nüüd on paika pandud, millise Maa-ameti kaardiserveriga QGIS ühenduse loob. Klikime ühenduse loomiseks nupul Connect. Valime serverist laetud kihtide hulgast näiteks 138 MAANTEED ning klikime nupul Add. Lisame veel ühe ühenduse (New). Seal kirjutame nime (Name) lahtrisse Maa-ameti orto ja reljeef ning URLi juurde kopeerime aadressi https://kaart.maaamet.ee/wms/fotokaart?. Vajutame OK. Klikime uue ühenduse loomiseks nupul Connect. Valime serverist kihi 21 vreljeef ning klikime nupul Add. Sulgeme akna. Nüüd on peaaknas näha maanteed koos reljeefiga. Kui lisatud WMS-kihid ei paista välja, siis tuleb muuta kihtide järjekorda või rohkem sisse või välja suumida. Proovime lisada ka täiendavaid kihte. Quickmap ja OSM Lisame veebikaartide pistikprogrammi. Üleval servas valime Plugins → Manage and Install Plugins. Otsingusse kirjutame Quickmap. Valime QuickMapSercives ja installime selle. Sulgeme akna. Järgmiseks valime ülaservas Web → QuickMapServices → OSM → OSM standard. Nüüd on aluskaardiks OpenStreetMap. Jällegi - kui aluskaardi kiht ei paista välja, muuda Layers paneelil kihtide järjekorda või lülita muid kihte välja. Proovime ka teisi kaarte, nt Google’i aluskaarti. Rohkemate võimaluste jaoks laadi lisakomplekt QMS kaarte: Web → QuickMapServices → Settings → More services → Get contributed pack → OK → Save. 6.7 Järgmisel korral Kaartide kujundamine ja eksportimine, andmete loomine ja digitaliseerimine QGISis. "],["qgis_2.html", "Praktikum 7 Sissejuhatus QGISi (2) 7.1 Andmete valimine 7.2 Vektorkihi geomeetria parandamine 7.3 Kihi ja andmete loomine 7.4 Kaartide kujundamine ja eksportimine 7.5 Järgmisel korral", " Praktikum 7 Sissejuhatus QGISi (2) Praktikumis tegeleme põhiliselt andmetest alamhulkade valimisega, andmete digiteerimise ja kaartide koostamisega. Selleks kasutame kolme andmestikku: kuni 1917. aastani kehtinud kihelkonnapiiride andmestikku, milles võib olla ebatäpsusi (vektorandmed, polügoonid), muinsuskaitseameti kultuurimälestiste registrist pärit andmestikku, kus on ajaloo, arheoloogia, arhitektuuri ja kunstiga seotud muinsuskaitse all olevad mälestised (vektorandmed, punktid), Vorbuse asula uurimisala piire (vektorandmed, polügoon). Laadime Moodle’ist praktikumi andmed alla ning avame kõik kihid QGISis. Pärast avamist vaatame ka andmete atribuuttabeleid, et näha millise info kaudu ruumiobjekte iseloomustatakse. Vorbuse uurimisala kasutame hilisema harjutuse käigus, mistõttu võib selle esialgu välja lülitada. 7.1 Andmete valimine Valiku tööriistad võimaldavad ruumiandmete kihil toimetada eraldi vaid mingi alamosaga koguandmestikust: näiteks teha päringuid või muuta atribuutide andmeid ainult teatud osal andmestikust. Samuti saame valiku tööriistade abil luua uusi alamandmestikke. Joonis 7.1: Valimise tööriistad menüüribal Objektide valimiseks teeme esmalt aktiivseks kihi, millelt valik teha. Valikut saab teha käsitsi või avaldiste abil. Valitud elemendid muutuvad vaikimisi kollaseks (värvi saab sätetes ka muuta). Tänases praktikumis vaatame põhiliselt käsitsi valimise võimalusi, avaldistest räägime lähemalt hilisemates praktikumides. Valiku tööriistad: Select Features by Area or Single Click Select Feature(s): vali elemendid nendel hiirega klikkides, mitme elemendi korraga valimiseks hoia all Ctrl-klahvi; Select Features by Polygon: joonista hiirega polügoon, mille sisse jäävad elemendid valitakse, valiku lõpetamiseks tee paremklikk; Select Features by Freehand: joonista vabakäega mis tahes kujund, mille sisse jäävad elemendid valitakse, valiku lõpetamiseks tee uuesti vasakklikk; Select Features by Radius: vali elemendid, mis jäävad teatud raadiuse kaugusele määratud keskpunktist, keskpunkti määramiseks tee kuskil vasakklikk, valiku lõpetamiseks tee uuesti vasakkklikk; Select Features by Value Select Features by Value: vali elemendid, mille atribuuttabeli mingite tunnuste väärtused vastavad mingitele määratud väärtustele; Select Features by Expression: vali elemendid, mis vastavad avaldisega määratud tingimusele; Select All Features: vali kõik kihi elemendid; Invert Feature Selection: tee valik vastupidiseks (kõik valitud ehk kollased elemendid muutuvad mittekollaseks ja kõik mittekollased muutuvad kollaseks ehk valituks); Deselect Features from All Layers Deselect Features from All Layers: tühista valikud kõikidelt kihtidelt; Deselect Features from the Current Active Layer: tühista valikud ainult aktiivselt kihilt; Select by Location: vali elemendid, mis vastavad mingile geomeetrilise suhte määratlusele (nt vali kõik polügoonid, mis osaliselt kattuvad mingi teise polügooniga). NB! Ei tööta, kui kiht on vigane! Kõik valiku töööriistad leiad ka ülamenüüst: Edit → Select. Katsetame! Valime kaardil näiteks kõik Saaremaa kihelkonnad, joonistades Saaremaa ümber polügooni. Seejärel salvestame valitud kihelkonnad eraldi kihina, tehes kihil paremkliki ja valides Export → Save Selected Features As. Formaadiks võime valida geopackage. Anname kihile nime saaremaa_kihelkonnad. Avame salvestatud kihi QGISis ja vaatame, kas sinna said ikka ainult Saaremaa kihelkonnad. Joonis 7.2: Valimine polügooni joonistamise abil Järgmiseks valime ainult need kultuurimälestised, mis jäävad Saaremaale. Üks võimalus on teha mälestiste kiht aktiivseks ning joonistada jällegi Saaremaa ümber polügoon. Teine võimalus on kasutada tööriista Select by Location ning küsida ainult neid punkte, mis jäävad loodud Saaremaa kihelkondade kihi piiridesse. NB! Alloleval gifil näidatud lahendus ei pruugi kohe töötada, kui kasutad 7. praktikumi materjalides kaasas olnud kihelkondade faili, ent töötab pärast seda, kui oleme allpool kihi geomeetria ära parandanud. Geomeetriliste suhete selgitusi saab lugeda näiteks siit. Joonis 7.3: Valimine geomeetriliste suhete abil Lõpuks valime kaardil Liivimaa kubermangu kihelkonnad, valides andmestiku atribuuttabelist ainult need read, milles tulbas kubermang on väärtus Liivimaa. Valime samamoodi kõik Liivimaa kultuurimälestised ja salvestame need eraldi kihina. Selleks, et vigaste polügoonidega hakkama saada, võib valida Settings → Options → Processing → General → Invalid features filtering ning muuta selle väärtus kas väärtuseks Do not filter (polügoonide terviklikkust ei kontrollita) või Skip (vigased polügoonid jäetakse välja). Joonis 7.4: Valimine atribuutide ja geomeetriliste suhete abil 7.2 Vektorkihi geomeetria parandamine Nägime, et vektorkihid võivad vahel olla geomeetriliselt vigased. Näiteks ristub polügooni piir iseendaga ja tekitab polügooni sisse “auke”. Mõnikord võib juhtuda ka, et jooned ei lõppe õiges kohas ära või hoopis ei jõua õigesse kohta välja (näiteks ristmike puhul). Vektorkihi valiidsuse kontrollimise tööriista leiab, kui valida ülamenüüst Vector → Geometry Tools → Check Validity. Tööriista sisendiks on vektorkiht, mille geomeetriat kontrollida, ning väljundiks vaikimisi kolm kihti: valiidsed elemendid, vigased elemendid ja viga tekitavad kohad. Joonis 7.5: Vektorkihi valiidsuse kontrollimine Üks võimalus on kihid käsitsi ära parandada. Selleks tuleks teha algne vigane polügoonide kiht aktiivseks, vajutada üleval kollasel pliiatsil (Toggle Editing) ning valida kõrvalt tööriist Vertex Tool. Selle abil saab joonte ja polügoonide käänupunkte nihutada, kustutada ja uusi juurde lisada. Selle protsessi käigus võib aga juhtuda, et tekitame tahtmatult ise vigu juurde. Seetõttu on enamasti ohutum kasutada geomeetria parandamise tööriista Processing → Toolbox → Vector geometry → Fix geometries. Joonis 7.6: Vektorkihi geomeetria parandamine Ehkki see aitab palju tehniliselt, lubades kasutada erinevaid tööriistu, ei pruugi see lahendada alati päris probleemi, kui näiteks polügoonide piirid peaksid olema joonistatud samade koordinaatide põhjal, aga tegelikult polügoonide mingid osad kattuvad ja jäävad üksteise alla. Joonis 7.7: Vektorkihi geomeetria parandamine (2) 7.3 Kihi ja andmete loomine Harjutuse käigus tuleb märkida vanalt topograafiliselt kaardilt uurimispiirkonna piires Tartust u 7 km kirdes asuva Vorbuse asula läheduses oleva Metsaküla küla suuremad teed ja talud, mida tänapäeval enam pole. Piirkonnas toimusid 1960.–70. aastate maaparandusega (uute põldude rajamisega) seoses mitmed ümberkorraldused. Niisiis saab proovida, kuidas käib ise punkt- ja joonkihtide loomine. Lisame WMS-teenusest ajaloolise topokaardi ja tänapäevase põhikaardi: Lülitame sisse Vorbuse uurimisala kihi ja liigume selle juurde (Zoom to layer). Muudame värviga täidetud polügooni ainult piirjoonteks (Symbology → Simple Fill asemel Simple Line). Lisame WMS kaardi Layer → Add layer → Add WMS/WMTS layer. Avanenud aknas klikime New. Seal määrame Name väärtuseks Maa-ameti ajaloolised kaardid, URLi juurde kopeerime aadressi https://kaart.maaamet.ee/wms/ajalooline? ja vajutame OK. Klikime Connect ja valime Ajalooline alt 45 ew_25T Eesti topograafiline kaart 1:25000 (1923–1935) ning seejärel Add → Close. Võime samamoodi lisada ka 19. saj lõpust pärineva üheverstase kaardi, valides 35 yheverstakaart. Lisame eelmise punktiga sarnaselt WMS-teenusest tänapäevase aluskaardi: Loome uue ühenduse või kasutame eelmises praktikumis seadistatud ühendust Maa-ameti aluskaart. Loomisel kasutame URLi http://kaart.maaamet.ee/wms/alus?. Valime rippmenüüst Maa-ameti aluskaart, klikime Connect ja valime Põhikaardid alt 2 pohi_vr2 värvilise rasteriseeritud Eesti põhikaardi mõõtkavas 1:10 000. Vaatame põgusalt, kuidas on märgitud talud ja teed ajaloolisel topokaardil ja tänapäevasel põhikaardil. Muudame kihtide WMS-teenuse kaudu lisatud kihtide läbipaistvust, et näha, milliseid talusid tänapäeval enam ei ole. Ajalooliste kaartide kohta leiab rohkem infot ja leppemärgide seletused Maa-ameti ajalooliste kaartide lehelt. Joonis 7.8: Talud ja teed ajaloolisel ja tänapäevasel kaardil Loome uued tühjad kihid talude ja teede märkimiseks Ülevalt menüüst valime uue kihi tegemiseks Layer → Create Layer → New Geopackage Layer. Sirvimise ikoonile klikkides liigume kursuse andmete kausta. Paneme faili nimeks vorbuse_talud, valime vektorkihi tüübiks punktikihi (Geometry type → Point), koordinaatsüsteemiks EPSG: 3301 - Estonian Coordinate System of 1997. Lisame kihile ka uue atribuutide välja: New field all Name järele kirjutame nimi ja klikime Add to Fields List → OK. Joonis 7.9: Uue kihi loomine Nüüd on talude märkimiseks loodud tühi kiht, mis ilmus ka kihtide paneelile. Seda kihti paneelil sisse-välja lülitades ei juhtu hetkel midagi, kuna sellel pole veel ühtegi punkti. Kihi atribuuttabelit vaadates on näha, et see on tühi. Loome sarnaselt talude kihile ka teede vektorkihi. NB! Valime õige vektorkihi tüübi (punktid, jooned või polügoonid)! Märgime ajalooliselt kaardilt talud ja teed, mida tänapäeval enam pole. Talud on kaardil tähistatud kandilise viirutatud alaga, millel asuv must punkt tähistab hoonet. Klikime kihtide paneelil kihil vorbuse_talud ja vajutame üleval tööriistaribal kollasele pliiatsile (või Layer → Toggle editing). Pliiatsi kõrval olevad ikoonid muutuvad värviliseks. Vali kolme punktiga ikoon Add Point Feature. Nüüd saad kaardile punkte märkida. Klikime ajaloolisel topograafilisel kaardil talu peal. Avanenud aknas laseme id automaatselt määrata, aga kirjuta nime juurde võimalusel märgitud talu nime. Kui kõik talud on märgitud, siis salvestame muudatused. Selleks vajutame tööriistaribal kollase pliiatsi kõrval disketina kujutatud salvestamise ikoonile (Save Layer Edits). Lülitame muutmise/toimetamise välja, vajutades uuesti kollasel pliiatsil. Nüüd peaksid näha olema kõikide talude peal värvilised punktid. Muudame punktide kuju, värvi ja suurust, et need paremini välja paistaksid, ning lisame nimesildid. Selleks, et sildid paremini välja paistaksid, võib Labels menüüs Background alt teha linnukese Draw background ees ja Placement juures valida Mode väärtuseks Offset from Point, paigutuseks tekst sümboli kohal ning tekst sümbolist -3 millimeetri võrra “allpool” (ehk 3 mm võrra üleval). Selle tulemusena on siltide tekst taust valge ja sildid asuvad punktist piisavalt kaugel. Joonis 7.10: Digiteeritud talud Märgime kihil vorbuse_teed uurimispiirkonna piires need teed, mida tänapäevasel kaardil enam pole. Ärme märgime väga väikseid teid ega teid, mille asukoht või kurvilisus on ainult pisut muutunud. Teede märkimine käib sisuliselt samamoodi nagu punktide märkimine. Kolme punktiga ikooni asemel on tööriistaribal samas kohas aga lihtsalt nurgelise joonega ikoon. Märgime tee punktide abil joonena. Joone lõpetamiseks teeme paremkliki ja anname sellele järjekorranumbri. Joone paksust saab muuta samal viisil nagu punktil. Selleks, et teed lõikuksid samas sõlmpunktis, lülitame sisse snap’imise: teeme tööriistaribal paremkliki, teeme linnukese Snapping Toolbar ette ja klikime hobuseraua/magneti ikoonil. Kui tahame ükshaaval käänpunktide märkimist lihtsustada ja “joonistada” lihtsalt vabakäejoont, võime valida pliiatsi kõrvalt tööriista Stream Digitizing. Joonis 7.11: Teede digiteerimine vabakäe meetodil Kui oleme talud ja teed märkinud, siis lülitame ajaloolise aluskaardi või mõlemad aluskaardid välja. Joonis 7.12: Digiteeritud teed 7.4 Kaartide kujundamine ja eksportimine Kui kaardiaknas on loodud sobiv lahendus ehk kõik talud ja teed on märgitud, siis ekspordime selle kaardina. Korraliku kaardi tegemiseks: valime ülevalt menüüst Project → New Print Layout. Anname sellele sobiva nime. Avanenud Print Layout aknas valime ülevalt Add Item → Add Map. Joonistame akna valgele lehele nelinurga, hoides all hiire vasakpoolset klahvi. QGIS-i peaaknas olev kaart kuvatakse sinna. Teeme nelinurga sama suureks kui valge taust. Alternatiivina võib parema väljanägemise huvides jätta kaardi ja tausta serva vahele u 1 cm vahe. Seejuures on abiks taustaruudustik ja selle külge haakimine (snapping). Nende sisselülitamiseks valime Print Layout akna üleval menüüst View → Show Grid ja View → Snap to grid. Nüüd saame kaarti taustaruudustiku külge haakida. Sätime kaarti nii, et kõik vajalik oleks näha. Selleks valime Edit → Move Content või vajutame klaviatuuril C. Liigutame kaarti hiire vasakpoolset klahvi all hoides. Paremal servas Item properties alt saab valida kaardi mõõtkava (Scale), et kaarti suuremaks või väiksemaks teha. Lisame kaardile joonmõõtkava. Add item → Add Scale Bar ja klikime kaardil. Paremal Item properties → Segments saab muuta muuta mõõtkava pikkust ja stiili. Lisame paremale poole nii palju ühikuid, kui soovime. Fixed width muudab mõõtkava ühe ühiku pikkust. Style rippmenüüst saad valida endale meelepärase stiili. Lisame kaardile põhjasuunda tähistava noole. Add item → Add North Arrow ning klikime kaardil. Paigutame noole kasti kaardi ühte ülemisse nurka. Paremal Item properties all saab valida soovi korral mõne muu noole. Lisame kaardile enda nime ja viite Maa-ametile. Add Item → Add Label ning klikime kaardil. Paigutame tekkinud kasti kaardi ühte nurka. Paremal Item properties all kirjuta enda nimi ning viide Maa-ameti andmetele. Nt Aluskaart: Maa-amet 2023. Ekspordime kaardi kursuse kausta. Üleval servas valime vasakul Layout → Export as Image. Anname sellele mõistliku nime. Avanenud aknas vajutame Save. Avame kaardi kursuse kaustas ning vaatame, kas kõik jäi õigesti. Joonis 7.13: Valmis kaart 7.5 Järgmisel korral Järgmisel korral tuleb juttu avaandmetest, nendega seotud põhimõtetest ja andmete kättesaadavusest. "],["avaandmed.html", "Praktikum 8 Avaandmed ja repositooriumid 8.1 Mis on avaandmed? 8.2 Eesti ruumiandmed 8.3 Muude riikide ruumiandmed 8.4 Järgmisel korral", " Praktikum 8 Avaandmed ja repositooriumid 8.1 Mis on avaandmed? Avaandmed (Open Data) on vabalt ja avalikult kättesaadavad andmed. Avaandmeid võib ilma piiranguteta alla laadida, kasutada ja levitada, juhul kui autorile viidatakse ning andmeid kasutatakse vastavalt litsentsitingimustele. Avaandmete mõiste on selgelt defineerituna kasutusel olnud kümmekond aastat ning on eriti viimastel aastatel tihedalt seotud survega avalikule sektorile teha oma andmed või osa nendest juurdepääsupiiranguta kättesaadavaks. Joonis 8.1: Avaandmete liike (Open Knowledge Foundation) Eesti avaliku sektori avaandmed on tehtud kättesaadavaks Eesti Avaandmete Portaalis. Avaandmetele lähedane mõiste, mis on eeskätt kasutuses teadusandmete kontekstis, on FAIR-andmed ehk andmed, mis on leitavad (findable), kättesaadavad (accessible), ristkasutatavad (interoperable) ja taaskasutatavad (reusable). FAIR-andmed ei ole tingimata kättesaadavad kõikidele ja mis tahes tingimustel, ent järgivad andmete kvaliteedi tagamise põhimõtteid, on paremini dokumenteeritud ning hõlpsamini taaskasutatavad. Joonis 8.2: FAIR põhimõtted Andmete leitavusele aitab näiteks kaasa see, kui andmed on masinloetaval kujul, nad on kirjeldatud metainfo kaudu, varustatud märksõnadega ja neil on püsiidentifikaator DOI (Digital Object Identifier). Kui andmeid (või osa nendest) hoitakse mingis avalikus repositooriumis ehk elektroonilises andmehoidlas, kust neid on võimalik alla laadida, on need hästi kättesaadavad. Kui andmete vorming vastab mingitele kokkulepitud standarditele või andmeid hoitakse lihtsalt laialt kasutusel olevas, platvormist sõltumatus vormingus (nt CSV, XML), on need ka hõlpsasti ristkasutatavad. Kui andmete kogumise ja töötlemise protsess on põhjalikult dokumenteeritud ning andmed on varustatud litsentsiga, on need ka taaskasutatavad. Suuremad rahvusvahelised teadusandmete repositooriumid on näiteks Zenodo, Harvard Dataverse (vaata ka teisi Dataverse’i projekte), OSF ja Figshare. Repositooriume võib omakorda otsida erinevatest registritest, nagu Re3data.org või OpenAIRE. Tartu Ülikool pakub TÜ Raamatukogu kaudu võimalust säilitada oma teadusandmeid DataDOI repositooriumis. Seal saavad andmed endale digitaalobjekti identifikaatori ehk DOI ning need registreeritakse koos metaandmetega rahvusvahelises DataCite registris. DataCite Eesti koondab ka teisi Eesti teadusega seotud repositooriume, nt Eesti geokogude portaal. Raamatukogul on ka ülevaade enimlevinud avatud juurdepääsuga andmebaasidest ja teaduse avaandmete repositooriumidest ja registritest. Vaata lähemalt ka https://sisu.ut.ee/teadusandmed/. Kui tahta oma andmeid avalikustada, tuleks nendele lisada litsents, mis määrab ära intellektuaalse omandi kasutusõiguse. Tüüpilised avaandmete litsentsid on: Litsents Valdkond Tuleb viidata Tohib levitada ainult sarnase litsentsiga CC0 Sisu, andmed Ei Ei PDDL Andmed Ei Ei CC-BY Sisu, andmed Jah Ei ODC-BY Andmed Jah Ei CC-BY-SA Sisu, andmed Jah Jah ODbL Andmed Jah Jah 8.2 Eesti ruumiandmed 8.2.1 Maa-ameti Geoportaal Eesti ruumiandmete peamine haldaja ja levitaja on Maa-amet. Alates 2018. a suvest on sisuliselt kõik Maa-ameti andmed avalikud ning ka allalaetavad lehelt https://geoportaal.maaamet.ee/. Nende kasutamist käsitleb Maa-ameti avatud ruumiandmete litsents. Peamised punktid: Õigus kasutada andmeid tasuta, kasutaja valitud kõlbelisel eesmärgil, kooskõlas seaduste ja heade tavadega. Andmete publitseerimisel ja levitamisel peab viitama nende päritolule. Maa-amet ei vastuta otsese ega kaudse kahju eest, mis võib tekkida andmete kasutamisest tulenevalt. Maa-ameti kaudu on vabalt kasutatavad ka ajalooliste haldusjaotuste andmed, sh mõisate, kihelkondade, valdade, rajoonide kohta. Andmete kasutamisel tutvu kindlasti ka viitamistingimustega. 8.2.1.1 Harjutus 1 Kus asuvad Tartus suuremate kortermajadega piirkonnad? Vaatame faili tartuaadressid.csv (Moodle’is), mis on alamosa Maa-ameti jõusolevate aadressiobjektide andmestikust (seisuga 18.10.2023). Kuna Tartu aadresside algfail on üpris suur, siis meie kasutatav fail sisaldab ainult elukondlike hoonete ja eluruumide aadresse, millel on olemas ka koordinaadid. Laadime andmestiku QGISi ning vaatame, kas meil õnnestub aadressipunkti suurust ja läbipaistvust muutes tuvastada näiteks suurte kortermajadega piirkonnad Tartu linnas. Valime aluskaardiks kaardi Maa-ameti WMS-aadressilt https://kaart.maaamet.ee/wms/kaart?: Layer → Add Layer → Add WMS/WMTS Layer → New (lisa nimi ja aadress) → OK → Connect → valime kogu komplekti (0 - haldus- ja asustusjaotus, baaskaardi maakatte kihid, ETAK) → Add → Close. Lisame aadressiandmed: Layer → Add Layer → Add Delimited Text Layer → Add → Close. Jälgime, et kodeering (Encoding) oleks “UTF-8”. File Format: väljade eraldaja (delimiter) on tabulaator (Custom delimiters → Tab). Record and Fields Options: teeme linnukesed kastidesse First record has field names ja Detect field types. Geometry Definition: valime punktide koordinaatideks (Point coordinates) vastavalt tulbad VIITEPUNKT_X ja VIITEPUNKT_Y ning määrame koordinaatide referentssüsteemiks EPSG:3301. Kui all Sample Data eelvaates tunudub, et kõik on hästi ja tabel näeb välja selline nagu peab, siis vajutame nupul Add. Teeme aluskaardi mustvalgeks ja heledamaks: paremklikk aluskaardi kihil → Properties → Symbology → Layer Rendering → Grayscale (= By average), Brightness (= 10) → OK. Määrame aadressiobjektide punktide suuruseks 1 mm, eemaldame neilt välimise ringjoone (Stroke) ning määrame nende väljapaistvusprotsendiks (Opacity) 5%: paremklikk aadressiobjektide kihil → Properties → Symbology → Simple marker → Size (= 1) ja Stroke style (= No Pen); Marker → Opacity (= 5%). Suumime kaardilt välja nii, et mõõtkava oleks vähemalt 1 : 50 000. Jätame alles ainult eluruumide (ehk korterite) info: paremklikk aadressiobjektide kihil → Filter → Provide Specific Filter Expression → “ADOB_LIIK” = ‘ER’ → OK. Joonis 8.3: Suuremad kortermajad Tartus 8.2.1.2 Harjutus 2 Salvesta loodud kaart pildifailina. Lisa juurde mõõtkava, kaardi pealkiri ning viide kasutatud andmetele. 8.2.2 Statistikaamet Statistikaamet pakub avalikke andmeid sageli seotult mingite haldusüksuste andmetega (nt maakonnapõhiselt). Varasemalt pakkus statistikaamet ka kaardirakendust, mis võimaldas teha nende andmebaasi põhjal teemakaarte ja ka vastavaid andmeid ruumiandmetena alla laadida. 2023. aasta suvel aga rakendus suleti, kuna selle aluseks olev tehnoloogia oli vananenud. Joonis 8.4: Murdekõnelejad statistikaameti kaardirakenduse teemakaardil (2022) 8.2.2.1 Harjutus 3 Uurime, kuidas on maakondades 2021. aasta rahvaloenduse põhjal rahvaarv 2011. aasta andmetega võrreldes protsentuaalselt kõige rohkem muutunud. Selleks laadi QGISi Maa-ameti maakonnapiiride vektorkiht ja Moodle’is olev CSV-andmestik Statistikaameti andmetega (NB! Statistikaameti andmetes ei ole koordinaate -&gt; No geometry); lisa Statistikaameti andmestikku uus tulp nimega Muutus, kus kajastad 2021. aasta ja 2011. aasta vahet (kui rahvaarv kasvas, siis on väärtus positiivne, kui kahanes, siis negatiivne). Uue tulba lisamiseks ava CSV-kihi atribuuttabel (kiirklahv F6 või paremklikk -&gt; Open Attribute Table) ning võta lahti tööriist Field Calculator ; Joonis 8.5: Tunnuste lisamine Statistikaameti tabelisse lisa samal moel andmestikku teine tulp nimega MuutusProp, kus kajastad muutust protsentuaalselt ehk jagad tulba (Field) Muutus väärtused läbi 2011. aasta rahvaarvuga (Field 2011 Vanuserühmad kokku) ja korrutad saadud tulemuse 100-ga; Joonis 8.6: Tunnuste lisamine Statistikaameti tabelisse (2) ühenda maakondade vektorkihiga Statistikaameti rahvaloenduse andmed (ühine tulp on mõlemas andmestikus see, kus on maakondade nimed, vt ka 6. praktikumi materjale); värvi maakonnad vastavalt protsentuaalse muutuse suunale ja suurusele. Üks klass võiks võimalusel väljendada kuni 0-5 protsendipunkti muutust (pretty breaks). Vali selline värviskaala (nt PRGn või RdBu), mis väljendaks skaala kumbagi äärmist otsa (suuri kasvuprotsente ja suuri kahanemisprotsente) eri värvidega; salvesta kaart pildifailina. Lisa kaardile ka pealkiri, legend ja viide kasutatud andmetele. 8.2.3 Digitaalsed kaardikollektsioonid Eesti digiteeritud kaartide kollektsioon on Rahvusarhiivi kaartide infosüsteem http://www.ra.ee/kaardid/, mis sisaldab Rahvusarhiivis ja Tallinna Linnaarhiivis hoitavate kaartide kirjeldusi ja digikujutisi. Infosüsteem võimaldab kaarte otsida ka kaardil piirkonda märkides (ehkki selleks tuleb end virtuaalse uurimissaali VAU kaudu tuvastada), kui kaardil klikkida ning tekkinud ruudukesest venitada sobiva suurusega kast ümber huvipakkuva ala. 8.2.3.1 Harjutus 4 Otsime kaartide infosüsteemist vanima kaardi, kus on kujutatud meie kodukoht. Soovitatav on otsida maal asuva kodu, vanavanemate kodu, suvila või mõne muu maal asuva huvipakkuva koha kaarti, kuna linnad on väga palju muutunud ning sealt võib olla raske konkreetset kohta leida. Otsingut võib lihtsustada see, kui teate, millise mõisa alla otsitav koht kuulus. Selleks võib vaadata kaardirakenduses Ajaloolised kaardid ajaloolist haldusjaotust (tehke vasakul paneelis linnuke vastava kihi ette). Mõisa nime saab RA kaartide infosüsteemis sisestada täpsemas otsingus väljale Koht -&gt; Vali hierarhiast. Kuna 19. saj lõpust pärinev üheverstane kaart on georefereeritult samuti rakendusest näha, siis võib koha lokaliseerimisel sellest abi olla. Joonis 8.7: Kärdla kaart aastast 1830. EAA.46.2.366 leht 9 8.2.4 Muu Eesti geoportaal koondab avalik-õiguslike asutuste ruumiandmeid ja nendega seotud metainfot. On seotud EL-i INSPIRE portaaliga. Viited on koondatud kategooriate kaupa ruumiandmete kataloogi. Ruumiandmeid leiab mingil määral Eesti Avaandmete Portaalist, sh Maa-ameti ja Statistikaameti andmeid, aga ka näiteks kohalike omavalitsuste, registrite, ametite jt avaliku sektori institutsioonide andmeid. Tallinna ruumiandmed - Tallinna linna aluskaart, hooned, asumipiirid jpm. Tartu linna ruumiandmed. Digiteeritud kaarte leiab ka Digarist. Nii Eesti kui ka välisriikide praeguseid ja endiseid nimekujusid leiab nii Eesti Keele Instituudi Kohanimeraamatust kui ka Kohanimeandmebaasist. Mõlema puhul on võimalik näiteks teadustöö eesmärgil saada enda kasutusse ka lähteandmeid (või osa nendest). Ametlikku kohanimeregistrit, mis esitab kohanimede ametliku, standardse nimekuju, haldab Maa-amet. Arheoloogilise ja pärimusliku kohainfo andmebaas: ei ole avatud juurdepääsuga. Riina Juuriku poole pöördudes saab juurdepääsu aga küsida. TARA (Tartu Ülikooli arheoloogia infosüsteem): leidude, luude, proovide, arhiivi, fotode jms kogud. Andrus Saareste “Eesti murdeatlase” (1938/1941) ja “Väikese eesti murdeatlase” (1955) andmed, käsikirjalisi murdekaarte saab vaadata siin. 8.3 Muude riikide ruumiandmed Juurdepääsupiiranguta ruumiandmeid leiab internetist otsides hulganisti. Täpsed ruumiandmed on leitavad sageli huvipakkuva riigi enda avaandmete portaalidest. Siin on toodud vaid mõned üksikud näited üldisematest andmebaasidest ja repositooriumidest: INSPIRE geoportaal koondab Euroopa Liidu liikmesriikide ja EFTA riikide ruumiandmeid (sh Eesti andmeid). Natural Earth Data: vektorkujul rannajooned, maa, ookeanid, saared, jõed, järved jm. Olemas ka rasterandmeid aluskaartide jaoks. Open Maps for Europe. DIVA-GIS: nii ülemaailmsed kui ka üksikute riikide ruumiandmed. Robin Wilsoni põhjalik nimekiri vabalt kasutatavatest ruumiandmetest. Ajalooliste kaartide kollektsioon. David Rumsey kaardikollektsioon: üle 100 000 kõrge kvaliteediga digiteeritud kaardi 16.-21. sajandist, osa ka georefereeritud. Georefereeritud kaardid Map Warperis. Arheoloogia andmete suurimaks koondajaks on Ariadne Plus, mis koondab üle 2 miljoni andmestiku kogu Euroopast. Projekti eesmärk on luua pilvepõhine virtuaalne teadustöö tegemise keskkond. ADS (Archaeology Data Sercive): juhtiv repositoorium arheoloogia ja laiemalt kogu pärandi andmete pikaajaliseks säilitamiseks ja jagamiseks. tDAR (The Digital Archaeology Record): rahvusvaheline arheoloogiliste uuringute andmete repositoorium. DANS (Data Archiving and Networked Services): Madalmaade digiandmete repositoorium. Pleiades - ajalooliste kohtade, riikide ja nimede ruumiandmed. Geographical database of the Uralic Languages - Uurali keelte (sh murrete) polügoonid ja punktandmed. Eri riikide tuntud inimeste kohta Vikipeediast kogutud andmebaas, mis on aluseks sellele rakendusele. Geoinfoga varustatud andmeid leiab ka mitmesugustelt üldistelt lehekülgedelt ja platvormidelt, nt Twitterist/X-ist või Flickrist, mis võimaldavad andmeid koguda oma API (Application Programming Interface) abil. Joonis 8.8: Näide Flickrist kogutud andmete visualiseerimisest (Postimees, 25. september 2021) 8.4 Järgmisel korral Esmaspäeval tegeleme georefereerimisega ehk seome digiteeritud kaarte geograafiliste koordinaatidega. "],["georefereerimine.html", "Praktikum 9 Georefereerimine 9.1 Kaartide otsimine ja allalaadimine 9.2 Harjutus 1: vana Tartu kaardi georefereerimine 9.3 Harjutus 2: ajalooline maakasutus Jägala mõisa külades 9.4 Harjutus 3: käsikirjalise kaardi georefereerimine 9.5 Veebilahendus 9.6 Järgmisel korral", " Praktikum 9 Georefereerimine Georefereerimine on kaartide või ka aerofotode sidumine geograafilise koordinaatsüsteemiga. Tänapäeval tehakse seda peamiselt digitaalselt. Projektsioonidest ja koordinaatsüsteemidest oli lähemalt juttu 4. praktikumis. Georefereerimiseks tuleb märkida samad kohad võimalikult täpselt georefereeritaval kaardil või fotol ja (tänapäevasel) kindlas koordinaatide referentssüsteemis oleval aluskaardil. Georefereerimise tulemusel luuakse rasterkujutisest uus GeoTIFF fail või lisatakse olemasolevale failile nn world file, milles on defineeritud rastri asukoht, mõõtkava ja pöördenurk. GeoTIFF-faili nägime ka 6. praktikumis, kui laadisime QGISi Tartu 1995. ja 2020. aasta ortofotod. Tänases praktikumis otsime välja ajaloolised kaardid, mida soovime GISis kasutada, georefeerime need, lõikame vajalikku suurusesse ning digiteerime neilt huvipakkuvad objektid. 9.1 Kaartide otsimine ja allalaadimine Otsime Rahvusarhiivi kaartide infosüsteemist ra.ee/kaardid kaardi 19. saj Tartust ning 17. saj kaardi Jõelähtme ja Jägala-Joa piirkonnast. Näidetes kasutame järgmisi kaarte: Plan der Stadt Dorpat mit Bezeichnung der hervorragenden Gebäude und Sämmtlicher Hausnummern, EAA.402.5.637 (leht 73), 1870. Tartu linna kaart koos silmapaistvate hoonete ja majanumbritega. Joonis 9.1: Tartu kaart 1870. a Jackowal Hofs Byar uti Jegelecht Sochn belägne, EAA.1.2.C-III-8, 1688. Jägala mõisa külad Jõelähtme kihelkonnas. Joonis 9.2: Jägala mõisa kaart 1688. a Võib kasutada samu või muid sarnaseid kaarte nendest piirkondadest. Laadime kaardid alla ning tõstame need enda arvutis kursuse kaustas andmete või kaartide kausta. 9.2 Harjutus 1: vana Tartu kaardi georefereerimine Avame QGISi. QGISis on georefereerimise tööriist Georeferencer leitav ülevalt menüüst Layer alt. Vanemates QGISi versioonides leiad tööriista Raster menüü alt. Juhul, kui seal valikut Georeferencer ei ole, siis tuleb see aktiveerida. Selleks vali Plugins → Manage and Install Plugins → otsingusse kirjuta Georeferencer → tee linnuke Georefencer GDAL Plugin ette ja sulge see aken. Nüüd on tööriist Georeferencer rastrimenüü all näha. Tööriista sisselülitamine on ühekordne tegevus, järgmisel korral QGISi avades on see juba olemas. Georefereerimise tööriista kohta saab täpsemalt lugeda QGIS 3.28 juhendist. Avame kaardi pildifaili Avame Georeferencer-tööriista ning selles 19. saj Tartu kaardi. File → Open Raster. Selles aknas liikumine käib samamoodi nagu tavalises kaardiaknas. Saab suumida hiire rullikuga või Ctrl-nuppu all hoides ning liikuda nooltega ja hiirega, kui valitud on käekujuline Pan ikoon. Vaatame kaardil ringi. Milliseid kohti ära tunneme? Lisame aluskaardi Georefereerimiseks on vaja aluskaarti, mille pealt leida ühised punktid ajaloolise kaardiga. Selleks avame Maa-ameti WMS-teenusest Hübriidkaardi, värvilise rasteriseeritud Eesti Põhikaardi ja ortofoto. Hübriidkaardi kasutamiseks tuleb luua ühendus näiteks aadressiga https://kaart.maaamet.ee/wms/ajalooline?. Põhikaardi kasutamiseks tuleb luua ühendus aadressiga https://kaart.maaamet.ee/wms/alus?. Ortofoto kasutamiseks tuleb luua ühendus aadressiga https://kaart.maaamet.ee/wms/fotokaart?. Võimalik, et mõni neist ühendustest on juba varasemates praktikumides seadistatud. WMS-ühenduse loomisest on täpsemalt juttu näiteks 6. praktikumis. Lisaks võime ajalooliste kaartide WMS-teenusest võtta ka üheverstase kaardi, millega on hea georefereerimisel tänapäevast olukorda kõrvutada. Ka üheverstane kaart ise on georefereeritud ning võib olla seetõttu kohati ebatäpne. Georefereerime kaardi Märgime ära mõned ühesugused geograafilised punktid ajaloolisel kaardil ja tänapäevasel aluskaardil. Selleks võtame ette jälle Georeferencer akna. Georefereerija aknas valime Edit → Add point ja klikime ajaloolisel kaardil mõnel hästi tuvastataval objektil. Näiteks TÜ peahoone, raekoda, kaarsild, tähetorn, Jaani kirik vms. Seejärel valime From map canvas ning klikime tänapäevasel aluskaardil samas kohas. Joonis 9.3: Sama asukoha märkimine Märgime samamoodi veel neli kuni kümme punkti kaardil. Võimalusel asetame punktid kaardil võimalikult laiali, sest nii saab suurema ala kohta täpsema tulemuse. Seejärel tuleb valida georefereerimise sätted. Klikime georefereerija aknas kollasel hammasrattal ja vaatame, et sätted oleksid nii nagu siinsel pildil. Joonis 9.4: Georefereerimise sätted Vajutame rohelisel noolekesel Start Georeferencing. Nüüd ilmub georefereeritud kaart QGISi peaaknasse (juhul, kui sätetes oli tehtud linnuke valiku Load in QGIS when done ette). Vaatame, kui hästi tänapäevase koordinaatide referentssüsteemiga sidumine õnnestus. Kui kaart on väga paigast ära, siis saame lisada rohkem punkte või muuta transformatsiooni tüüpi. Vastavatest algoritmidest saab täpsemalt lugeda tööriista Georeferencer juhendist, ent lühidalt: Linear algoritm sobib põhiliselt siis, kui tegu on kõrge kvaliteediga rasterkaardiga, mille koordinaatide referentssüsteem on teada. See kohandab kaardi mõõtkava, ent ei võimalda kujutist pöörata ega muul moel muundada, kuna ei muuda originaalkujutise piksleid. Enamasti sobib see seega uuematele kaartidele, mis on (kindlas projektsioonis) suure täpsusega. Helmerti algoritm sobib hea kvaliteediga suuremõõtkavalistele rasterkaartidele või ortofotodele, mille koordinaatsüsteem ei pruugi ühtida aluskaardi omaga. Võimaldab kujutist ka pöörata. Polynomial 1. algoritm lubab georefereeritavat kujutist rohkem muundada, aga tagab siiski selle, et sirged jooned kaardil jääksid sirgeteks ja paralleelsed jooned paralleelseteks. Polynomial 2. ja 3. algoritm lubavad kujutist veelgi rohkem muundada, sh painutada kujutisel olevaid sirgeid jooni. Projective algoritm on nagu Polynomial 1. algoritm, aga ei säilita joonte paralleelsust ning eri punktidel võib georefereeritud kaardi ulatuses olla lõpuks pisut erinev mõõtkava. Thin Plate Spline algoritm sobib eriti hästi väga ebatäpsetele kaartidele või kaartidele, mille projektsioon ei ole teada. Sälitab märgitud punktide asukohad, ent võib moonutada kõike, mis jääb punktidest eemale. Nõuab heaks tulemuseks algoritmidest kõige enam punkte (vähemalt 10). Joonis 9.5: Põhilised georefereerimise algoritmid (gis.stackexchange.com) Kui georefereerimise algoritmid moonutavad algse kujutise piksleid, tuleb uues, georefereeritud rasterfailis määrata korrapärases rastris sellistele pikslitele mingid uued väärtused. Seda tehakse originaalkujutise naaberpikslite abil. Resampling method määrabki ära, kui palju ja milliseid naaberpiksleid uue väärtuse määramisel arvestada. Joonis 9.6: Georefereerimise Resampling meetodid (The Core of GIS Science 2020) Joonis 9.7: Georefereeritud Tartu kaart hübriidkaardi ja ortofoto taustal Võime soovi korral lisada nüüd juurde punkte, neid liigutada või mängida sätetega, et saada paremat tulemust. Proovime näiteks ka Helmerti algoritmi ja Polynomial 1 algoritmi. Lõikame georefereeritud kaardist välja ainult vanalinna osa. Selleks valime Raster → Extraction → Clip raster by extent. Vaatame, et Input layer oleks georefereeritud kaart, Clipping extent juures klikime sirvimise ikoonil, valime Draw on canvas ning joonistame peaaknas nelinurga, mis kataks suurema osa vanalinnast. Clipped (extent) juures klikime sirvimise ikoonil, valime Save to File ning salvestame faili sobiva nimega kursuse kausta. Klikime Run. Joonis 9.8: Georefereeritud Tartu vanalinna kaart Nüüd on lõigatud kaart peaaknas näha. Sellist lõikamist (ingl clipping) saab teha ka vektorkihi abil, aga sellest hiljem. 9.3 Harjutus 2: ajalooline maakasutus Jägala mõisa külades Harjutuse eesmärk on uurida ühe Põhja-Eesti küla ajaloolist maakasutust. Selleks tuleb georefereerida kaart, see osaliselt digiteerida ning arvutada digiteeritud alade pindalad. Kaardi georefereerimine Georefereerime Jägala mõisa külade 17. sajandi kaardi, kasutades samu aluskaarte, mida varem. Parema võrdlemise jaoks võime aluskaarti alumisel menüüribal oleva Rotation tööriistaga u 20 kraadi keerata. Kuna niivõrd vanal kaardil on hooneid, teid ja muid pidepunkte vähem, siis on soovitatav pidepunktidena kasutada looduslikke objekte. Sellel kaardil on heaks ühiseks objektiks jõgi. Valime sobiva transformeerimise algoritmi (nt Helmert). Võime ajaloolist kaarti pisut läbipaistvamaks teha, et vaadata, kui hästi see aluskaardiga klapib. Joonis 9.9: Jägala jõe ümbruse georefereeritud kaart Digiteerimine Loome tühja vektorkihi alade (Polygon) märkimiseks: Layer → Create Layer → New Geopackage Layer ja paneme selle nimeks nt koila_maakasutus. Lisame kihi atribuutide hulka ka tekstilise tunnuse/atribuudi/tulba (string) nimega tyyp. Joonis 9.10: Maakasutuse digiteerimise kihi tegemine Digiteerime georefereeritud 17. sajandi kaardilt Koila küla põllud ja heinamaad. Iga märgitud ala juurde kirjutame, kas see on põld või heinamaa. Digiteerimisest ja kihtide loomisest on täpsemalt juttu 7. praktikumis. Kaardi tingmärkide tuvastamisel on abiks Rahvusarhiivi leppemärkide juhend. Koila küla põllumaade tuvastamisel vaadake ajaloolise kaardi vasakul all nurgas olevat legendi. Koila küla on tähistatud B tähega (Koillküla, vt nt EKI kohanimeraamatut). Kuna põllu- ja heinamaad piirnevad üksteisega, siis on kasulik aktiveerida haakumine ehk snapping, et üksteisega külgnevate alade ühised käänupunktid oleksid täpselt samade koordinaatidega. Selleks valime Project → Snapping options → klikime punasel magneti ikoonil ja valime selleks, mille külge haakida, käänupunktid (Vertex). Nüüd haakub kursor kihi läheduses automaatselt selle käänupunktide külge. Joonis 9.11: Alade digiteerimine Haakimise lihtsustamiseks võib sisse lülitada ka tööriista Enable tracing , mis võimaldab üht vektorobjekti teise külge haakida, ilma et peaks kõiki punkte käsitsi läbi klikkima. Piisab vaid kursori liigutamisest üle teise vektorobjekti käänupunktide. Kui oleme alad digiteerinud, vajutame Save ja uuesti kollase pliiatsi ikooni, et lõpetada korraks kihi muutmine. Pindalade arvutamine Arvutame igale märgitud alale selle pindala. Selleks tuleb atribuuttabelisse luua pindala tulp ja sisestada avaldis selle arvutamiseks. Avame tööriista Field Calculator (nt tööriistapaneelilt või atribuuttabeli juurest). Teeme linnukese valiku Create a new field ette, tulba nimeks paneme pindala_ha ja tulba andmetüübiks määrame kümnendarvu (Decimal number (real)). Expression lahtrisse, mis ütleb, kuidas ja mille põhjal loodud tulpa väärtusi lisada, kopeerime koodi round($area / 10000, 2). See arvutab iga ala pindala ruutmeetrites ($area), jagab selle 10 000-ga ehk teisendab hektariteks ja lõpuks ümardab tulemuse (round()) kahe komakohani. Joonis 9.12: Pindala arvutamiseks tulba loomine ja kasutatud funktsioon Tulemuseks on kiht, mille atribuuttabelis on olemas alade pindalad. Seda saab kasutada näiteks maakasutuse ulatuse ja muutuste uurimiseks. Joonis 9.13: Digiteeritud maa-alad 9.4 Harjutus 3: käsikirjalise kaardi georefereerimine Georefereerime 3. praktikumis käsitsi joonistatud kaardid Tartu kesklinnast. Valime sobivaima algoritmi. 9.5 Veebilahendus georeferencer.com töötab sisuliselt täpselt samamoodi nagu QGISi Georeferencer, aga võimaldab georefereerida internetis ja ilma spetsiaalse tarkvarata. 9.6 Järgmisel korral Kolmapäevases praktikumis vaatame lähemalt, kuidas saab QGISis ruumiandmetega töötamisel kasutada avaldisi ja päringuid. "],["avaldised.html", "Praktikum 10 Avaldised ja päringud 10.1 Avaldised 10.2 Päringud 10.3 Ülesanne 1: “ei ole”/“pole” suhtelised sagedused murdekorpuses 10.4 Ülesanne 2: “ei ole”/“pole” murdeatlase levikuandmed 10.5 Ülesanne 3: “ei ole”/“pole” selged eelistused 10.6 Ülesanne 4: tekstiatribuutide muutmine 10.7 Järgmisel korral", " Praktikum 10 Avaldised ja päringud Impordime tänaseks praktikumiks esmalt QGISi kihelkondade shapefile’i (EKI, Peeter Päll), shapefile’i, mis sisaldab andmeid ei ole ja pole eituskonstruktsioonide leviku kohta eesti murretes Andrus Saareste 1955. aasta “Väikese Eesti murdeatlase” põhjal, CSV-faili, mis sisaldab andmeid ei ole ja pole suhtelisest sagedusest Eesti murrete korpuses. NB! Kodeering on UTF-8, välju eraldab semikoolon, esimesel real on tulbanimed ning koordinaatide infot failis ei ole. Joonis 10.1: Lisatud kihid Kui soovid võrrelda, kuidas EKI kihelkondade kaart klapib Maa-ameti kihelkondade kaardiga, võid taustaks panna veel WMS-i või WFS-i kaudu Maa-ameti ajaloolise haldusjaotuse kaardi: https://teenus.maaamet.ee/ows/wms-ajalooline-haldus?. 10.1 Avaldised Avaldised (expressions) on tehted ja vormelid, mille abil hõlpsalt muuta atribuutide väärtusi, luua uusi (virtuaalseid) atribuute või kihte, andmetest alamhulki välja filtreerida, teha statistikat jne. Avaldiste abil saab andmeid QGISis mitmekülgsemalt analüüsida ning visualiseerida. Avaldisi saab QGISis kasutada mitmes kohas, näiteks objektide valimiseks Select Features by Expression tööriista abil , objektide valimiseks atribuuttabeli alumisest vasakust nurgast Advanced Filter (Expression) , atribuutide muutmiseks ja lisamiseks Field calculator’is , päringute tegemiseks Query builder’is (Layer Properties → Source → Query Builder) , päringute tegemiseks Database Manager’is (Database → DB Manager) , sümbolite, siltide või paigutuse parameetrite muutmisel (Symbology → Rule-based) , jne. Avaldisi saab eeldefineeritud funktsioonide abil koostada niisiis mitmeks erinevaks otstarbeks, vaata ülevaadet QGIS 3.28 juhendist. Sealjuures saab üht ja sama asja teha sageli erineval moel. Oleme juba lihtsate avaldistega kokku puutunud, kui filtreerisime aadressiandmete andmestikust välja ainult eluruumid: \"ADOB_LIIK\" = 'ER'; arvutasime digiteeritud polügoonide pindala (9.12): round($area / 10000, 2). Vaatame sel korral harjutuste ja ülesannete toel lähemalt operaatoreid (Operators), matemaatilisi funktsioone (Math), tingimuslauseid (Conditionals) ning teksti muutmise võimalusi (String). Operaatorid ja funktsioonid, millega tänases praktikumis kokku puutume, on -: lahuta ühest väärtusest teine; &gt;: leia, kas üks väärtus on suurem kui teine (tagastab 1 (TRUE) või 0 (FALSE)); &gt;=: leia, kas üks väärtus on suurem kui teine või sellega võrdne (tagastab 1 (TRUE) või 0 (FALSE)); IS: mingi (atribuudi) väärtus peab olema mingi kindel väärtus (sama, mis =, tagastab 1 (TRUE) või 0 (FALSE)); IS NOT: mingi (atribuudi) väärtus ei tohi olla mingi kindel väärtus (sama, mis !=, tagastab 1 (TRUE) või 0 (FALSE)); ILIKE: kas mingi (atribuudi) väärtus vastab mingile kindlale mustrile (tõstutundetu)? (tagastab 1 (TRUE) või 0 (FALSE)); OR: operaator VÕI (tagastab 1 (TRUE) või 0 (FALSE)); if(tingimus, kuikehtib, kuieikehti): kui kehtib mingi tingimus, määratakse mingi väärtus, kui ei kehti, siis mingi muu väärtus (sama, mis CASE ... WHEN ... THEN ... ELSE ... END); length(tekst): leia mingi teksti/sõne pikkus tähemärkides; replace(tekst, midaasendada, millegaasendada): asenda tekst või selle mingi osa muu tekstiga; regexp_replace(tekst, midaasendada, millegaasendada): asenda tekst või selle mingi osa muu tekstiga, kasutades regulaarvaldisi. 10.1.1 Harjutused Harjutus 1: operaatorid objektide valimiseks Kasutame valiku tööriista (Select Features by Expression), et teha aktiivseks kõik need kihelkondade polügoonid, millel on midagi kirjutatud tulpa Problem (nt selleks, et hakata parandustega tegelema). Kõikide atribuutide/tulpade nimed ja tüübid saab kätte jaotisest Fields and Values. Nupp All Unique näitab atribuudi kõiki eri väärtuseid, nupp 10 Samples sellest kuni kümmet esimest eri väärtust. Topeltklikk atribuudi nimel liigutab jutumärkide vahel oleva atribuudi vasakul asuvasse avaldise kasti. Avaldiste kastis viidataksegi topeltjutumärkidega atribuuttabeli mingile tunnusele (= tulbanimele), ühekordsete jutumärkidega mingitele tekstilistele väärtustele (nt kui küsime tulbast Parish_id Pühalepa kihelkonna rida, siis peaksime kirjutama avaldise \"Parish_id\" = 'Phl' või \"Parish_id\" IS 'Phl'). Jaotuse Operators alt leiame terve hulga sümboleid, mille abil teha nt arvutustehteid, võrdlustehteid või tekstitöötlust, sh vajamineva operaatori IS NOT. Tahame leida niisiis atribuuttabelist neid ridu, kus tulp Problem ei ole tühi: \"Problem\" IS NOT NULL. Vajutame nupul Select Features. Joonis 10.2: Probleemsed kihelkonnad Harjutus 2: tingimuslaused uute atribuutide/tunnuste loomiseks Kasutame tööriista Field Calculator, et lisada ei ole/pole atlase levikuandmetesse virtuaalne (st ajutine) tekstiatribuut nimega saj19, kus oleks väärtus “jah” ridadel, kus keelejuhi sünniaeg on väiksem kui aasta 1900, “ei”, kui keelejuhi sünniaeg on hilisem, ja “ei tea”, kui keelejuhi sünniaega pole märgitud. Siin läheb vaja tingimuslauseid jaotises Conditionals. Kasutame siin funktsiooni if, mille järel sulgude sees komadega eraldatult tuleb anda esmalt tingimus (“Kas tulbas SaKJSynd olev arv on väiksem kui 1900?”), seejärel väärtus juhul, kui tingimus vastab tõele, ning lõpuks väärtus juhul, kui tingimus ei vasta tõele: if(\"SaKJSynd\" &lt; 1900, 'jah', 'ei'). Meil on aga atribuuttabelis ka sellised read, kus keelejuhi sünniaeg võrdub 0-ga või on NULL, sest see pole teada. Meil oleks oluline märkida ära, et nende puhul me tegelikult sünniaega hinnata ei oska: if(\"SaKJSynd\" IS 0 OR \"SaKJSynd\" IS NULL, 'ei tea', if(\"SaKJSynd\" &lt; 1900, 'jah', 'ei')): Kui tulbas “SaKJSynd” on väärtus 0 VÕI polegi midagi (NULL), märgi tulpa “saj19” väärtus ei tea, vastasel juhul kui tulbas “SaKJSynd” on väärtus, mis on väiksem kui 1900, märgi tulpa “saj19” väärtus jah, vastasel juhul väärtus ei. Joonis 10.3: Uue tulba tekitamine Harjutus 3: tekstiavaldised sümbolite kujundamiseks (1) Värvime kihelkonnad selle järgi, kui mitu tähte nende nimes on, aga nii, et me ei pea atribuuttabelisse selleks eraldi tunnust looma. Valime kihelkondade kihi Symbology alt Graduated ja Value puhul ühe konkreetse tunnuse nime valiku asemel vajutame lahtri kõrval olevat avaldise sümboliga nuppu . Kihelkondade nimed on tulbas Name. Teksti/sõne pikkuse leidmiseks on jaotise String all funktsioon length: length(\"Name\"). Lisame ka sildid, et kontrollida, kas värvilegend peab paika. Alloleva kaardi saamiseks teeme veel mõned kujunduslikud sammud: Symbology → Symbol → Simple Fill: muudame polügoonide piirjoonte (Stroke) läbipaistvust 16% peale; teeme linnukese Draw effects valiku ette ja vajutame kollasel tähekesel, seal omakorda teeme linnukese Drop Shadow ette, valime varju ulatuseks (Offset) 135 kraadi ja 1 mm, udustamise raadiuseks (Blur radius) 2 mm ning Blend mode väärtuseks Normal. Symbology → Labels: muudame teksti suurust väiksemaks (Text → Size → 5 points); joonistame teksti ümber pooleldi läbipaistva puhverala (Buffer → Draw text buffer → Opacity = 50%); muudame siltide paigutuse nurga alla (Placement → General Settings → Mode = Free (Angled)); näitame kõiki (ka kattuvaid) silte (Rendering → Overlapping labels → Mode = Allow Overlaps without Penalty, vanemates QGISi versioonides Rendering → Show all labels for this layer (including colliding labels)). Joonis 10.4: Kihelkonnad vastavalt nende nimede pikkusele Harjutus 4: tekstiavaldised sümbolite kujundamiseks (2) Toome värvi ja/või sümboliga esile ainult need “ei ole”-“pole” andmestiku punktid, mille asustusüksuse nime alguses või lõpus on Jõe-/-jõe või Järve-/-järve. Teised punktid värvime halliks ja teeme läbipaistvamaks. Need punktid, millel asulanime atribuuttabelis ei ole, jätame jooniselt välja. Asendame esmalt ő-sümbolid tulbas “ANIMI” õ-tähtedega: Selleks saame Field Calculator’is uuendada olemasolevat atribuuti “ANIMI” (Update existing field) regulaaravaldise abil (String → replace): replace(\"ANIMI\", 'ő', 'õ'). Valime nüüd punktide kihi Symbology alt Categorized ja Value puhul vajutame jälle avaldise sümboliga nuppu. Saame kasutada näiteks operaatorit ILIKE: \"ANIMI\" ILIKE '%jõe%' OR \"ANIMI\" ILIKE '%järve%'. Selles avaldises ütleme, et kujunda mingit moodi ainult need punktid, mille ridadel atribuuttabelis on tulbas “ANIMI” järjend Jõe või jõe (ILIKE on tõstutundetu) sõna alguses, lõpus või keskel (sümbol % märgib ükskõik mis sümboleid ükskõik kui palju, sh ka 0 sümbolit), samamoodi järve kohta. Märgime sellised objektid näiteks tähekestega ja muud punktid, mis avaldisele ei vasta, helehalliks. Lisame sama avaldist kasutades ka sildid ainult valitud punktidele: if(\"ANIMI\" ILIKE '%jõe%' OR \"ANIMI\" ILIKE '%järve%', \"ANIMI\", NULL). Võime lisada alla veel Maa-ameti fotokaartide WMS-teenusest värvilise reljeefvarjutuse (21 vreljeef), et vaadata, kas leitud kohanimed ka päriselt veekogude ääres on. Joonis 10.5: Jõe- ja järvenimelised asulanimed 10.2 Päringud Lisaks eeldefineeritud funktsioonidele saab kasutada ka SQL-i päringuid, näiteks: Ridade ja tulpade valimine SELECT tulp FROM andmestik; vali andmestikust ainult üks tulp SELECT tulp1, tulp2 FROM andmestik; vali andmestikust kaks tulpa SELECT DISTINCT tulp FROM andmestik; vali andmestikust tulba unikaalsed väärtused SELECT * FROM andmestik; vali andmestikust kõik tulbad ja read SELECT * FROM andmestik WHERE tulp = ‘Mingi väärtus’; vali andmestikust kõik tulbad ja read, kus tulbas ‘tulp’ on väärtus ‘Mingi väärtus’ SELECT tulp1, tulp2 FROM andmestik WHERE tulp1 &gt; 50 AND tulp2 ILIKE ‘%St%’; vali andmestikust tulbad ‘tulp1’ ja ‘tulp2’ ning ainult sellised read, kus tulp1 väärtused on suuremad kui 50 ja kus tulp2s on lahtris kuskil tähejärjend ‘St’ Muutmine UPDATE andmestik SET tulp = ‘Mingi uus väärtus’ WHERE tulp = ‘Mingi vana väärtus’; uuenda andmestikku nii, et sea tulba ‘tulp’ väärtuseks ‘Mingi uus väärtus’ nendel ridadel, kus tulba ‘tulp’ väärtus on praegu ‘Mingi vana väärtus’ UPDATE andmestik SET tulp = ‘Mingi uus väärtus’ WHERE id = 8; uuenda andmestikku nii, et sea tulba ‘tulp’ väärtuseks ‘Mingi uus väärtus’ sellel real, kus id väärtus on 8 Lisamine INSERT INTO andmestik (tulp1, tulp2, tulp3, tulp4) VALUES (‘tulp1 väärtus’, ‘tulp2 väärtus’, ‘tulp3 väärtus’, ‘tulp4 väärtus’); sisesta andmestikku üks rida, kus tulpadesse ‘tulp1’, ‘tulp2’, ‘tulp3’ ja ‘tulp4’ lähevad vastavalt väärtused ‘tulp1 väärtus’, ‘tulp2 väärtus’, ‘tulp3 väärtus’ ja ‘tulp4 väärtus’ Kustutamine DELETE FROM andmestik WHERE tulp = ‘Mingi väärtus’; kustuta andmestikust read, kus tulbas ‘tulp’ on väärtus ‘Mingi väärtus’ Järjestamine SELECT tulp1, tulp2, tulp3 FROM andmestik ORDER BY tulp1; vali andmestikust ainult tulbad ‘tulp1’, ‘tulp2’ ja ‘tulp3’ ning järjesta uus andmestik ‘tulp1’ väärtuste järgi (vaikimisi väiksemast suuremani või A-st Z-ni) SELECT tulp1, tulp2, tulp3 FROM andmestik ORDER BY tulp1, tulp2; vali andmestikust ainult tulbad ‘tulp1’, ‘tulp2’ ja ‘tulp3’ ning järjesta uus andmestik ‘tulp1’ ning siis ‘tulp2’ väärtuste järgi Grupeerimine SELECT tulp1, tulp2 FROM andmestik GROUP BY tulp1; vali andmestikust tulbad ‘tulp1’ ja ‘tulp2’ ning grupeeri andmed ‘tulp1’ unikaalsete väärtuste järgi SELECT tulp1, tulp2 FROM andmestik WHERE tulp1 = ‘Mingi väärtus’ GROUP BY tulp2; vali andmestikust tulbad ‘tulp1’ ja ‘tulp2’ ning ainult read, kus tulbal ‘tulp1’ on väärtused ‘Mingi väärtus’, grupeeri saadud tabel ‘tulp2’ unikaalsete väärtuste järgi 10.2.1 Harjutused SQL-i päringuid saab QGISis teha nt DB Manager’i tööriistaga (ülamenüüs Database → DB Manager). Mõned SQL-i funktsioonid (nt UPDATE) töötavad ainult “päris” andmebaasiformaatidega, nt GeoPackage’i failidega (kui need on ka GeoPackage’ina sisse loetud, mitte lihtsalt vektorfailidena). DB Manageris valime praegu virtuaalsete kihtide alt kihelkondade polügoonide kihi, valime ülevalt menüüst SQL Window ja kirjutame kasti päringu (asendame punktiirid sobivate väärtustega). Valime kihelkondade andmestikust ainult eestikeelse murrete nimede tulba ja salvestame selle eraldi kihil. SELECT ... FROM ...; Kui tahame uuele kihile saada kaasa ka polügoonide andmeid, peame valima ka geomeetria: SELECT ..., geometry FROM ...; Vajutame Execute, teeme linnukese Load as new layer ette ja vajutame Load. Valime kihelkondade andmestikust kõik tulbad, aga ainult need Võru murde kihelkonna read, kus kihelkonna pindala on suurem kui kõikide eesti kihelkondade keskmine pindala. SELECT ... FROM ... WHERE ... = '...' AND ... &gt; (SELECT AVG(...) FROM ...); Leiame murdealade kogupindalad. SELECT ..., SUM(...) AS pindala FROM ... GROUP BY ...; 10.3 Ülesanne 1: “ei ole”/“pole” suhtelised sagedused murdekorpuses Ei ole ja pole tunduvad eesti keeles paljudes kontekstides ekvivalentsed, samatähenduslikud ja sama funktsiooniga variandid. Sellel varieerumisel on aga ka oma murdetaust: mõned murded eelistavad analüütilist ei ole konstruktsiooni, teised sünteetilist pole konstruktsiooni, ehkki tegemist ei ole selgelt kategooriliste eelistustega (“kasutan ainult üht ja mitte kunagi teist”). Eesti murrete korpus sisaldab transkribeeritud murdeintervjuude tekste 10 traditsiooniliselt murdealalt. Tekstid on suuremas jaos salvestatud 1960.-1970. aastatel. Korpusest on võimalik teha päringuid nii sõnajärjendite kui ka märksõnade põhjal, et näha näiteks, milline on erinevate keelendite sagedusjaotus eri piirkondade murdetekstides. Värvime kihelkondade polügoonid selle põhjal, kui palju neis kasutatakse murdekorpuse andmete põhjal protsentuaalselt eituse varianti ei ole (vs. pole). Need suhtelised sagedused on tabelis eiole_pole_mk_props.csv, aga selle tabeliga ei ole seotud mingeid koordinaate. Peame niisiis ühendama tabeli mingi tunnuse alusel (nt kihelkondade nimede järgi) olemasolevate ruumiandmetega. Teeme esmalt virtuaalse koopia kihelkondade kihist (nimetame selle nt kihelkonnad2). Nõnda ei mõjuta see, mida edasi teeme, meie algandmestikku. Koopia tegemiseks on palju viise, ent harjutamise mõttes kasutame selleks siin SQLi päringut. Layer → Create Layer → New Virtual Layer: nimeta kiht nimega kihelkonnad2, Query väljale kirjuta SELECT * FROM kihelkonnad ja vajuta Add; Ühendame andmestiku eiole_pole_mk_props kihiga kihelkonnad2. Esmalt kontrollime, kas ühendamine võiks üldse korralikult õnnestuda, st kas mõlemas kihis viidatakse samadele kihelkondadele ühtmoodi. Selleks, et leida kihelkonnad/murrakud, mis on kahele kihile ühised, saab kasutada SQLi päringut SELECT Murrak FROM eiole_pole_mk_props INTERSECT SELECT Parish_id FROM kihelkonnad2;. Selleks, et leida aga kihelkonnad, mida teises andmestikus ei ole, võib kasutada päringut SELECT Murrak FROM eiole_pole_mk_props EXCEPT SELECT Parish_id FROM kihelkonnad2;. Kasutame päringu tegemiseks DB Manageri. Kui oleme vajutanud nupul Execute, väljastatakse alumisse aknasse need murrakute nimed, mis on küll andmestikus eiole_pole_mk_props tulbas Murrak, ent mida ei ole sellisel kujul andmestikus kihelkonnad2 tulbas Parish_id. Joonis 10.6: Vigase kihelkonnanime tuvastamine Parandame CSV-kihis selle murraku nime, mis ei sisaldu kihelkondade shapefile’is. Kuna CSV-faili atribuute muuta ei saa, lisame kihile uue virtuaalse atribuudi Murrak2, kus asendame vigase nime õigega (kasutame if-tingimuslauset). Joonis 10.7: Uue virtuaalse atribuudi loomine Lisame kihile kihelkonnad2 ei ole/pole kasutamise sagedusandmed. Kasutame andmestike ühendamiseks vastavalt Parish_id ja Murrak2 tulpasid. Teine moodus kihte ühe tunnuse alusel ühendada on nii, kui valid Processing → Toolbox → Vector general → Join attributes by field value. Erinevus tavalise Join-funktsiooniga on selles, et tekib uus kiht (vaikimisi nimega Joined layer). Värvime ei ole/pole proportsioonide infoga täiendatud kihi kihelkonnad2 polügoonid vastavalt ei ole suhtelisele sagedusele kihelkonnas/murrakus nii, et viirutatult oleksid märgitud ka kihelkonnad, millest murdekorpuse sagedusinfot ei ole (vaikimisi klassifitseerides neid kihelkondi enam üldse ei näidataks). Selleks peab kasutama reeglipõhist sümboloogiat. Nendele kihelkondadele, kust infot on, teeme 5 sagedusklassi (0-0.2, 0.2-0.4, 0.4-0.6, 0.6-0.8 ja 0.8-1.0). Joonis 10.8: Reeglipõhine polügoonide värvimine 10.4 Ülesanne 2: “ei ole”/“pole” murdeatlase levikuandmed Lisame joonisele ka murdeatlase punktandmed ning eristame punktide välimuse selle järgi, kas tegemist on “ei ole” või “pole” variandiga. Kuna praegu on keelendi tulbas igasuguseid variante, nt põle, ei (äi) ole, ole ei (õi), ei (äi, öi) pole, siis peaks esmalt looma ühe binaarse tunnuse, kus oleksid ainult väärtused ei ole ja pole. Selleks filtreerime (paremklikk → Filter) kihist 30_ei_ole välja ainult need read, kus keelendi info on olemas (\"Keelend\" IS NOT NULL) ning lisame selle atribuuttabelisse Field Calculator’i abil uue virtuaalse atribuudi/tulba nimega Keelend2, kuhu paneme väärtuse pole siis, kui keelendi tulbas esineb p-täht, ja ei ole siis, kui ei esine (see tähendab, et ka nt ei pole klassifitseeritakse pole-ks). Kasutame if-tingimuslauset ja ILIKE-operaatorit: if(\"Keelend\" ILIKE '%p%', 'pole', 'ei ole'). Joonis 10.9: Binaarse virtuaalse tunnuse loomine Valime binaarsele keelendile vastava sümboli ja värvi. Joonis 10.10: Korpuse ja atlase andmed eituskonstruktsioonide ei ole ja pole sagedusest ja levikust 10.5 Ülesanne 3: “ei ole”/“pole” selged eelistused Teeme kihist kihelkonnad2 duplikaadi nimega kihelkonnad3 (paremklikk → Duplicate Layer ja uuel kihil paremklikk → Rename Layer). Kasutades reeglipõhist polügoonide värvimist, kuvame kihil kihelkonnad3 värviliselt ainult sagedused, mille puhul ei ole ja pole proportsioonide absoluuterinevus on vähemalt 0,5. Ülejäänud polügoonidele (sh puuduvatele väärtustele) määrame halli värvi. Joonis 10.11: Suured sageduserinevused Nüüd muudame reegleid nii, et kihelkonnad, mille puhul ei_ole ja pole suur vahe on negatiivne (-0,5 või vähem), on punased, ja need, mille vahe on positiivne (0,5 või suurem), on sinised. Joonis 10.12: ei ole ja pole konstruktsioonide eelistused murrakutes 10.6 Ülesanne 4: tekstiatribuutide muutmine Muudame kihil kihelkonnad3 eestikeelsete murrete nimetustes kõik Setu murded Seto murreteks, kasutades if-tingimuslauset. Salvestame uued nimed uude tulpa “Murre”. Joonis 10.13: Setu murre Seto murdeks Muudame kihil kihelkonnad3 ingliskeelsete murrete nimetustes kõik Setu murded Seto murreteks, kasutades CASE-tingimuslauset. Salvestame uued nimed uude tulpa “Dialect”. Joonis 10.14: Setu murre Seto murdeks (2) Leiame kihil kihelkonnad3 kõik kihelkondade nimed, mille saksakeelne nimi algab lühendiga St. ning muudame lühendi Sankt’iks, kasutades regulaaravaldist. Salvestame uued nimed uude tulpa nimega “Saksakeelne_nimi”. Joonis 10.15: St. muutmine Sankt’iks Leiame kõik kihelkonnad, mille nimed lõppevad la-ga (nt Ambla) ja asendame need lõpud uues tulbas nimega “Kihelkond” LA-ga (AmbLA), kasutades regulaaravaldist: regexp_replace(\"Name\", '(.*)la', '\\\\1LA'). Siin ütleme, et tulba Name kõikides sõnades, mis algavad mis iganes sümboliga (nt tähega, numbriga, kirjavahemärgiga, tühikuga) ., mida esineb ükskõik mitu korda * (nt Kei, Viga, Amb, Halja) ja kus sellele millele iganes mitu iganes korda järgneb järjend la, jäta alles see esimene \\\\1 (ja siin ainus) grupeeritud osa (.*) enne la-d, aga grupeeritud osa lõpus asenda järjend la järjendiga LA. Põhimõtteliselt võiksime kasutada DB Manageris ka UPDATE CASE WHERE lauseid, ent kuna ükski meie kihtidest ei ole QGISi jaoks päris andmebaas, siis saame teha DB Manageris ainult päringuid, aga tabelit muuta ei saa. Saame aga eksportida mõne virtuaalse kihi näiteks GeoPackage-formaadis failina ning seda uuesti sisse lugedes saame andmestikku DB Manageris ka SQL-lausete abil muuta. 10.7 Järgmisel korral Järgmisel korral tegeleme põhjalikumalt andmekihtide ühendamise erinevate viisidega ning jätkame ka kujundusvõimaluste katsetamisega. "],["andmekihtide_yhendamine.html", "Praktikum 11 Andmekihtide ühendamine 11.1 Andmestike ühendamine 11.2 Geokodeerimine 11.3 Ruumiandmete omavahel ühendamine 11.4 Ruumiandmete käsitsi lisamine 11.5 Järgmisel korral", " Praktikum 11 Andmekihtide ühendamine 11.1 Andmestike ühendamine Kui meil on olemas andmestik, milles ruumilist infot väljendavad ainult mingid tekstilised tunnused (nt riikide, maakondade, linnade, talude vm nimed), saame nende konkreetsete asukohtade määramiseks, kaardil kuvamiseks ning ruumiliseks analüüsimiseks kasutada ära vabalt kättesaadavaid ruumiandmeid (nt Maa-ameti ruumiandmeid). Vaatame esmalt varasemast oluliselt suuremat 19. sajandi vallakohtute andmestikku. See on osa Rahvusarhiivi ühisloomeprojektist, mille käigus on praeguseks sisestatud üle 129 000 vallakohtuprotokolli, mis kajastavad muu hulgas näiteks laenusid ja võlanõudeid, varavastaseid kuritegusid, pärimisasju, kahjutasunõudeid, aga ka näiteks sõimu ja vägivalda ning muid üleastumisi. Siin praktikumis kasutatavas andmestikus on umbes 25 000 protokolli andmed. Tabel näeb välja selline: Selleks, et protokollide andmeid kaardil kuvada, peame maakondade, valdade või kihelkondade nimede abil ühendama tabeli mingite ruumiandmetega. Kasutame siin kõige suuremat üldistuse astet ja kasutame ühendamiseks maakondi. Esmalt laadime aga andmestiku QGISi: Layer → Add Layer → Add Delimited Text Layer → valime faili vallakohtud_RA.csv, tulpade eraldaja on tabulaator (Tab), linnuke on kastide ees First record has field names ja Detect field types, Geometry Definition on No geometry → Add → Close. Mitu eri maakonda andmestikus kokku on? Tuleb meeles pidada, et tegemist on põhiliselt 19. sajandi andmetega. Seega ei ühti vallakohtuprotokollide maakonnapiirid tänapäevaste maakondade omadega ning peame kasutama ühendamiseks Maa-ameti ajaloolise haldusjaotuse andmeid. Joonis 11.1: Maakondade piirid 19. ja 21. sajandil (allikas: Maa-amet) Laadime alla Maa-ameti ajaloolise haldusjaotuse 1917. aasta maakondade polügoonid ja avame need QGISis. Kontrollime, kas vallakohtute ja Maa-ameti maakondade nimed klapivad! 11.1.1 Lisaülesanne Maa-ameti ajalooliste maakondade kaardil puudub Võrtsjärv. Selleks, et see sinna lisada, on vaja teha järgmised sammud. Valime maakondade vektorkihile aluskaardi, kus oleks Võrtsjärv peale märgitud (näiteks tänapäevaste maakondade vektorkihi). Asetame selle ajalooliste maakondade kihi alla ning ajalooliste maakondade kihi teeme piisavalt läbipaistvaks, et aluskaart näha oleks. Teeme uue ajutise kihi nimega vortsjarv: Layer → Create layer → New Temporary Scratch Layer. Geometry type olgu Polygon, CRS olgu EPSG:3301. Teeme kihi aktiivseks, vajutame kihi muutmiseks kollasel pliiatsil, valime tööriista Add Polygon Feature ja digiteerime aluskaardilt Võrtsjärve polügooni. Salvestame ja vajutame muutmise pliiatsist kinni. Kui kasutame aluskaardina mõnd vektorkihti, saab palju kiiremini ja täpsemini digiteerida, kui lülitame haakimise tööriistamenüüs (Snapping Toolbar) sisse lisaks tavalisele haakimisele ka tööriista Enable Tracing ning valime haakimiskohtadeks nii käänupunktid (Vertex), jooned (Segment) kui ka joonte kesk- ja lõpupunktid (vastavalt Middle of Segments ja Line Endpoints). Sel juhul saad ajalooliste maakondade kihi korraks üldse välja lülitada ning võid digiteerida lihtsalt Võrtsjärvega vektorkihilt. Joonis 11.2: Vektorkihi järgi digiteerimine Valime menüüst Vector → Geoprocessing Tools → Difference. Input layer olgu ajalooliste maakondade vektorkiht ning Overlay layer loodud Võrtsjärve kiht. Difference alt vali Save to File ja salvesta kiht nt nimega Maakond_1917_Vorts. Vajuta Run ja Close. Kui saad veateate, siis mine Settings → Options → Processing → General → Invalid features filtering, topeltkliki tekstil Stop algorithm… ja vali selle asemel Do not filter (better performance). Seejärel proovi uuesti Difference tööriista. Kustuta vanad maakondade kihid ja Võrtsjärve ajutine kiht ning nimeta Maakond_1917_Vorts ümber nimega Maakond_1917. Joonis 11.3: Lisatud Võrtsjärv Mitteruumiandmete ja ruumiandmete ühendamiseks on kolm viisi. Esiteks võime liita vektorkihile csv-tabeli. Sellisel juhul säilib shapefile’i struktuur ja ruumikujud (polügoonid), atribuuttabelis on 9 rida (iga maakonna kohta üks) ning csv-failist lisatakse igale reale ainult mingid keskmised näitajad. Võime siin näiteks ühendada shapefile’iga iga maakonna protokollide keskmise pikkuse tähemärkides. Teiseks võime liita csv-tabelile vektorkihi ruumiinfo. Sellisel juhul säilib csv-faili struktuur, milles on üle 25 000 rea (iga protokolli kohta üks) ning iga rida saab juurde koordinaadid. Võime siin näiteks ühendada csv-failiga iga maakonna keskpunkti (tsentroidi) koordinaadid (NB! ei säili vektorkihi ruumikujud!). Kolmandaks võime ühendada vektorkihi ruumiinfo csv-tabeliga nii, et säilitame shapefile’i vektorandmete struktuuri ja ruumikujud (polügoonid), aga ühtlasi saame lisada ruumiinfo eraldi ka kõikidele tuhandetele csv-faili ridadele. See tekitab kõige mahukama andmestruktuuri, kuna igal kirje 25 000st oleks üks polügoon, ning võib nõuda küllalt palju arvutuslikku ressurssi. 11.1.2 CSV info liitmine vektorkihile Esmalt on meil vaja pikast, paarikümne tuhande kirjega CSV-tabelist saada tabel, kus oleks iga maakonna kohta selle maakonna kõikide protokollide keskmine pikkus tähemärkides. Selleks saame luua näiteks uue virtuaalse kihi ning kasutada SQL-i päringut. Lähme Layer → Create Layer → New Virtual Layer, nimetame kihi nt nimega keskmised, sisestame Query väljale pildil näidatud SQL-i päringu ning vajutame Add. Sama asja saab teha ka nt Database → DB Manager → SQL Window → päring SELECT maakond, AVG(number_of_characters) FROM vallakohtud_RA GROUP BY maakond; → Execute → Load as new layer → Load. Põhimõtteliselt saab info kätte ka nii: Processing → Toolbox → Vector analysis → Statistics by categories. See loob uue kihi Statistics by category, mis annab ülevaate mingist tunnusest (nt tähemärkide arv) teise tunnuse (maakondade) põhjal grupeerituna. Väljundi tulbas mean on keskmine tähemärkide arv iga maakonna kohta. Joonis 11.4: Virtuaalse kihi loomine Nüüd saame ühendada kihi keskmised ja ajalooliste maakonnapiiride kihi. Selleks saab kasutada nt jaotist Joins, mida oleme juba ka varem kasutanud (paremklikk kihil → Properties → Joins). Teine viis kihte ühendada on valida Processing → Toolbox → Vector general → Join attributes by field value. See tekitab uue kihi, vaikimisi nimega Joined layer, kus ei ole olemasolevat ja lisatud infot enam eristatud. Joonis 11.5: Andmestike ühendamine Processing Tools’iga Nüüd on meil maakonnapiiride kiht, mille atribuuttabelis on ka infot selle kohta, kui pikad vastava maakonna vallakohtuprotokollid keskmiselt on. Kasutame seda tulpa selleks, et värvida maakonnad eri tooni (pikemate protokollidega maakonnad tumedamalt, lühematega heledamalt). Selleks kasutame juba eelmistes praktikumides näidatud viise (Symbology → Graduated jne). 11.1.3 Vektorkihi liitmine CSV-le (punktid) Proovime nüüd ruumiinfot salvestada CSV-kihti nii, et koordinaadid oleksid tabelis atribuutidena eraldi tulpades. Ühendame vallakohtuprotokollide csv-failiga iga maakonna keskpunkti (tsentroidi) koordinaadid, nt selleks, et protokolle kaardil kuvada. Selleks tuleb meil esmalt leida maakondade polügoonide keskpunktid. Teeme aktiivseks kihi Maakond_1917 → Vector → Geometry Tools → Centroids → jätame vaikeväärtused ning vajutame Run. Maakondade kihile ilmuvad nüüd uuel kihil polügoonide keskpunktid. Joonis 11.6: Polügoonide keskpunktid Järgmiseks lisame tekkinud kihi Centroids atribuuttabelisse punktide x- ja y-koordinaadid: teeme kihi aktiivseks → Vector → Geometry Tools → Add Geometry Attributes, jätame jällegi vaikeväärtused ning vajutame Run ja Close. Tekkis uus kiht Added geom info. Nimetame selle ümber nt koord_keskpunktid. Kui me ei taha, et iga kord jälle uus kiht tekitatakse, võime atribuudid koordinaatidega lisada ka otse Centroids kihi atribuuttabelisse, kui kasutame avaldisi. Näiteks x-koordinaadi tulba tekitamiseks võtame lahti Field Calculatori → Create a new field, Output field name: x, Output field type: Decimal number (real) → avaldise lahtrisse kirjutame $x ja vajutame OK. Samamoodi saab luua y-koordinaadi tulba ($y). Ühendame nüüd CSV-kihi maakondade nimede järgi keskpunktide koordinaatide kihiga. Üks võimalus on teha jälle paremklikk kihil vallakohtud_RA → Properties → Joins → Add new join. Teine võimalus on kasutada taas hoopis Processing → Toolbox → Vector general → Join Attributes by Field Value, ent jälgime, et praegusel juhul oleks nüüd Join type’iks seekord valitud one-to-many, mis jätab alles kõik vallakohtute andmestiku read. Kõik ühe maakonna protokollid saavad ühesugused koordinaadid. Joonis 11.7: Andmestike ühendamine Võiksime nüüd loodud (üle 25 000 reaga ja koordinaatidega) kihi salvestada uue csv-failina ning salvestatud faili uuesti geoinfoga varustatud csv-failina sisse lugeda. Selle asemel aga võib kasutada ka Processing → Toolbox → Vector creation → Create points layer from table. Joonis 11.8: Koordinaatidega csv-faili muutmine punktikihiks Nüüd on meil kaardil üksteise all igas maakonnas sadu või tuhandeid punkte, ehkki vaikimisi näeme, justkui oleks igas maakonnas ainult üks punkt. Selleks, et protokollide jaotumist maakondades visuaalselt veidi paremini näidata, võime näiteks filtreerida välja ainult protokollid, mille teemaks on (kas ainult või muuhulgas ka) “Sõim ja vägivald” ning teha heatmap’i. Joonis 11.9: Heatmap protokollidest maakondades Ilmselt ei ole aga selline visualiseerimine tegelikult kõige parem viis protokollide jaotumist näidata. Heatmap peaks visualiseerima mingeid üleminekuid. Kuna meie aga vaatleme andmeid maakonna tasandil, on meil sisuliselt ainult 9 koordinaadipaari, mis tähendab, et jätame kõrvale olulise hulga teadaolevast geograafilisest varieerumisest. Niisiis, kui meil just tingimata pole sellist andmestikku vaja, oleks parem võimalusel kasutada väiksemaid haldusüksusi (nt kihelkondi) või visualiseerida maakondi lihtsalt nendesse jäävate punktide/protokollide arvu kaudu. Joonis 11.10: Heatmap protokollidest kihelkondades 11.1.4 CSV ja vektorkihi ühendamine polügoonidega vektorandmeteks Kolmas viis, mis jätab alles nii kõik CSV-andmestiku vaatlused (ühest kohast mitu vaatlust), ent võimaldab ühendatud andmestikku hoida polügoonidega vektorformaadis (mitte lihtsalt tabelina, milles punktide koordinaadid on atribuudid), saame kasutada sedasama ülal mainitud Join type = one-to-many võimalust. NB! Kuna tekitame sisuliselt üle 25 000 polügooni, võib protsess võtta palju aega. Valime uuesti Processing → Toolbox → Vector general → Join attributes by field value. Joonis 11.11: CSV ja vektorkihi ühendamine (polügoonidega) vektorandmeteks Tekib uus kiht Joined layer, milles iga vallakohtuprotokoll on geograafiliselt seotud mõne Eesti maakonna polügooniga. Võid proovida teha sama kihelkondade andmetega. 11.2 Geokodeerimine Täpsemate asukohtade määramiseks (nt aadresside jaoks) saab kasutada geokodeerimise teenust. Geokodeerimine on aadressi või kohanime seostamine geograafiliste koordinaatidega. Tagurpidi geokodeerimine omakorda võimaldab koordinaatidest tuletada aadressid ja kohanimed. Maa-amet pakub tasuta geokodeerimise teenust. Sealjuures on võimalik geokodeerida nii ainult üht aadressi/kohta korraga kui ka tervet hulka andmeid (massgeokodeerimine). Geokodeeri alustuseks näiteks enda, oma sõbra, vanemate vt aadress. Saad väljundit kuvada nii aadressiobjektide kaardirakenduses kui ka erinevates formaatides alla laadida. Kas jääd tulemuse täpsusega rahule? Massgeokodeerimise sisendiks sobivad CSV- või XLSX-formaadis andmetabelid. CSV-formaadi puhul peab välju eraldama semikoolon. Vaatame seda lühikese näite abil, kus geokodeerime Tartu Ülikooli valdkondade dekanaatide ametlikud aadressid. Kodeerimisel peab ära määrama, millises tulbas paikneb sisendaadress, mida geokodeerima hakatakse. Antud juhul on selleks tulp Aadress. Seejärel saab valida, milliste objektide hulgast vasteid otsitakse. Meid huvitavad siin eeskätt õppehooned, aga veidi ebatäpsemate aadresside puhul (talud, tänavad, maakonnad, linnad jne) tasub otsida ka teiste objektide seast; kuidas vasteid esitatakse. Eeskätt puudutab see aadresse, millel on kas mitu vastet või millele täpset vastet ei leita. Lõpuks saab valida, milliseid ruumiandmete tulpasid väljundisse soovime (nt kas kõiki aadressiobjektide id-sid ja tasemeid); kas tahame, et andmeid töödeldaks sünkroonselt, mispuhul saame protsessi jälgida kohe samas veebilehitseja aknas, või asünkroonselt, mispuhul andmed laetakse serverisse ning kasutajale saadetakse mõne aja pärast tulemus meilile. Viimast tasub teha eeskätt siis, kui andmestik on mahukas. Geokodeerimine töötab väga hästi tänapäevaste aadressidega. Vaatame aga nüüd ka natuke vanemaid andmeid, nimelt Rahvusarhiivi kaudu kasutatavat Tartu Ülikooli ja Eesti Ajalooarhiivi andmebaasi “Album Academicum 1918–1944”, mis koondab matrikliraamatutele jt allikatele tuginedes infot Tartu Ülikooli immatrikuleeritud üliõpilastest aastatel 1918-1944 (vaata lähemalt). Kuna andmestik ise on üpris mahukas, sisaldades infot enam kui 20 000 tudengi kohta, siis vaatame siin ainult kahe väga levinud perekonnanimega (Tamm ja Saar) üliõpilaste andmeid ning võrdleme nende perekonnanimedega üliõpilaste päritolu. Naisüliõpilaste andmete puhul ei pruugi võrdlus olla väga täpne, kuna andmestikus sisalduvad ka need kirjed, kus Tamm või Saar on saadud perekonnanimeks abiellumisel. Oleme veidi algandmestikku täiendanud ning lisanud standardiseeritud sünnikoha tulbad, kus andmebaasis kajastatud sünnikohtadel on lühendid lahti kirjutatud ning erinevate tasemete vahele on lisatud komad. Põhimõtteliselt võib proovida ka praktikumis tabelit tamm_saar_koond.csv massgeokodeerimisse saata (sel juhul tasub otsida ilmselt ainult haldus- ja asustusjaotuse klassifikaatorist, tulemuste esitamisel tahaksime otsida ka ajaloolistest andmetest ning kui vaja, siis üldistada täpsemat aadressi üldisemaks), ent kui teeme seda kõik koos, võib server saada üle koormatud. Seepärast oleme lisanud praktikumi materjalidesse ka juba geokodeeritud faili tamm_saar_koond_geokod_std2.gpkg, mis kasutas aadressidena tulpa Sünnikoht_std2 (kus on mitu kohanime tasandit, ent kustutatud on liiginime näitavad sõnad, nagu vald, kihelkond, maakond jms), ja faili tamm_saar_koond_geokod_std3.gpkg, mis kasutas aadressidena tulpa Sünnikoht_std3 (kus on ainult kõige madalama taseme kohanimi). Ülesanne Laadime geokodeeritud andmestikud vektorkihtidena QGISi (NB! Arvestame kodeeringut valides, et tegemist on Maa-ameti failidega); valime andmetele sobiva aluskaardi (nt Maa-ameti ajalooliste aluskaartide hulgast, ent seekord WFS-teenusena); värvime emma-kumma kihi punktid selle järgi, kas tegemist on Tamme- või Saare-nimeliste üliõpilastega (tulp pk). Võib kasutada ka erinevaid sümboleid. Teise kihi teeme nähtamatuks; viime punktide läbipaistvuse 30% peale. Väga selget geograafilist jagunemist nende perekonnanimedega ei näe. Vahest võiks vaadata ka selgemalt murdetaustaga nimesid, nt Lõhmus-Niin-Pärn-Pähn, Pedajas-Mänd vmt. Vaatame nüüd ka atribuuttabeleid. Kuna tegemist on ajaloolise andmebaasiga, on paljud kohanimed vahepeal muutunud, samuti on muutunud haldusjaotus. Vaatame geokodeeritud tabeleid ning püüame välja selgitada, milliste kohtadega on geokodeerijal probleeme olnud. Eeskätt aitab selle puhul puuduvate aadresside ridade tuvastamine ning sisend- ja täisaadressi tulpade võrdlus. Milliseid probleeme võib märgata? Kui tahame näiteks uurida ridu, kus standardiseeritud sünnikoha maakond ja normaliseeritud aadressi maakond ei klapi, võime kasutada objektide valimisel päringut NOT \"Sünnikoht_std\" ILIKE regexp_replace(\"NORMADDRESS\", '(.*) maakond.*$', '%\\\\1maa%'): regexp_replace(\"NORMADDRESS\", '(.*) maakond.*$', '%\\\\1maa%') võtab tulba NORMAADRESS ja jätab seal alles ainult selleteksti, mis tuleb rea alguses kuni tühiku ja sõnani maakond (nt Tartu maakond, mis iganes täpsustusi siin veel tuleb), lisab teksti lõppu tähed maa ja teksti täitsa algusesse ja lõppu %, mis ILIKE operaatori juures tähendavad ükskõik mida ükskõik kui palju (nt %Tartumaa%). \"Sünnikoht_std\" ILIKE regexp_replace(\"NORMADDRESS\", '(.*) maakond.*$', '%\\\\1maa%') küsib ridu, milles tulp “Sünnikoht_std” sisaldaks samasugust väärtust nagu NORMAADRESSI tulbast tehtud väärtus (nt %Tartumaa%). Operaator NOT eitab tulemust ehk kõik read, mis enne said valitud, saavad nüüd mittevalituks ja valituks saavad hoopis read, kus see tingimus ei vasta tõele (maakonna nimed kahes tulbas ei klapi). Maa-ameti geokodeerimise teenus ei ole niisiis mõeldud ajalooliste andmete jaoks, ent ühes muude aluskaartide ja käsitsi kontrollimisega võib siiski pisut tööd lihtsustada. QGISis on õigupoolest ka sisse-ehitatud geokodeerija, mis annab ka tänapäevaste andemetega küllaltki häid tulemusi: Processing → Toolbox → Vector general → Batch Nominatim geocoder. 11.3 Ruumiandmete omavahel ühendamine Siiamaani vaatasime andmeid, kus ainult üks andmekihtidest sisaldab ka ruumiandmeid. Kui meil on näiteks aga kaks vektorkihti, mis mõlemad sisaldavad ka ruumiandmeid, saame ühendada andmeid ka ilma ühise atribuudita, koordinaatide põhjal. Ühendame näiteks maakondade shapefile’i ja geokodeeritud Tamme-Saare andmestiku. Selleks valime Processing → Toolbox → Vector general → Join attributes by location. Siin kohtame taas geomeetrilisi predikaate. equals - kahel objektil täpselt samad koordinaadid intersects - kaks objekti katavad vähemalt mingeid ühiseid koordinaate (sh nt servi) crosses - kaks objekti lõikuvad nii, et lõikumiskoht on madalama dimensionaalsusega kui objektid ise overlap - kaks objekti katavad mingeid ühiseid koordinaate, aga ei ole täpselt ühesugused, kohakuti ega ainult servapunktidest kattuvad touches - kaks objekti puutuvad kokku ainult servadest, aga objektide siseosa ei kattu within - esimene objekt tervenisti teise sees contains - teine objekt tervenisti esimese sees Kasutame geomeetrilist predikaati contains, sest tahame teada, millised punktid jäävad iga maakonna polügooni sisse (võivad ka polügooni sisemise piiriga külgneda) ja teame, et kõik punktid jäävad Eesti riigi maakondade piiridesse. Samuti võime igaks juhuks märkida meetodina ära intersects, juhuks kui mõni punkt asub täpselt maakondade polügoonide piiril. Kasutame ühendamistüübina one-to-many, et iga maakonna iga punkt (mitte ainult esimene) ühendataks vastava polügooniga. Joonis 11.12: Ruumiandmete kihtide ühendamine Nii saame nüüd punktide asemel kasutada analüüsil ja visualiseerimisel polügoone. Kuna meil on atribuuttabelis väga palju objekte ja iga kaardile kantud (st geokodeerimisel vähemalt mingi ruumiinfo saanud) objekti küljes nüüd mingi polügoon, ei ole see kuigi praktiline, aga kui meil oleks mingi väiksem andmestik (nt 9 punkti eri maakondadest), siis saaksime üldistada punktide asemel tervetele maakondade polügoonidele. Kui soovime näidata, kui palju mingitest maakondadest Tamme- ja Saare-nimelisi üliõpilasi oli immatrikuleeritud, saame leida esmalt, kui palju andmepunkte mingisse maakonda jääb, ning seejärel värvida maakondade polügoonid vastavalt punktide arvule. Selleks võib teha uue kihi, kus oleme kokku lugenud iga maakonna piiridesse jäävad punktid, aga seda võib teha ka olemasoleva kihiga graduated sümboloogias avaldise count(\"Matrikli_N\", group_by:=\"NIMI\") abil. Selles avaldises määrame, et polügoonid tuleks värvida vastavalt sellele, kui palju unikaalseid matriklinumbreid igas maakonnas esineb. Eeldame siinjuures, et igal üliõpilasel oli oma matriklinumber ja seega unikaalsete matriklinumbrite arv kattub üliõpilaste arvuga. Joonis 11.13: ‘count’-funktsioon Samuti võime teha eraldi joonised Tamme- ja Saare-nimelistele üliõpilastele, kasutades count-funktsioonis argumenti filter. Joonis 11.14: ‘count’-funktsioon koos filtri argumendiga Punktide arvu nägemiseks polügoonides on erinevaid viise, nt kirjutame sama avaldise Labels jaotisesse, et näidata punktide arvu polügoonide peal; Processing → Toolbox → Vector general → Join attributes by location (summary), mis laseb teha uue kihi, mis kajastab mitte enam üksikuid andmepunkte, vaid nende põhjalt tehtud erinevaid statistilisi näitajaid (nt maakondadesse jäävate punktide koguarv, maakondade üliõpilaste kõige varasem ja hilisem sünniaeg jne). Valime näiteks tabelist tunnused Matrikli.Nr. ja Sünniaeg ning leiame nende kohta näitajad count, min ja max. NB! Maa-ameti geokodeerija uues versioonis läheb vähemalt geopackage’ina alla laadides sünniaja tulp mingil põhjusel kaduma. Küll aga säilib see CSV-na alla laadides, mis pärast andmete sisselugemist võimaldab ka sünniaja kohta statistikuid leida. Lõpuks on võimalik punkte polügoonides leida ka nii, et valime Processing → Toolbox → Vector analysis → Count points in polygon, mis teeb uue kihi, kus polügoonide tabelile on lisatud lihtsalt uus tulp vastavasse maakonda jäävate punktide arvuga. 11.4 Ruumiandmete käsitsi lisamine Nagu nägime, ei anna automatiseeritud lahendused ja olemasolevad ruumiandmed alati piisavalt kvaliteetset tulemust. Sellisel juhul (näiteks ajalooliste andmestike puhul) tasub kasutada kohanimeandmebaase ja ajaloolisi kaarte aluskaartidena. Vaatame näiteks Hageri vallakohtu protokolli aastast 1890. Protokollis on ära märgendatud ka nimeüksused, ent need ei ole tänapäevases kirjaviisis. Nimed sisalduvad failis Harju_Hageri_Kohila_id4010_1890a_nimed.csv olevas tabelis, ent võid võrdluseks kõrvale võtta lahti ka terve protokolli teksti (vastav txt-fail). Impordime andmed csv-failina QGISi (NB! tabelil ei ole tulbanimesid). Filtreerime andmestikust välja ainult kohanimed (KO_koht). Lisame Maa-ameti WMS/WMTS teenuse kaudu ajalooliste kaartide hulgast Schmiti-Rückeri aluskaardi (XIX saj./1884), soovi korral ka mingi tänapäevase kaardi. Leiame kaardilt võimalikult palju CSV-tabeli kohanimedest ning teeme uue kihi, kuhu märgime vastavatesse kohtadesse punktid (Layer → Create Layer → New GeoPackage Layer). Punktide märkimiseks teeme loodud kihi aktiivseks ning vajutame kollasel pliiatsil, seejärel Add Point Feature. Joonis 11.15: 1890. aasta Hageri vallakohtuprotokollis mainitud kohanimed Puuduvaid nimesid võib otsida ka näiteks kohanimeandmebaasist või Maa-ameti ajalooliste kaartide kaardirakendusest, mis võimaldab mh ka päringuvõimalusi. 11.5 Järgmisel korral Kolmapäeval tegeleme visualiseerimisega (värvid, sildid, eksitamine kaartidel). "],["varvid.html", "Praktikum 12 Värvid, sildid ja eksitamine 12.1 Eksitamine 12.2 Värvidest 12.3 Visualiseerimine 12.4 Ülesanne 12.5 Järgmisel korral", " Praktikum 12 Värvid, sildid ja eksitamine 12.1 Eksitamine Visuaalsete moonutustega üritatakse sageli näidata andmeid graafiku või kaardi koostaja jaoks sobiva nurga alt. Alberto Cairo (Cairo 2019) on koostanud suurepärase raamatu How Charts Lie, mis õpetab lugejat eksitavaid graafikuid ja kaarte ära tundma. Ta eristab viis võimalust eksitamiseks: halvasti kujundamine, kahtlased andmed, ebapiisavad andmed, ebamäärasuse varjamine, eksitavate mustrite esitamine või neile vihjamine. Halvasti kujundamise teel eksitamine võib esineda ka lihtsalt läbimõtlematusest. Suhteliselt minimaalselt eksitava kaardi heaks näiteks on “Aktuaalse kaamera” ilmakaart, kus mingil põhjusel on kõik eraldiseisvad Eesti osad (manner ja saared) värvitud idast läände tumerohelisest heleroheliseks. Mingit infot selline visualiseerimine tegelikult ei edasta, kuid võib panna vaataja mõtlema, kas sellega tahetakse öelda midagi ilma kohta. Joonis 12.1: Kuvatõmmis “Aktuaalse kaamera” ilmakaardist Kolmemõõtmelised graafikud (ja kohati ka kaardid) on sageli märk halvast visualiseerimisest või tahtlikust eksitamisest. Allpool oleval joonisel on esimesel kolmel 3D graafikul jäetud mulje, et firmal läheb väga hästi. Vaadates aga tavalistelt kahemõõtmelistelt graafikutelt samu andmeid, on reaalne olukord palju selgem. Joonise võimalikult hästi mõistmiseks tuleb kindlasti tähelepanu pöörata skaaladele. Kui tahetakse erinevusi või muutusi näidata suuremana, kui need tegelikult on, siis ei pruugi skaalad alata nullist, vaid koostajale sobivast arvust. Joonis 12.2: Ettevõtte käekäik kolme- ja kahemõõtmelistel graafikutel (Cairo 2019, ptk 2). Uudisteagentuurid kasutavad sageli eksitavaid graafikuid, mis sobituvad sõnumiga, mida nad soovivad edastada. Kuidas eksitavad näiteks allpool olevad graafikud? Joonis 12.3: Kuvatõmmised Fox News ja NBC2 eksitavatest graafikutest Kõik kaardid on siiski juba olemuslikult eksitavad või valed, kuna nagu oleme varem rääkinud, tekivad projektsioonide tõttu kaardile moonutused. Seda eksitamist peetakse aga üldjuhul aktsepteeritavaks, kuna see on tavaliselt teada. Kõige sagedamini eksitavad kaardid vale värviskaala ja selle ulatuse valikute tõttu, olgu see tahtlikult või kogemata. Joonis 12.4: Vaesus USAs maakonniti. Ülemisel kaardil esitatakse andmed alahinnatult, keskmisel liialdatult ning alumisel võrdselt kõikide värvigruppide vahel ja keskmist arvesse võttes (Cairo 2019, ptk 2). Graafikute ja kaartide kvaliteet sõltub eelkõige aluseks olevate andmete asjakohasest kasutamisest. Oluline on eelnevalt veenduda andmete päritolus ja usaldatavuses. See on ka üks põhjus, miks lisame kursusel tehtud kaartidele viite Maa-ameti jt andmestikele. 12.2 Värvidest Andmete visualiseerimisel tuleb alati tähelepanu pöörata sellele, et kasutatud värvivalik ja skaala võimalikult hästi ja kõigile arusaadavalt infot edastaks. Värviskaalaga kaarti, joonist või graafikut vaadates peaks olema selge ülevaade andmete ulatusest ning üldiselt ei tohiks ühtegi väärtust (eriti neid, mis pole äärmustes) petlikult rõhutada. Värvivaliku puhul tuleb ka arvestada, kuidas näevad seda värvipimedad või kuidas jääks sama skaala näha mustvalgena (näiteks trükitult). Sel teemal ilmusid paar aastat tagasi mh ka artiklid The misuse of colour in science communication (Crameri et al. 2020) ja The Importance of Colormaps (Thyng 2020). Vaata lisaks fabiocrameri.ch/colourmaps.php. Joonis 12.5: Erinevate värviskaalade nähtavus sagedate värvipimeduste korral (Crameri et al. 2020, fig 2). Üldiselt on soovitatav vältida ka liiga erksaid ning kontrastseid värve nii esteetilistel põhjustel kui ka seetõttu, et need võivad varjata muud infot. Erinevat tüüpi andmete jaoks värvide valimisel on abiks colorbrewer2.org. Joonis 12.6: Värvipimeduse leviku kaart kontolt Terrible Maps Värvipimeduse spektrisse kuuluvate inimestega arvestamiseks peetakse kõige turvalisemaks värvikombinatsiooniks punase, kollase ja sinise värvipaletti. Samuti võib võimalusel eelistada monokromaatilist ehk ühevärvilist paletti, milles üleminekuid märgib heleduse-tumeduse skaala, mitte värvitoon ise. 12.3 Visualiseerimine Katsetame andmete erineva visualiseerimisega. Avame kihi asustusyksus_malestised.gpkg, kus on lisaks asustusüksustele kirjas ka mälestiste arv liikide kaupa (ajaloolised, arheoloogilised, kunstimälestised). Tegemist on lihtsustatud andmestikuga, kus kultuurimälestisi, mis kuuluvad mitmesse liiki, on loetud korduvalt. See tähendab, et juba eksitame kaardil paratamatult juba andmestiku valikust tulenevalt. Värvime asustusüksused vastavalt vabalt valitud väärtusele. Valime välja ühe omavalitsuse, millest soovime kaarti teha, ja teeme sellest eraldi kihi. Värvime omavalitsuse polügoonid vastavalt mingile tunnusele andmestikus. Katsetame erinevaid visualiseerimisviise. Nagu silte, saab igale kihi elemendile lisada ka graafikuid. Lisame sektordiagrammi, mis näitab, kuidas mälestised igas uuritava omavalitsuse asustusüksuses liigiti jagunevad. Selleks klikime tööriistal Layer Diagram Options , valime graafikutüübiks Pie Chart, Attributes jaotises valime tunnused ajalugu, arheo, arhitek ja kunst ning vajutame rohelisel ristikesel, määrame igale tunnusele oma värvi, Size jaotises valime Scaled size alt Attribute väärtuseks kokku, leiame maksimaalse väärtuse ja määrame sobiva suuruse (nt 6), teeme linnukese ka valiku Increase size of small diagrams ette ja määrame miinimumsuuruseks nt 2. Vajutame Apply. Selleks, et kaotada ära tühje diagramme nendest küladest, kust tegelikult ühtegi kultuurimälestist ei ole, liigume jaotisse Rendering → Visibility, Show diagram juures vajutame sümbolil ja valime Field type väärtuseks atribuudi kokku. Vajutame OK. Joonis 12.7: Hiiumaa kultuurimälestised 12.3.1 Sildid Sageli on olukordi, kus andmetele on vaja lisada silte, kuid need asuvad tihedalt koos ega paista seetõttu hästi välja. Siin on abiks tööriist callouts (ee k viiktekstid), mis võimaldab joonte abil objekti sildi selle keskpunktist ja/või teistest siltidest kaugemale asetada. Teeme kihil topeltkliki → Labels → Single labels. Lisame asustusüksuste nimede sildid ainult nendele küladele, kust on vähemalt 11 mälestist: Value kasti kirjutame avaldise if(\"kokku\" &gt; 10, \"ANIMI\", NULL). Selleks, et silte näha oleks, peab uuemas QGISi versioonis liikuma jaotisse Labels → Single labels → Rendering → Overlapping labels ning valima Mode väärtuseks Allow Overlaps without Penalty. Liigume jaotisesse Callouts ja teeme linnukese valiku Draw callouts ette. Vajutame OK. Peaaknas klikime ikoonil Moves a layer or diagramm , klikime siltidel, mida tahame liigutada, ja veame need sobivasse kohta. Siltidele võib lisada ka puhvrid, mis toovad need need paremini muude andmete taustal välja. Samamoodi saab neile lisada varjud. Joonis 12.8: Hiiumaa kultuurimälestised siltidega 12.3.2 Kaardi tegemine Kui oleme andmete visualiseerimisega valmis saanud, avame kaardi tegemiseks Print Layout ja lisame peaaknas oleva kaardi. Kaart näeb sageli parem välja, kui see ei ulatu päris servani, vaid jäetud on väike äär. Selleks, et kaardi elemente paremini paigutada, lülita sisse View alt Show grid ja Snap to grid. Kui tegemist on väljavõttega mingist suuremast alast, siis võib olla kasulik näidata, kus praegune vaade üldisemalt paikneb. Seda saab teha Overview abil. Selleks lukustame esmalt valla kaardistiili: Item Properties → Layers, teeme linnukese Lock layers ja Lock styles for layers ette. Seejärel lisame trükivaatesse uue kaardi tervest Eesti alast, ilma et eelnevalt valitud omavalitsuse kiht näha oleks. Valime Eesti ala kaardi Item properties alt Overviews → roheline plussmärk → Draw “Overview 1” overview → Map frame → Map 1. Lisame ülevaatekaardile ka taustavärvi (Item Properties → Background) ja raami (Item Properties → Frame). Joonis 12.9: Valmis kaart Vajadusel saab eksporditavale kaardile lisada ka atribuuttabeli: Add item → Attribute table. Item properties alt saab valida, milliseid tulpasid ja kuidas näidata. 12.4 Ülesanne Leidke endale paariline. Iga paar saab endale kahe peale ühe andmestiku. Tartu linna kalmistud (polügoonid) ja kalmistutele maetud kultuuriloolised isikud (polügoonid), võib lähemalt vaadelda ka ainult üht kalmistut, kuupäevadega töötamiseks on kasulikud Date and Time jaotise funktsioonid ja avaldised, näiteks võimaldab funktsioon age() arvutada välja kellegi vanuse ja funktsioon year() teisendada vanus päevades või lihtsalt ka mingi kuupäev ainult aastateks. Tartu linna rahvastiku ja eluruumide prognoos 2040. aastaks (2020. aasta andmete põhjal) (polügoonid), Tuntud eestlaste või Eestiga seotud isikute andmed, mis on aluseks rakendusele Notable people (punktid). Terve andmestiku viide ja allalaadimise link siin, andmestiku tutvustus siin. andmestikku sisse lugedes tasub mõelda, kas olulisemad on inimeste sünni- või surmakohad, mille koordinaadid vastavalt tulpades bplo1 (birth place longitude) ja bpla1 (birth place latitude) ning dplo1 (death place longitude) ja dpla1 (death place latitude). NB! Pane tähele, milline on andmestiku koordinaatide referentssüsteem ehk CRS! Ülesanne on mõelda välja vähemalt üks teema, mida andmete põhjal saaks kaardil kujutada, ning kujundada üks kaart nii, et andmed oleksid esitatud võimalikult hästi ja täpselt, võttes arvesse nii vajalikke/ebavajalikke elemente, skaalasid, värve jm-d, ja teine kaart nii, et andmed oleksid esitatud halvasti ja eksitavalt. Selleks, et tekiksid konkreetsed võrdlusalused, võiks esmalt paaris kokku leppida, mis elementidega mängitakse ja mis põhimõtetel andmeid esitatakse. Lubatud (mõnel juhul isegi soovitatud) on andmetest vaid mingite alamhulkade kujutamine, samuti võib muuta kihi ruumikujusid (näiteks väikeste polügoonide asemel kujutada nende polügoonide keskpunkte (Vector → Geometry tools → Centroids) või punktide asemel kujutada polügoonidena nendesse jäävate punktide arvu (Processing → Toolbox → Vector analysis → Count points in polygon)). Praktikumi lõpus laadige oma kaardid Moodle’isse (Muud materjalid -&gt; Head ja halvad kaardid). Vaatame neid järgmisel korral praktikumi alguses. 12.5 Järgmisel korral Maailma ruumiandmed ja diagrammid. NB! Järgmine kord 13. novembril! "],["maailm.html", "Praktikum 13 Maailma ruumiandmed ja diagrammid 13.1 Euroopa ja maailma andmed 13.2 Euroopa riikide filtreerimine 13.3 SKP/in visualiseerimine 13.4 Maailma linnade punktikiht 13.5 Järgmisel korral", " Praktikum 13 Maailma ruumiandmed ja diagrammid 13.1 Euroopa ja maailma andmed Varasemates praktikumides oleme tegelenud sisuliselt ainult Eesti alaga. Sageli võib olla vaja aga visualiseerida andmeid ka teistest riikidest. Sellega käesolevas praktikumis tegelemegi. Laadime alla avaandmete praktikumist tuttavalt lehelt Natural Earth Data maailma riikide (Admin 0 - Countries) kihi. Pakime selle lahti oma andmete kausta. Huvi korral võime ka lähemalt vaadata, mida andmetes täpsemalt kujutatakse, klikkides lingil About | Issues | Version History. Loeme maailma riikide andmed QGISi. Kuna maailma andmestik on ulatuselt oluliselt suurem kui Eesti ala, millega seni tegelenud oleme, siis on vaja muuta ka koordinaatide referentssüsteemi. Natural Earth Data andmestikud on esitatud geograafilises koordinaatide referentssüsteemis World Geodetic System 1984 (WGS 84, EPSG:4326). Selleks, et andmeid korralikult näha, tuleb vahetada senikasutatud Eesti ametlik süsteem EPSG:3301 õige vastu. Selleks klikime all paremal nurgas projekti koordinaatsüsteemi tekstile ja otsime avanenud aknas 4326. Nüüd peaks andmed õigesti näha olema. Vaatame andmestiku atribuuttabelit ja ka riigipiire. Nagu näha, on riigipiirid oluliselt lihtsustatud, kuna see võimaldab teha andmemahtu väiksemaks ja töö seeläbi kiiremaks. Lisaks ei ole sellisel skaalal detailsus niivõrd oluline. 13.2 Euroopa riikide filtreerimine Lõikame välja ainult Euroopa riigid. Riikide andmestikus on olemas tulp Region_UN, mille põhjal saamegi valida ainult riigid, mille väärtus tulbas on Europe. Kasutame selleks näiteks tööriista Select Features by Value. Riike võib mõistagi valida ka käsitsi, kasutades muid Select tööriistu. Kui riigid valitud, siis salvestame valiku ajutise kihina (Edit → Copy Features, Edit → Paste Features As Temporary Scratch Layer). Kustutame suure maailma riikide kihi. Mitmel Euroopa riigil on alasid ka Euroopa maailmajaost väljaspool, mis tulevad samuti valikuga kaasa. Vajadusel saab eraldiseisvad polügoonid ka kustutada. Proovides aga kustutada näiteks Prantsuse Guajaanat, kustub hetkel ka kogu Prantsusmaa, kuna kõiki ühele riigile kuuluvaid alasid käsitletakse selles andmestikus ühe objektina. Kustutades Venemaa, kustub ka Kaliningradi oblast Leedu ja Poola vahel. Sellise kihi tüüp on Multipolygon: mitu eraldiseisvat polügooni moodustavad ühe kokkukuuluva objekti. Soovides eraldiseisvaid polügoone kustutada, tuleb need kõigepealt eraldi objektideks teha. Selleks valime Vector → Geometry Tools → Multipart to singleparts, Input layer väärtuseks määrame varem tehtud ajutise Euroopa riikide kihi, vajutame Run. Vajutame nüüd Single parts kihi muutmiseks kollasel pliiatsil ja kustutame valiku tööriista abil ookeanidest kaugemad saarestikud, kui teeme kihil paremkliki ja valime Zoom to layer ning näeme sobivat ala, siis lõpetame kollasele pliiatsile klikkides muutmise. Vahetame projekti koordinaatide referentssüsteemi. Ülemaailmse EPSG:4326 asemel valime referentssüsteemiks ETRS89-extended / LCC Europe EPSG 3034, mis on sobilik kogu Euroopa alaga töötamiseks. Kui nüüd Single parts kihi atribuuttabelit vaatame, näeme, et nüüd on suur osa riike jällegi mitme rea peal laiali, kuna iga eraldiseisev riigi osa on nüüd omaette objekt (nt Hiiumaa ja Saaremaa on eraldi polügoonid ja eraldi objektid). Võiksime need nüüd uuesti riikide ja omavalitsuslike alade (NAME või ADMIN) kaupa multipolügoonideks ühendada. Selleks valime Vector → Geometry Tools → Collect Geometries, Input layer väärtuseks määrame Single parts kihi, Unique ID fields väärtuseks valime atribuudi NAME, vajutame Run. Jätame lõpuks atribuuttabelisse alles ainult tulbad SOVEREIGNT, TYPE, NAME, POP_EST, GDP_MD ja SUBREGION. Selleks teeme kihil topeltkliki, jaotises Fields vajutame kihi muutmiseks kollasel pliiatsil, vajutame mingil atribuudil ja valime kõik tulbad (Ctrl+A), Ctrl-nuppu all hoides teeme mitteaktiivseks tulbad SOVEREIGNT, TYPE, NAME, POP_EST, GDP_MD ja SUBREGION, vajutame tulba kustutamise nupul Delete field, vajutame muutmise lõpetamiseks uuesti kollasel pliiatsil. Salvestame tulemuse faili nimega euroopa_riigid.gpkg. Joonis 13.1: Euroopa riigid 13.3 SKP/in visualiseerimine Proovime visualiseerida sisemajanduslikku kogutoodangut inimese kohta nii riigi värvi kaudu kui ka diagrammina. Värvime esmalt polügoonid avaldise abil, kus jagame GDP rahvaarvuga ning jaotame need väärtused sagedusklassidesse. Vaatame atribuuttabelit. Kas tahame näidata kõiki andmeid? Vatikani GDP real on arv -99. See ei tähenda, et Vatikani SKP oleks negatiivne, vaid nii märgitakse tabelis puuduvaid väärtusi. Võiksime niisiis Vatikani kaardil kuidagi eraldi kujutada. Samuti võiksime analüüsimata jätta Venemaa andmed. 13.3.1 Ülesanne: polügoonide värvimine SKP/in põhjal Polügoonide värvimiseks selle põhjal, kui suur on vastava riigi SKP inimese kohta, võib kasutada kohe lihtsalt avaldist, aga võime ka esmalt teha andmestikku uue ajutise tulba, et hiljem oleks vähem trükkimist. Uue tulba nimi võiks olla gdp_pc (GDP per capita), tüüp kümnendarv (decimal number) ja sinna võiksid minna väärtused, mille leiame avaldisega \"GDP_MD\" / \"POP_EST\" * 1000000. Vatikani ja Venemaa osade väärtused võiksid olla NULL. See tähendab, et võiks kasutada if-tingimuslauset: kui tulbas \"NAME\" on väärtus 'Vatican' või tulbas \"NAME\" on väärtus 'Russia', siis pane tulpa NULL, vastasel juhul aga jaga GDP (miljonites dollarites) läbi rahvaarvuga ja korruta saadud tulemus miljoniga. Kui tulp on loodud, tuleks värvida polügoonid loodud tunnuse põhjal nii, et tekiksid nt järgmised sagedusklassid: 3000-10000, 10000-20000, 20000-30000, 30000-40000, 40000-50000, 50000-60000, &gt; 60000 Lisaks tuleks eraldi reeglitega värvida Vatikan ja Venemaa osad, mida praegu Euroopa osadeks ei loe. Kõige lihtsam on ilmselt alustada tavalisest Graduated värvimisest, valida sobiv värviskaala ja klasside arv ja andmed ära klassifitseerida. Seejärel saab muuta stiliseerimise tüübiks Rule-based ja sagedusklasside piiride reegleid käsitsi muuta (klasside arv ja värviskaala on sel juhul juba olemas). Lisaks tuleks kirjutada kaks reeglit puuduvate klasside jaoks. Joonis 13.2: SKP inimese kohta Euroopa riikides 13.3.2 Harjutus: SKP/in kohta diagrammidena või punktidena Visualiseerime sama asja ka diagrammidena. Teeme Euroopa kihist koopia (paremklikk → Duplicate Layer). Teeme koopia kihil topeltkliki ja valime Diagrams → Pie chart → Attributes. Lisame Assigned attributes juurde samad avaldised, mida kasutasime eelmises kihis riikide värvimiseks. Kui tahta värvida diagramme samade värvidega nagu polügoone, saab kasutada näiteks color picker tööriista. Nagu näha, katavad mõned diagrammid kogu riigi ning varjavad ka teisi diagramme. Joonis 13.3: Diagrammid avaldistega Paneme diagrammi suuruse sõltuma riigi rahvaarvust. Lisaks tuleb määrata neile ka miinimumsuurus, et väiksema rahvaarvuga riikide diagrammid oleksid nähtavad. Valime Layer Diagram tööriistas Size jaotise. Size units väärtuseks valime Scaled size, mis võimaldab diagrammide suurusi muuta vastavalt mingile tunnusele andmestikus. Attribute väärtuseks valime POP_EST. Maximum value väärtuseks määrame 99 999 999. Size väärtuseks määrame 15 mm. Teeme linnukese valiku Increase size of small diagrams ette ja määrame miinimumsuuruseks 1 mm. Eemaldame Vatikani ja Venemaa diagrammid. Layer Diagram tööriist → Rendering → Visibility → Show diagram → Expression → Edit, kirjutame \"NAME\" IS NOT 'Vatican' AND \"NAME\" IS NOT 'Russia'. Värvime riikide polügoonid mingit neutraalset värvi (Single symbol) ja ekspordime kaardi koos legendiga. Joonis 13.4: SKP inimese kohta Euroopa riikides diagrammidena. Ringi suurus näitab rahvaarvu. Praegusel juhul oleks tegelikult võinud kujundada diagrammide asemel ka lihtsalt mingit polügoonide keskpunktide (Centroids) kihti. Kui tahta teha lihtsalt graafikuid, saab tegelikult sedagi QGISis teha. Selleks võib kasutada DataPlotly pistikprogrammi (Plugins → Manage and install plugins). Proovime teha tulpdiagrammi (Bar Plot) riikide rahvaarvust ja sektordiagrammi Euroopa 4 eri regiooni rahvaarvust. DataPlotly diagramme saab lisada ka trükivaatesse (Print Layout). 13.4 Maailma linnade punktikiht Impordime nüüd QGISi ka maailma suuremate linnade kihi. Eraldame sealt ainult Euroopa andmepunktid. Võime kasutada tööriista Select by Location, et valida ainult neid punkte, mis jäävad meie Euroopa kihi piiridesse. Joonis 13.5: Euroopa punktide valimine Värvime punktid vastavalt rahvastiku arvule (POP_MAX). Kuhu tundub Euroopa rahvastik koonduvat? Lähemalt vaatame punktimustrite analüüsi geostatistika praktikumides. 13.5 Järgmisel korral Sissejuhatus geograafilisse tekstianalüüsi. "],["tekstianalyys.html", "Praktikum 14 Geograafiline tekstianalüüs (1) 14.1 Sammud 14.2 Näited 14.3 Ressursid 14.4 Ülesanded 14.5 Järgmisel korral", " Praktikum 14 Geograafiline tekstianalüüs (1) Geograafiline tekstianalüüs on uurimissuund ja metodoloogia, mis ühendab kirjandusteaduste traditsioonilised tekstianalüüsi meetodid ruumianalüüsi ja arvutuslike tekstianalüüsi meetoditega. Geograafilise tekstianalüüsi nimi on kitsamalt seotud Lancasteri ülikooliga ning nimedega nagu Ian Gregory, Christopher Donaldson, Patricia Murrieta-Flores jt. Ehkki Lancasteri ülikooli projekt Mapping the Lakes: A Literary GIS ei olnud kaugeltki mitte esimene projekt, mis kirjandusteoste kaardistamisega tegeles, oli see üks esimesi, mis süsteemselt tegeles sellega, et demonstreerida, kuidas digiteerimise ja GISi abil saab visualiseerida ja analüüsida (ajaloolisest) struktureerimata tekstist välja kooruvaid mustreid, kohtade eri kujutamisviise ning kohtadega seotud tundmusi, kujutlusi jms. Joonis 14.1: Mapping the Lakes: kahe poeedi reisikirjeldustes mainitud kohtade võrdlus (Gregory et al. 2009) Joonis 14.2: Kohtadega seotud emotsioonid poeedi reisikirjelduses (Mapping the Lakes) Joonis 14.3: Inglismaa Lake District ehk “järvemaa” piirkond (© User:Nilfanion / Wikimedia Commons / CC-BY-SA) Joonis 14.4: Inglismaa Lake District ehk “järvemaa” piirkond (© User:Diliff / Wikimedia Commons / CC-BY-SA) Esimesele projektile Inglismaa Järvemaa piirkonnast järgnesid jätkuprojektid Spatial Humanities: Texts, GIS &amp; Places ja Geospatial Innovation: A Deep Map of the Lake District. Kui esimeses projektis tehti kohtade ja nendega seotu tuvastamisel rohkem käsitööd, siis järgnevates kasutati juba enam tekstide ja keele automaattöötluse vahendeid. Samuti kasutati hilisemates projektides ka muid andmeid (nt rahvastikuandmeid). Praegu võib geograafilise tekstianalüüsi keskmeks pidada niisiis korpuslingvistiliste meetodite kasutamist, ent laiemalt võib sellesse valdkonda lugeda mis tahes kohtadega seotud kirjandusliku või ajaloolise teksti analüüsi ja visualiseerimise, nn literary GIS või literary mapping. Joonis 14.5: Literary Mapping in the Digital Age (Cooper et al. 2016) (vaata sisukorda) Geograafilises tekstianalüüsis on prominentsel kohal tekstides mainitud kohanimed ja nendega seostuv: Mis kohtadest tekstides räägitakse? Kuidas tekstides nendest kohtadest räägitakse? Mida räägitakse tekstides nende kohtadega seotud objektide ja nähtuste kohta? Geograafiline tekstianalüüs on seega üks tekstide kauglugemise (distant reading) tehnikatest, mille abil tuvastada tekstidest mustreid. Humanitaarteadustes on meetodit kasutatud põhiliselt ajalooliste (st enne 20. sajandit kirjutatud) tekstide analüüsil, eeskätt ilmselt autoriõiguste tõttu, ent sellel on suur ühisosa ka tänapäevaste avalike (nt Twitteri) tekstide analüüsiga. Ajalooliste tekstide puhul lisandub analüüsi sageli teoste digiteerimise protsess (nt käsitsi sisestamine või tärktuvastus), mida võivad oluliselt komplitseerida aja jooksul toimunud muutused näiteks kirjastamiskonventsioonides, trükiformaatides, keeles, kirjaviisis. 14.1 Sammud Geograafilises tekstianalüüsis on tüüpiliselt 3 põhisammu. Tekstis viidatud kohanimede tuvastamine. Kohanimesid võib tuvastada mõistagi käsitsi, teksti lähilugemisel, aga üha enam kasutatakse tänapäevaseid loomuliku keele töötluse vahendeid (automaatne nimetuvastus, Named Entity Recognition). Üksikute tekstide puhul tagab käsitsi otsimine kindlasti parema kvaliteedi, ent suuremate tekstikorpuste puhul läheb see liiga aeganõudvaks ja ressursimahukaks. Probleeme: kohtadele ei ole alati viidatud konkreetsete kohanimedega (nt Anne sauna taga, kaks kilomeetrit Elvast läände, see küla, kust me läbi sõitsime); sageli seda aga ignoreeritakse põhjenduse toel, et konkreetsete kohanimedega tehakse veidi teisi asju kui ümberütlemistega: luuakse korraga tahtlikult narratiivset JA geograafilist ruumi. probleemid metonüümiaga (nt saab kohanime märgendi hoopis organisatsioon mingi riigi valitsuse, meeskondade vmt puhul, Itaalia võttis vastu otsuse…, Eesti kaotas 1-8); digiteerimise käigus tekib alati vigu, ükskõik kas tärktuvastuse või käsitsi sisestamisega; ajaloolistes kohanimedes palju varieeruvust, seal esinevad kohanimed ei pruugi sisalduda ka andmetes, mille peal automaatse analüüsi vahendid on treenitud; kui oskad veidi skripte kirjutada, saab nimetuvastust omakorda täiendada reeglitega (nt määra konstruktsioonid “X talu” alati kohanimedeks). Tuvastatud kohanimede ehk toponüümide sidumine koordinaatidega. Enamasti kasutatakse selleks koordinaatidega varustatud kohanimeloendeid (gazetteer) või kohanimeandmebaase (nimeüksuste vastete leidmine ehk Named Entity Matching). Probleeme: ühe ja sama kohanimega võib viidata mitmele kohale, tuleks lahendada viitesuhted. Selleks võib alati valida näiteks kõige tõenäolisema viite, täpsustada piirkonda või ka käsitsi õige viite määrata; kui oskad veidi skriptida, saab siingi kasutada samuti mingeid reegleid ja statistilisi tõenäosusi (nt Lisbon või Berlin viitavad üldiselt tõenäolisemalt Euroopa kohanimedele, aga Ameerika kirjanike puhul või USA idarannikust rääkides USA samanimelistele väikelinnadele). Mainitud kohtade ja nendega seotu analüüsimine, tõlgendamine ja visualiseerimine. Identifitseeritud kohtade mainimissagedusi võib võrrelda näiteks rahvastikunäitajatega (kas tihedamini asustatud kohti mainitakse ka rohkem? kas kohtade sündimus- või suremusnäitajad korreleeruvad nende mainimiste sagedusega?), muude ajalooliste, etnograafiliste vm andmetega. Aga võib ka analüüsida seda, mis kontekstis kohanimesid on tekstides mainitud, näiteks mis emotsioonidega seoses, milliste omadussõnadega seoses jne. Siin võib kasutada muu hulgas korpuslingvistilisi meetodeid (nt sagedasti koosesinevate sõnapaaride ehk kollokatsioonide tuvastamine), ühisloomet (nt lastakse inimestel mingeid kohtadega seotud tekstilõike mingil alusel hinnata või märgendada), aga loomulikult ka kvalitatiivset analüüsi. Analüüsi käigus selgub ka, milliseid osi tekstikorpusest tuleb n-ö lähilugeda ja milliste osadega saab hakkama ka kauglugemise teel. GISi võib kasutada selles etapis põhimõtteliselt ka lihtsalt visualiseerimiseks, aga on ka palju võimalusi põhjalikumaks analüüsiks. Kaht esimest sammu ehk kohanimede tuvastamist ja eraldamist tekstist ning nende koordinaatidega sidumist nimetatakse kokkuvõtvalt ka geoparsimiseks (geoparsing). Geoparsimine on seega laiem mõiste kui asukohamärgistamine või geokodeerimine, kuna tegeleb ka kohanimede tuvastamisega tekstist ning samuti ebamäärasemate kohaviidete tuvastamise ning viitesuhete lahendamisega. Joonis 14.6: Geoparsimine ühendab kohanimede tuvastamise ja koordinaatidega sidumise (Gritta et al. 2017) 14.2 Näited Mapping the Emotions of London in Fiction, 1700-1900: A Crowdsourcing Experiment Joonis 14.7: Londoni kujutamine kirjanduses (Heuser et al. 2016) Uuritud, milliseid Londoni kohti mainiti 1700.-1900. aastate kirjandusteostes, kas neid kohti kujutati pigem positiivsete või negatiivsetena ning milliste faktoritega vastav hinnang korreleerus. Kasutasid kohanimede tuvastamiseks automaatset nimetuvastust ja ka ajaloolisi kohanimeloendeid. Lasid ühisloome käigus inimestel märgendada, kas mainitud kohas toimub sündmus või seda ainult mainitakse ning kas kohaga seostatakse hirmu või õnnelikkust. Joonis 14.8: Londoni kujutamine kirjanduses (Heuser et al. 2016) Leiti, et kohtade mainimise arv ei korreleerunud Londoni elanike tegeliku jaotumisega ja Londoni üldise arenguga, vaid kirjandusteostes jäädi kuni 20. sajandini välja miskipärast ikkagi kinni Londoni 17. sajandi sotsiaalsesse geograafiasse. Kohtade seostamine õnnelikkusega korreleerus mingite piirkondade moderniseerumise ning sellega kaasnevate hüvedega, samas kui hirm jällegi seostus pigem piirkondadega, kus asusid distsiplinaarasutused, aga ka näiteks turgudega. Kirjanduslik perspektiiv pakub seega alternatiivse kaardi Londoni mõistmiseks (peab mingeid osi vähem oluliseks või mainimisväärseks). Kirjanduses rõhutatakse pigem mingite kohtade ajaloolist, avalikku ja kaubanduslikku tähtsust. GIS and Literary History: Advancing Digital Humanities research through the Spatial Analysis of historical travel writing and topographical literature Analüüsitud kolme 18. sajandi briti reisija - luuletaja Thomas Gray, loodusteadlase Thomas Pennanti ja põllumehe Arthur Youngi - kirjeldusi nende reisidest läbi Lake Districti, selleks et mõista, kuidas selle piirkonna looduslikud objektid ja maastik (orud, mäed jms) kujundasid seda, mis kohti rändajad külastasid, miks nad mingeid kohti teistele eelistasid ja miks mingeid kohti mainisid, ent ei külastanud. Kohanimed tuvastatud käsitsi, koordinaadid määratud kohanimeloendi järgi. Punktipõhisest esitusest rastermudeli juurde: reisikirjades kohad mitte kui diskreetsed objektid, vaid üleminekud. Joonis 14.9: Kohtadest kirjutamine ja maastikud (Murrieta-Flores et al. 2017) Kasutatud levinud geoinfosüsteemipõhiseid analüüsimeetodeid (Cost-Surface Analysis, Least-Cost-Path Analysis, spatial proximity test, Line Density Analysis) selleks, et analüüsida, kuidas Lake Districti suhteline ligipääsetavus mõjutas reisijate valitud teekondi ja sellest tulenevalt nende kogemusi. Esmalt simuleerisid mudelitega n-ö looduslikud koridorid ning seejärel arvutasid, kas reisikirjades kujutatud kohad on nendele koridoridele lähemal kui puhta juhuse läbi võiks oodata. Vastavalt looduslikele koridoridele ning kohtadele, mida kirjutajad mainisid, modelleeriti ka nende tõenäolised liikumisteekonnad ning vaadati, kas mõned piirkonnad said kolme reisija peale kollektiivselt eriti palju tähelepanu. Joonis 14.10: Kohtadest kirjutamine ja maastikud (Murrieta-Flores et al. 2017) Leiti, et reisijad tõepoolest liikusid mööda looduslikke koridore ning et liiguti põhiliselt kolme järve ümbruses, kuhu ehitati 18. sajandil ka paremaid teid. 14.3 Ressursid Geoparsitud tekstikogusid ei ole väga palju. Seega tuleb huvipakkuvate tekstidega teha läbi kõik ülal nimetatud sammud ise. On mõned valmislahendused, kuhu lihtsustatult öeldes läheb tekst sisse ja välja tuleb geoparsitud fail, milles on eraldatud kohanimed ja määratud neile koordinaadid. Näiteks võib kasutada Edinburgh Geoparserit (jookseb ainult Macil ja Linuxil, aga Linuxi virtuaalmasina abil ka Windowsis; juhend kasutamiseks siin), mis kasutab geoparsimisel kontekstilist infot, et leida tekstist kohanimed ning määrata neile õiged koordinaadid. On olemas ka online testversioon: http://jekyll.inf.ed.ac.uk/geoparser/. Edinburgh Geoparser kasutab muu hulgas GeoNamesi koordinaatide jm infoga varustatud üldist kohanimeloendit (sisaldab ka nt u 15 000 Eesti kohanime). Geocode.xyz CamCoder CLAVIN: programmi peab enne ise kompileerima (nõuab, et Java ja selle tööriist Maven oleksid installitud) DBpedia Spotlight GEOLocate veebiparser on pigem geokodeerija (NB! failiformaat) Eri geoparserite võrdlemiseks võib kasutada nt EUPEG Java-rakendust (demoversioon siin: https://geoai.geog.buffalo.edu/EUPEG/#). 14.3.1 Eesti keele geoparsimine Nimetatud ressursse saab mingil määral kasutada ka eesti keele jaoks, ent eesti keele puhul raskendab kohanimede tuvastamist oluliselt erinevate käändevormide kasutamine. Proovi näiteks mõnes ülalnimetatud geoparseritest parsida esmalt lõik Annely Peebo was born on November 16, 1971, in Võhma. She studied choir conducting and piano in Tallinn and singing in Vienna. In the second half of the 1990s, she moved from Estonia to Austria. She has starred in a French film and hosted the 2002 Eurovision Song Contest in Tallinn. She has also sung in Tartu. ja seejärel vastav eestikeelne tekst Annely Peebo sündis 16. novembril 1971 Võhmas. Ta on õppinud Tallinnas koorijuhtimist ja klaverimängu ning Viinis laulmist. 1990ndate teises pooles kolis ta Eestist Austriasse. Ta on mänginud ühes Prantsusmaa filmis ning juhtinud Tallinnas 2002. aastal toimunud Eurovisiooni. Ta on laulnud ka Tartus. Eesti keele automaatanalüüsi tööriistade kõige terviklikum komplekt sisaldub Pythoni EstNLTK teegis, mille kaudu on võimalik kasutada nii nimetuvastajat kui ka morfoloogilist analüsaatorit. Nende kasutamiseks tuleb aga osata pisut Pythoni skripte kirjutada (baasasjad saab üpris lihtsa vaevaga omandada nt siit), nimetuvastuse kasutamise juhendi leiab siit. EstNLTK nimetuvastaja eristab kolme tüüpi nimesid: isikunimed (PER), kohanimed (LOC), organisatsiooninimed (ORG). Samu tööriistu, mida EstNLTK teegis, kasutatakse ka nimetuvastuse demorakenduses (kuni 5000 tähemärgi pikkusele tekstile) https://ner.tartunlp.ai/. Ajalooliste tekstide nimetuvastuseks arendatud tööriistade prototüübid on kättesaadavad lehel https://github.com/soras/vk_ner_lrec_2022. Tuvastatud kohanimede algvormid saab omakorda saata näiteks Maa-ameti geokodeerimise teenusesse, et siduda kohanimed koordinaatidega. Võib kasutada ka QGISi geokodeerimise tööriistu (nt Batch Nominatim geocoder’it või mõnd paljudest pistikprogrammidest). Geoparsimiseks ongi lisaks valmislahendustele oluliselt laialdasemad võimalused erinevates programmeerimiskeeltes (nt Pythonis, Bashis, JavaScriptis). Pythonil on nt geoparsimise teegid Mordecai ja geoparsepy, mis võtavad sisendiks teksti ja väljastavad kohanimed koos koordinaatidega. Samuti kasutavad Pythonit suurem osa ülal nimetatud “valmis” geoparseritest. 14.4 Ülesanded 14.4.1 Geoparsimise katsetamine Kasutame siin Lake Districti korpuse (Corpus of Lake District Writing) tekstikatkeid, et testida veebis kättesaadavate geoparserite võimekust. Korpuses on kokku 80 teksti aastatest 1622-1900 ning need esindavad erinevaid žanre ja autoreid. 28 tekstis on käsitsi märgendatud kohanimed (u 250 000 sõna), mis moodustavad nn kuldstandardi, mille suhtes automaatse analüüsi vahendeid testida. Loe ka siit. Võtame teksti gold_standard_txt/Gray_cqp_13.txt ja üritame saada sellest veebiparserite abil kätte kohanimed ja nende koordinaadid. Hindame geoparsimise kvaliteeti. Kasutame võrdluseks käsitsi märgendatud kohanimede loendit (failis gold_standard_names/Grat_cqp_13.csv) ning leiame (ligilähedase) protsendi nimedest, mille parser suutis tuvastada, ning nimedest, mille parser valesti kohanimeks analüüsis. 14.4.2 Kohanimede tuvastamine Katsetame tekstikatkenditel automaatset nimetuvastust näiteks Dandelioniga, displaCyga, TextAnalysisOnline vm tööriistaga, mis nimetuvastuse funktsioone sisaldab. Proovime ka mõnd eestikeelset teksti. 14.4.3 Kohanimede geokodeerimine Katsetame järgmiseks QGISi sisse-ehitatud geokodeerijat: Processing → Toolbox → Batch Nominatim geocoder. Geokodeerime faili gold_standard_names/Gray_cqp_13.csv, kus on kõik Gray tekstis esinenud kohanimed (käsitsi märgendatud). Joonis 14.11: Batch Nominatim geocoder Hindame geokodeerimise kvaliteeti. Milliste nimedega oli raskusi? Võrlde saadud kaarti ka Mapping the Lakes projekti omaga aadressil https://www.lancaster.ac.uk/mappingthelakes/Gray%20Base%20Map%202.html. Võime punkte visualiseerida ka nii, et näitame suuremalt korduvalt esinevaid nimesid. Selleks võime näiteks kasutada DB Manageri ja luua uue kihi. Joonis 14.12: Korduvate punktide kokkulugemine Sellisel juhul saame Symbology jaotises valida Marker → Size, vajutada paremas ääres oleval kastil ja valida Field type väärtuseks loodud tulp count. Teine variant on kasutada punkti suuruse visualiseerimiseks kohe geokodeeritud kihi Symbology jaotises avaldist count(\"name\", group_by:=\"name\"), ilma uut kihti tekitamata. Selleks vali kastikesel klikkides Expression → Edit ja sisesta avaldis. Joonis 14.13: Korduvate punktide kokkulugemine ilma uut kihti tekitamata 14.5 Järgmisel korral Eestikeelsete tekstide kohanimede tuvastamine, standardiseerimine, geokodeerimine ja nendega seotud teksti analüüs. "],["tekstianalyys2.html", "Praktikum 15 Geograafiline tekstianalüüs (2) 15.1 Kohanimeüksuste ja tekstikatkendite meelsuse tuvastamine 15.2 Tekstikatkendi meelsuse tuvastamine Excelis 15.3 Koordinaatide lisamine (geokodeerimine) 15.4 Visualiseerimine 15.5 Järgmisel korral", " Praktikum 15 Geograafiline tekstianalüüs (2) Tänases praktikumis tegeleme geograafilise tekstianalüüsiga, katsetades eesti keele automaattöötluseks loodud vahendeid. Nagu eelmises praktikumis mainitud, sisaldub selleks kõige põhjalikum tööriistade komplekt Pythoni EstNLTK teekides. Kasutame geograafilise tekstianalüüsi näitlikustamiseks Riigikogu istungite stenogramme. Selle praktikumi jaoks oleme kraapinud veebist nende istungite protokollid, mis on toimunud vahemikus 01.01.2020 ja 06.11.2023. Joonis 15.1: Riigikogu istungite stenogrammid veebilehel Kõik protokollid on Moodle’is praktikumi materjalide kaustas eraldi alamkaustas nimega stenogrammid2023.zip. Samuti on materjalide hulgas kraapimiseks kasutatud R-i skript. Tänases ülesandes leiame, milliseid kohanimeüksusi on mingi istungi protokollis mainitud; analüüsime, milline on kohanimeüksust sisaldava tekstikatkendi meelsus: kas tekst on pigem positiivne, negatiivne või neutraalne; puhastame andmestiku; geokodeerime kohanimeüksused; visualiseerime andmeid. 15.1 Kohanimeüksuste ja tekstikatkendite meelsuse tuvastamine Kohanimeüksuste automaatseks tuvastamiseks ning nende vahetu konteksti eraldamiseks tekstist kasutame EstNLTK analüüsivahendeid. Selleks, et Pythoni installimiselt ning skriptide kirjutamiselt aega kokku hoida, kasutame praktikumis Google Colabi, mille kaudu saame jooksutada juba valmis kirjutatud skripti. Kui soovid eesti keele automaattöötluse kohta rohkem õppida, on suureks abiks EstNLTK õppematerjalid (kaustas tutorials) ja TÜ kursus “Eesti keele töötlus Pythonis”. Meelsusanalüüsiks kasutame siin Eesti Keele Instituudi emotsioonidetektorit, mille aluseks olev Pythoni kood on üleval GitHubi lehel https://github.com/EKT1/valence/. Sama kausta materjalid on ka Moodle’is failis valence-master.zip. Emotsioonidetektori kohta saad lugeda artiklist Pajupuu, Hille; Altrov, Rene; Pajupuu, Jaan (2016). Identifying polarity in different text types. Folklore. Electronic Journal of Folklore, 64, 25−42. Koodi jooksutamiseks vajuta koodiplokkide vasakus servas oleval noolekesel. Kui midagi skripti jooksutamisel ei tööta, on praktikumi materjalides kaasas ka ühe näidisfaili (202106091400.csv) analüüsid (kaustas kohanimed_valmis). kohanime_vorm kohanime_lemma kontekst meelsus Eestis Eesti esmaspäeval kinnitasime nädala töökava ja sinna hulka oli märgitud ka Sotsiaaldemokraatliku Erakonna fraktsiooni algatatud olulise tähtsusega riikliku küsimuse ” Ebavõrdsus Eestis – kas vaesusest saab välja kärpida ? ” arutelu . Ettekandjaks oli määratud majandusanalüütik Madis Aben . Me teame . positive Viljandimaalt Viljandimaa oleks mõeldav ? Sest inimestele peab ju ette ka ütlema . Näiteks üks esineja peaks sel juhul hakkama siia sõitma Viljandimaalt . Aitäh ! Möönan , et olukord ei ole väga selge , just esinejate vaatest , aga me saame üheskoos positive Eestis Eesti tagasi hea kolleegi Helmen Küti ettepaneku juurde . Asjaolu , et on nad pannud püsti sellise küsimuse nagu ” Ebavõrdsus Eestis – kas vaesusest saab välja kärpida ? ” arutelu , on iseenesest nii verbaalses mõttes äärmiselt oluline kui ka sisu positive Eestis Eesti muud selgitust ma ei taha , ainult seda , mis annab õiguse – Sotsiaaldemokraatliku Erakonna päevakorda pandud punkti ” Ebavõrdsus Eestis ” välja arvata ! Palun nimetage see norm ! Härra Grünthal , Riigikogu juhatus ei arva Sotsiaaldemokraatliku Erakonna fraktsiooni päevakorrapunkti positive Euroopa Euroopa ole protseduuriline küsimus . Läheme edasi tänase päevakorraga . Esimene päevakorrapunkt on väliskomisjoni esitatud Riigikogu otsuse ” Riigikogu otsuse ” Euroopa Julgeoleku- ja Koostööorganisatsiooni Parlamentaarse Assamblee Eesti delegatsiooni moodustamine ” muutmine ” eelnõu esimene lugemine . Ettekande teeb väliskomisjoni liige Imre neutral Eesti Eesti tänase päevakorraga . Esimene päevakorrapunkt on väliskomisjoni esitatud Riigikogu otsuse ” Riigikogu otsuse ” Euroopa Julgeoleku- ja Koostööorganisatsiooni Parlamentaarse Assamblee Eesti delegatsiooni moodustamine ” muutmine ” eelnõu esimene lugemine . Ettekande teeb väliskomisjoni liige Imre Sooäär . Palun ! Aitäh , neutral Skripti väljundiks on fail istung.csv, kus on tabelkujul kohanimeüksus sellisel kujul, nagu see tekstis esineb (tulp kohanime_vorm); kohanimeüksuse algvorm (tulp kohanime_lemma), mitmesõnalise kohanimeüksuse puhul on lemmatiseeritud ainult nimeüksuse viimane sõna (nt Tallinna linn); kontekst ehk 20 sõna kohanimest vasakule ja paremale (tulp kontekst); kontekstile määratud meelsuse hinnang (tulp meelsus). Loeme tabeli Excelisse või muusse tabeltöötlusprogrammi: Data → From Text/CSV → File Origin: UTF-8, Delimiter: Tab → Transform Data → vajuta Use First Row as Headers → Close &amp; Load). Hindame nimetuvastuse kvaliteeti. On teada, et automaatne nimetuvastus töötab kõige paremini isikunimede tuvastamisega, kohanimede ja organisatsioonidega on sel rohkem raskusi. Võime andmeid pisut käsitsi puhastada ja korrastada. Kustutame tabelist read, kus nimetuvastus on eksinud (nt Facebook, Euroopa Liit), parandame kohanimede lemmasid (nt pai → Paide). Salvestame Exceli tabeli nimega istung.xlsx. 15.2 Tekstikatkendi meelsuse tuvastamine Excelis EKI emotsioonidetektor on tegelikult kasutatav ka MS Exceli laiendusena (Add-in), ent see ei pruugi uuemates Exceli versioonides alati töötada. Katsetame. Laadime lehelt http://peeter.eki.ee:5000/applications/list alla faili valence.xlam. Otsime Excelist üles File → Options → Add-ins → Manage Excel Add-ins → Go → Browse, otsime üles faili valence.xlam. Kirjutame Excelis tabeli uude tulpa =Valence.TestBayes() ja sulgude vahele lahtri viite, milles on tekst (nt =Valence.TestBayes(C2)). Kontrollime, kas tulemused vastavad Pythoni skriptiga saadud tulemustele. 15.3 Koordinaatide lisamine (geokodeerimine) Nüüd peame saama oma tabelile koordinaadid. Selleks võiksime proovida põhimõtteliselt kasutada ka Maa-ameti geokodeerimise teenust, aga kuna teame, et meie tabelis on palju ka välisriikide kohanimesid, ei oleks sellest väga palju kasu. Katsetame niisiis hoopis QGISi geokodeerijat. Esmalt salvestame xlsx-faili csv-na, nt nimega istung_parandatud.csv. Geokodeerimise jaoks oleks vaja, et faili kodeering oleks UTF-8. Seejärel avame QGISi, otsime sobiva aluskaardi ja CRS-i, laadime csv-faili QGISi, valime Processing → Toolbox → Vector general → Batch Nominatim geocoder, Input layer on csv-faili kiht, mille just laadisime, Address field on kohanime_lemma. Joonis 15.2: Tuvastatud kohanimede geokodeerimine QGISis Nimetame kihi Geocoded ümber nimega istungi_kohad. 15.4 Visualiseerimine Mainimiste arv Vaatame esmalt, milliseid kohti ja kui palju mainiti. Selleks on teatavasti mitu võimalust: muudame punktide läbipaistvust (rohkem mainitud kohad jäävad tumedamalt); valime Symbology jaotises Single symbol asemel Point Cluster või Point Displacement; valime Symbology jaotises Heatmap, valime sobiva värvipaleti ja -skaala. Joonis 15.3: Stenogrammis mainitud kohanimede heatmap Võime ka teha uue kihi, kus loeme kokku, kui mitu korda üht nime mainitakse, ja visualiseerida mainimiste arvu näiteks punkti suuruse abil. Selleks valime Database → DB Manager → SQL Window ja päringu aknasse kirjutame SELECT kohanime_lemma, COUNT(kohanime_lemma) AS arv, geometry FROM istungi_kohad GROUP BY kohanime_lemma; Vajutame Execute, teeme linnukese kasti Load as new layer ette ja vajutame Load. Uuel kihil vajutame Size paremas ääres kastikest, valime Expression → Edit ja kirjutame avaldiseks log10(\"arv\")*10. Logaritmimine vähendab erinevusi suurt arvude vahel ja toob esile erinevusi väiksemate arvude vahel. Emotsioonid Kasutame punktide asemel diagramme, et visualiseerida, kui suur protsent mingi koha mainimistest olid positiivses, negatiivses ja neutraalses kontekstis. Selleks tuleb esmalt teha kiht, kus oleme kokku lugenud iga koha iga emotsiooni mainimiste arvu ja pannud selle eraldi tulpadesse. Database → DB Manager → SQL Window ja päringu aknasse kirjutame SELECT kohanime_lemma, geometry, SUM(CASE WHEN meelsus = &#39;positive&#39; THEN 1 ELSE 0 END) AS positive, SUM(CASE WHEN meelsus = &#39;negative&#39; THEN 1 ELSE 0 END) AS negative, SUM(CASE WHEN meelsus = &#39;neutral&#39; THEN 1 ELSE 0 END) AS neutral FROM istungi_kohad GROUP BY kohanime_lemma; Uue tekkinud kihi Symbology jaotises valime Single symbol asemel No symbols. Lisame pirukadiagrammid (Diagrams → Pie Chart), atribuutideks valime tulbad positive, negative ja neutral, neile kategooriatele valime sobivad värvid, muudame diagrammid veidi läbipaistvamaks (Rendering → Opacity) ja diagrammide suuruseks määrame Scaled size, Attribute väärtuseks \"positive\"+\"negative\"+\"neutral\" ja valime sobiva skaala, arvestades kõige sagedamini mainitud koha mainimiste arvu ja kõige harvemini mainitud kohtade arvu. paneme diagrammid punktide koha peale: Placement → Over point. Joonis 15.4: Positiivsete, negatiivsete ja neutraalsete mainimiste osakaalud Teine variant sama tulemuseni jõudmiseks oleks teha topeltklikk kihil istungi_kohad, kaotada Symbology jaotises ära tavalised punktikesed (No symbols), jaotises Diagrams valida Pie Chart, seal omakorda Attributes jaotises lisada Assignes attributes aknasse kolm avaldist, mis loeksid kokku iga kohanime lemma esinemiskorrad juhul, kui 1) meelsuse tulbas on väärtus positive, 2) meelsuse tulbas on väärtus negative, 3) meelsuse tulbas on väärtus neutral: count(\"kohanime_lemma\", group_by:=\"kohanime_lemma\", filter:=\"meelsus\"='positive') count(\"kohanime_lemma\", group_by:=\"kohanime_lemma\", filter:=\"meelsus\"='negative') count(\"kohanime_lemma\", group_by:=\"kohanime_lemma\", filter:=\"meelsus\"='neutral') diagrammide Size jaotises valida Scaled size → Attribute väärtuseks kirjutada avaldis count(\"kohanime_lemma\", group_by:=\"kohanime_lemma\"), Maximum value määrata Find nupu abil, Size väärtuseks määrata nt 15 ning suurendada ka väikeste diagrammide suurust (nt 2 peale). Sellisel juhul aga tuleb iga muudatust tehes (nt sektorite värvi, diagrammide suurust, läbipaistvust vm-d muutes) diagrammide aluseks olevad andmed iga kord uuesti genereerida ning seetõttu võtab muudatuste nägemine kauem aega. Määrame lõpuks ka kohanimedele sildid, mis tuleksid nähtavale alles siis, kui oleme piisavalt sisse suuminud. Symbology → Labels → Single labels → Rendering → Scale Dependent Visibility. Vali ka Overlapping labels → Allow Overlaps without Penalty. 15.5 Järgmisel korral Geostatistika. "],["geostatistika1.html", "Praktikum 16 Geostatistika (1) 16.1 Punktimustri analüüs 16.2 Ülesanne 1 16.3 Graphical Modeler 16.4 Ruumiline vastastikmõju 16.5 Ülesanne 2 16.6 Klasterdamine 16.7 Järgmisel korral", " Praktikum 16 Geostatistika (1) “Everything is related to everything else, but near things are more related than distant things.” (Waldo Tobler, 1970). 16.1 Punktimustri analüüs Punktimustri analüüsi näol on tegemist statistiliste meetodite kogumiga, mille abil saab uurida ruumilisi (keerukaid) suhteid nähtuste vahel, mida on kujutatud punktidena. Näiteks asustusüksused maastikul või mingi info (nt pärimus, keel, ilm) kogumiskoht. Kuigi sageli on punktidega kaasas ka täiendavat infot, mis punkti iseloomustab (nt jutustuse liik, keelend, temperatuur), siis võib meid huvitada puhtalt ka punktide jaotumine ruumis. Arheoloogias on selliseid meetodeid kasutatud juba alates 1960. aastatest, kui hakati rohkem tegelema kvantitatiivsete meetoditega. Näiteks on uuritud leidude paiknemist asulates, hoonetes ja matusekohtades ning linnamägesid maastikul. GISi kasutuselevõtmine lihtsustas oluliselt nende analüüside tegemist. 16.1.1 Punktitihedus Lihtne viis punktide jaotumise formaalseks hindamiseks on mõõta nende paiknemistihedust mingis kindlas piirkonnas. Seda nimetatakse ka esimese järgu ruumiliseks intensiivsuseks (first-order spatial intensity). Lihtsaim tulemus keskmise intensiivsuse väljendamiseks võib olla arv, mis näitab oodatavat punktide hulka mingil alal. Vaatame näidet! Alloleval pildil on näha 100 punkti, mis jaotuvad juhuslikult alal, mille mõõtmed on 10 x 10 ühikut ning mis on omakorda jagatud 2 x 2 ruutudeks. Kokku on alal niisiis 25 ruutu. Ühikud ei ole siinkohal tähtsad. Need sõltuvad meie uurimisalast ja -küsimusest ning võivad ulatuda nanomeetrist kilomeetri ja valgusaastani. Esimese asjana võiks küsida, kui palju punkte võiks paikneda ühes ruudus, arvestades et igal ruudul (või muul pindalaühikul) on sama hea võimalus punktide saamiseks. Võiks eeldada, et vastus on 4, kuna 100 / 25 = 4. Joonis 16.1: Punktide juhuslik jaotumine ja võrdlus Poissoni jaotusega (Gillings et al. 2020) Tegelikult järgib punktide juhuslik paiknemine aga teoreetilist Poissoni jaotust, mille kohaselt on mitmes ruudus vähem kui 4 ja üksikutes ruutudes rohkem kui 4 punkti. Täiesti juhuslikult paiknevate punktide jaotuse vaadeldav intensiivsus pindalaühiku kohta peakski järgima Poissoni jaotust. Sellist olukorda nimetatakse täielikuks ruumiliseks juhuslikkuseks (complete spatial randomness – CSR) ja selle jaotuse loonud juhuslikku käitumist nimetatakse Poissoni punkti protsessiks (Poisson point process). Huvi korral vaata Poissoni jaotuse tutvustust näiteks 365 Data Science videost. Võiksime teoreetiliselt ka eeldada, et iga punkt kogu uurimisala ulatuses käitub samamoodi. Pärismaailmas olevad punktid sellisele eeldusele aga sageli ei vasta. Näiteks koonduvad punktid pigem mingisse uurimisala piirkonda ja teistes uurimisala piirkondades on neid hõredalt. Sellisel juhul võib eeldada, et punktide intensiivsust uurimisala erinevates piirkondades mõjutab mingi väline protsess/käitumine. Näiteks võivad külad koonduda mingi kihelkonna põhjaossa, kuna lõunaosas on soo, või parimate riigieksami tulemustega õpilased suurematesse linnadesse, kuna seal on rohkem eliitkoole. Joonis 16.2: Mittehomogeenne jaotumine ja võrdlus Poissoni jaotusega (Gillings et al. 2020) Ülaloleval joonisel on näha selgelt, et punktid koonduvad üles parempoolsesse nurka ning ruudupõhine lugemine näitab, et jaotus ei järgi Poissoni jaotust. Sageli on aga erinevus sellisest juhuslikust homogeensest punktimustrist suhteliselt selge ning me ei peagi seda niimoodi vaatama või testima. Pärismaailmas ongi väga vähe nähtuseid, mis on täielikult juhuslikud. Populaarne meetod esimese järgu intensiivsuse kokkuvõtmiseks on tuumhindamine (Kernel Density Estimation ehk KDE). See on sarnane ruudupõhise lugemisega, aga kindlate ruutude asemel liigub kogu punktidega kaetud alast süsteemselt üle aken ehk kernel ehk tuum. Igas asukohas loetakse kokku punktid, mis jäävad parajasti kerneli alla jäävale alale ja see arv jäädvustatakse kerneli (ajutisse) keskkohta. Tulemuseks on rasterkiht, mille iga piksli väärtus näitab punktimustri hinnangulist intensiivsust selles piirkonnas. Joonis 16.3: KDE tööpõhimõte. Näidatud on 5 andmepunkti, kindla suurusega kernel ning tuletatud KDE KDE puhul on oluline kasutatava akna suurus (kernel bandwidth), mis indikeerib seda, kui suure mõjualaga käitumine punktandmeid tekitas: mida suurem aken, seda kaugemaleulatuvam on ühe punkti mõju. Akna suurus on pisut arbitraarne valik ja üldiselt soovitatakse katsetada mitme erineva suurusega, et saada mustrist parem ettekujutus. Joonis 16.4: KDE tulemus erineva akna suurusega (Gillings et al. 2020) Lisaks akna suurusele mängib pisut rolli ka see, mis kujuga kernel on, indikeerides seda, kui suur mõju kerneli alla jäävatel punktidel mingis kerneli osas on. Näiteks võivad suurema kaalu saada kerneli keskele jäävad punktid (triweight), aga kõikidel punktidel võib olla terves kerneli ulatuses ka ühesugune kaal (uniform). Joonis 16.5: Erinevad kerneli kujud (Brian Amberg, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=5329895) Ehkki vahel võib punktimustri intensiivsust hinnata ka niisama, palja silmaga, peetakse KDE-d oluliseks alguspunktiks punktide jaotumise analüüsimisel, kuna: erinevate kerneli suuruste võrdlemine aitab saada punktimustri jaotumisest selgemat ülevaadet; see aitab mõista olukordi, kus on liiga palju punkte, et lihtsalt peale vaadates midagi nende kohta öelda, või kus punktidel on mingi kaal ning neid ei saa seetõttu võrdsetena käsitleda; see võib olla sisendiks järgmistele, keerukamatele analüüsidele (näiteks mudelitele, kus võrreldakse mittehomogeensete punktimustrite tekkeprotsesse). 16.2 Ülesanne 1 Koostame kultuurimälestiste leviku paremaks mõistmiseks KDE kihid erinevate akna suurustega. Selleks avame Maa-ameti omavalitsuste polügoonikihi omavalitsus.gpkg ja kultuurimälestiste punktikihi malestised.gpkg, valime Processing → Toolbox → Interpolation → Heatmap (Kernel density estimation). Point layer väärtuseks määrame malestised. Raadiuseks võib esialgu panna 20 kilomeetrit (jälgi, et ühik oleks õige!) ning piksli suuruseks 1000x1000 (meetrit). Joonis 16.6: KDE sätted Lõikame tulemuse omavalitsuste piiridesse: Raster → Extraction → Clip raster by mask layer → Input: Heatmap, Mask layer: omavalitsus → Run. Kasutame rastri värvimiseks sobivat värvipaletti ja uurime ka Identify features tööriista abil (Ctrl+Shift+i) funktsiooniga rastri väärtuseid erinevates kohtades. Võrdleme KDE tulemust ka omavalitsustepõhise kultuurimälestiste jaotumisega. Selleks loeme kokku igas KOV-is olevate kultuurimälestiste arvu (nt Vector → Analysis Tools → Count points in polygon). Polügooni kihiks valime omavalitsus ning punktide kihiks malestised. Visualiseerime tekkinud kihti tulba NUMPOINTS abil. Mis on erinevused ja millest need tulevad? Joonis 16.7: Kultuurimälestiste KDE raadiusega 20 km ja piksli suurusega 1000 m ning kultuurimälestised omavalitsuste kaupa KDE heatmap’i algoritmi Quartic kerneli kujuga kasutab ka Symbology jaotise valikus olev heatmap, millega oleme varem kokku puutunud. 16.3 Graphical Modeler Kui soovime samu funktsioone korduvalt järjest kasutada (nt võrrelda tulemusi erinevate kerneli suuruste ja kujudega), siis võime neist ise uue funktsiooni luua, mis kombineerib meile kõik vajaliku. Siinkohal ongi abiks Graphical Modeler. Loome funktsiooni, mis teeb sama, mida eelnevas ülesandes tegime kolme eraldi tegevusena (heatmap, clip, värvimine). Seeläbi saame oluliselt lihtsamini ja kiiremini katsetada heatmap’ide tegemist erinevate väärtustega ning neid omavahel kohe võrrelda. Praegu on meil funktsioonid suhteliselt lihtsad ning neid on ainult kolm, aga keerukamate tegevuste puhul on automatiseerimisest palju kasu. Meie mudel koosneb kolmest osast: Sisendid: mälestised, omavalitsus, raadius, kerneli kuju, stiil Funktsioonid: heatmap, clip, stylize Väljundid: omavalitsuste piiridesse lõigatud värvitud heatmap. Avame graafilise mudeldaja, valides ülamenüüst Processing → Graphical Modeler . Sisendid Sisendite valimiseks valime vasakult Inputs. Punktikihi lisamiseks valime sealt Map Layer. Anname sisendkihile nime (nt punktandmed). Valime tüübiks Vector point. Vaatame, et oleks tehtud linnuke Mandatory ette. Joonis 16.8: Graphical Modeler sisendid Lisame samamoodi omavalitsuste kihi sisendi ja valime sellele kihile õige tüübi. Lisame ka numbrilise sisendi kerneli raadiuse jaoks, valides Inputs → Number. Raadiuse tüüp on täisarv (Integer) ja vaikeväärtus võiks olla 20000 (e 20 km). Lisame mudelisse ka sisendi, millega saame muuta kerneli kuju , valides Inputs → Enum. Rohelisest plussmärgist lisame 5 valitavat väärtust ja nimetame need vastavalt KDE pakutavatele väärtustele: Quartic, Triangular, Uniform, Triweight ja Epanechnikov. Lisame lõpuks sisendi ka stiili jaoks, et kõik väljundid oleksid samasuguse stiiliga. Selleks tuleb aga eelnevalt stiili fail salvestada. Avame varem tehtud heatmap’i jaotise Symbology. Määrame Min väärtuseks 0 ja Max väärtuseks 500, jagame arvuskaala väärtused värvide vahel nii, et iga värv vastaks kindlale väärtuste klassile: Interpolation → Discrete ja Mode → Equal Interval (nt 10 klassiga). Kui on olemas sobiv stiil, siis valime Symbology jaotises alt vasakult Style → Save style. Nüüd läheme tagasi Graphical Modeler’i juurde. Valime Input’i alt File/Folder ning paneme sellele nimeks stiil. Nüüd on kõik viis sisendit olemas. Funktsioonid Esimene funktsioon on heatmap’i tegemine. Valime vasakult Inputs asemel Algorithms → Interpolation → heatmap. Lisame selle mudelisse. Nagu näha, on tegemist sama heatmap’i funktsiooniga, mida varasemalt kasutasime. Siin määrame aga sisendid meie mudelist. Point layer ees klikime ikoonil , valime sealt Value asemel Model input ja kihiks varem tehtud sisendi nimega punktandmed. Radius juures valime mudeli sisendi raadius. Output raster size määrame 1000. Seda ei hakka me sisendiga iga kord muutma. Show advanced parameters alt määrame Kernel shape väärtuseks mudeli sisendi. Nüüd vajutame OK. Nagu näha, lähevad valitud sisendite juurest jooned funktsiooni sisse. Joonis 16.9: Graphical Modeler: heatmap’i algoritmi lisamine Lisame järgmise funktsiooni. Algorithms seast otsime Clip raster by mask layer ja lisame selle mudelisse. Input layer’iks määrame Algorithm output. Valikusse ilmub automaatselt “Heatmap”, kuna see on meie mudelis praegu ainuke algoritm. Mask Layer juures valime Value asemel Model input ja kihiks varem tehtud sisend nimega polügoonid. Clipped (mask) juures sisestame tulemuse nime (nt clipped_heatmap). Lõpuks lisame stiliseerimise funktsiooni. Algorithms seast otsime Set layer style. Lisame selle mudelisse, määrame Layer → Algorithm output ja valime algoritmi “Clipped (mask)”. Style file → Model input → stiil. Joonis 16.10: Graphical Modeler Tulemus Väljund clipped_heatmap on juba automaatselt tekkinud, kuna andsime selle nime lõikamise funktsioonis. Proovime, kas mudel töötab. Valime üleval Model → Run model. Nagu näha, avaneb funktsiooni aken, kus on sisendiks meie määratud valikud. Valime õiged kihid ja jooksutame mudelit. QGISi peaaknasse peaks ilmuma nüüd heatmap, mis on õigetesse piiridesse lõigatud ning etteantud stiiliga värvitud. Salvestame mudeli, paneme sellele nimeks nt heatmap_clipper vms. Nüüd võib Graphical Modeler akna kinni panna. Mudel on nüüd leitav Processing Toolbox’ist (Processing → Toolbox) Models all või on lihtsalt otsitav antud pealkirja järgi. Testime nüüd mudeli abil erinevate raadiustega, millised KDE’d välja tulevad. Olenevalt soovitavast üldistamise tasemest saab valida endale sobiva rastermudeli. 16.4 Ruumiline vastastikmõju Eelnevalt vaatasime punktide jaotuse esimese järgu omadusi, mis kirjeldavad üldist punktide tihedust ning seda, kas intensiivsus on uurimisalas homogeenne või mitte. Nagu eelnevalt öeldud, võib juhtudel, kus ei ole tegemist homogeense jaotumisega, eeldada mingit välist mõju. Tõenäoliselt ei ole suur osa inimtegevusest ja kultuurist ruumis päris suvaline. Punktimustrite uurimise juures on oluline aspekt see, et ühe punkti asumine teatud kohas võib suurendada või vähendada teise punkti asumise tõenäosust selle läheduses. See on punktimustri teise järgu omadus (second-order property). Näiteks pole mõistlik kogu uurimisalas küladel täiesti kõrvuti asuda. Niisiis eeldatakse, et mittehomogeense mustri taga võib olla mingi tõmbav (attraction) või tõukav/peletav (inhibition) protsess. Joonis 16.11: Punktimustrid, kus (a) pole teise järgu efekte, (b) paiknemine on regulaarne ja (c) klasterdunud (Gillings et al. 2020). Lihtne meetod selliste mustrite (esialgseks) uurimiseks on lähima naabri analüüs ehk nearest neighbour analysis (ka Clark and Evans test). Testi käigus arvutatakse iga punkti ja tema lähima naabri vaheline kaugus ning seejärel võrreldakse kõikide nende lähimate naabrite distantside aritmeetilist keskmist eeldatava juhusliku distantsiga sellise punktide arvu ja ala suuruse põhjal. Testi tulemusena saadav r-väärtus ehk nearest neighbour index näitab, et jaotus on juhuslik, kui see on 1 lähedal; regulaarne, kui see on suurem kui 1, ning klasterdunud, kui see on väiksem kui 1. 16.5 Ülesanne 2 Vaatame Tartumaa asustuse punktimustrit. Laadime Moodle’ist alla kihi tartumaa_asustus.gpkg ja avame selle QGISis. Andmestik pärineb Kohanimeregistrist ning selles on igale Tartumaa küla või aleviku nimele lisatud Kohanimeraamatust esmamainimise aasta, kihelkond ning nime etümoloogia. Vaatame andmestiku atribuuttabelit, et näha, millega on tegemist. Esmamainimise aastate tulbast ülevaate saamiseks võib kasutada ülamenüüst funktsiooni View → Statistical summary. Näha on lihtne ülevaade vanimast ja noorimast külast, keskmisest ja enimlevinud esmamainimise aastaarvust jms. Külade vanusest esmase ülevaate saamiseks võib kasutada erinevaid värve iga sajandi jaoks. Seda saab teha Graduated sümboloogia ja Pretty breaks abil. Arvutame nüüd Tartumaa asustuse Nearest Neighbor Index’i iga sajandi kohta või näiteks keskaja ja uusaja kohta. Selleks filtreerime või valime vastavad väärtused. Processing Toolbox otsingusse paneme nearest ja vali sealt Nearest neighbor analysis. Avame analüüsi tulemusena valminud html-faili ning vaatame, milline on indeksi väärtus. Hindame selle järgi, kas punktid asuvad suvaliselt, regulaarselt või klasterdunult. Observed Mean Distance näitab, mis on kahe punktide ja nende lähimate naabrite vaheliste kauguste keskmine, Expected Mean Distance näitab, mis oleks see oodatud keskmine kaugus siis, kui punktide paiknemine oleks juhuslik, The Nearest Neighbor index näitab, kas punktid paiknevad juhuslikult (r = 0: OMD ja EMD on enam-vähem samad), regulaarselt (r &gt; 1, OMD &gt; EMD) või klasterdunult (r &lt; 1, OMD &lt; EMD). Z-Score: kui väärtus &gt; 2, siis on näha statistiliselt olulist regulaarsust, kui väärtus on &lt; -2, on näha statistiliselt olulist klasterdumist. Proovime analüüsida ka kultuurimälestiste paiknemist ja võrrelda näiteks eri tüüpi mälestiste (ajalugu, arheoloogia jne) paiknemist NNI põhjal. 16.6 Klasterdamine K-keskmiste (K-means) klasterdamine on meetod, mille abil jagatakse väärtused (punktid) etteantud arvu gruppidesse ehk klastritesse. Klastritesse jaotumine sõltub sellest, millise klastri keskpunktile vastav punkt kõige lähemal on. Esmalt leitakse niisiis punktide üldise jaotumise järgi (vahel ka täiesti suvaliselt) klastrite keskpunktid, seejärel seostatakse kõik muud punktid lähima keskpunktiga. Siis arvutatakse uued keskpunktide asukohad ja leitakse sellised punktid, mille lähimaks keskpunktiks ei ole enam selle klastri keskpunkt, milles punkt asub. Kui selliseid punkte leidub, siis korratakse punktide klastritesse jagamist. Proovime selle läbi. Laadime QGISi kihelkondade vektorkihi ja Saaremaa asustusüksuste vektorkihi. Jagame Saaremaa asustusüksused sama paljudeks klastriteks, kui on Saaremaal kihelkondi. Processing → Toolbox → Vector analysis → K-means clustering. Vaatame, kas lihtsalt distantsipõhine külade jaotamine gruppidesse kattub kihelkondadega. Sama võiks teha näiteks taludega ja võrrelda küladesse jaotumist. Selle põhjal omakorda võiks uurida edasi, kas inimestevaheline suhtlus toimib (või ajalooliselt toimis) pigem ühe küla/kihelkonna piirides või tõenäolisemalt üle küla/kihelkonna piiride, millised on/olid sotsiaalsed võrgustikud jne. Joonis 16.12: Saaremaa külade jaotumine klastriteks Teiste lihtsamate statistiliste meetodite kasutamise kohta vektorandmetega (nt lähikeskuste leidmine jm) saad lugeda siit. 16.7 Järgmisel korral Veel geostatistikat (ruumiline interpoleerimine vastavalt andmestiku tunnusele). "],["kirjandus.html", "Kirjandus", " Kirjandus "]]
