<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Praktikum 13 Ruumiandmete analüüs R-iga | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes</title>
  <meta name="description" content="Praktikum 13 Ruumiandmete analüüs R-iga | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Praktikum 13 Ruumiandmete analüüs R-iga | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Praktikum 13 Ruumiandmete analüüs R-iga | HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes" />
  
  
  

<meta name="author" content="Maarja-Liisa Pilvik" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="veebirakendused.html"/>
<link rel="next" href="kirjandus.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<link href="libs/leaflet-measure-2.1.7/leaflet-measure.css" rel="stylesheet" />
<script src="libs/leaflet-measure-2.1.7/leaflet-measure.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Sissejuhatus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#kursuse-korraldusest"><i class="fa fa-check"></i><b>1.1</b> Kursuse korraldusest</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#mis-on-geoinfosüsteemid"><i class="fa fa-check"></i><b>1.2</b> Mis on geoinfosüsteemid?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#geoinfosüsteemide-ajaloost"><i class="fa fa-check"></i><b>1.3</b> Geoinfosüsteemide ajaloost</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#ruumiandmed-ja-gis-humanitaarteadustes"><i class="fa fa-check"></i><b>1.4</b> Ruumiandmed ja GIS humanitaarteadustes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#lugude-jutustamine"><i class="fa fa-check"></i><b>1.4.1</b> Lugude jutustamine</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#arheoloogia"><i class="fa fa-check"></i><b>1.4.2</b> Arheoloogia</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#keeleteadus"><i class="fa fa-check"></i><b>1.4.3</b> Keeleteadus</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#keele-sotsiaalteadus"><i class="fa fa-check"></i><b>1.4.4</b> Keele-/sotsiaalteadus</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#veel-näiteid"><i class="fa fa-check"></i><b>1.4.5</b> Veel näiteid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html"><i class="fa fa-check"></i><b>2</b> Ruumiobjektid ja ruumiandmed</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#vektorandmed"><i class="fa fa-check"></i><b>2.1</b> Vektorandmed</a></li>
<li class="chapter" data-level="2.2" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#rasterandmed"><i class="fa fa-check"></i><b>2.2</b> Rasterandmed</a></li>
<li class="chapter" data-level="2.3" data-path="ruumiobjektid.html"><a href="ruumiobjektid.html#vektor-vs.-raster"><i class="fa fa-check"></i><b>2.3</b> Vektor vs. raster</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="kaardid.html"><a href="kaardid.html"><i class="fa fa-check"></i><b>3</b> Kaardid, koordinaatsüsteemid ja projektsioonid</a>
<ul>
<li class="chapter" data-level="3.1" data-path="kaardid.html"><a href="kaardid.html#kaart"><i class="fa fa-check"></i><b>3.1</b> Kaart</a></li>
<li class="chapter" data-level="3.2" data-path="kaardid.html"><a href="kaardid.html#kaardi-elemendid"><i class="fa fa-check"></i><b>3.2</b> Kaardi elemendid</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="kaardid.html"><a href="kaardid.html#mootkava"><i class="fa fa-check"></i><b>3.2.1</b> Mõõtkava</a></li>
<li class="chapter" data-level="3.2.2" data-path="kaardid.html"><a href="kaardid.html#projektsioon"><i class="fa fa-check"></i><b>3.2.2</b> Koordinaatsüsteemid ja projektsioonid</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="kaardid.html"><a href="kaardid.html#kaartide-liigitus"><i class="fa fa-check"></i><b>3.3</b> Kaartide liigitus</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="kaardid.html"><a href="kaardid.html#digitaalkaardid"><i class="fa fa-check"></i><b>3.3.1</b> Digitaalkaardid</a></li>
<li class="chapter" data-level="3.3.2" data-path="kaardid.html"><a href="kaardid.html#viguriga-kaardid"><i class="fa fa-check"></i><b>3.3.2</b> Viguriga kaardid</a></li>
<li class="chapter" data-level="3.3.3" data-path="kaardid.html"><a href="kaardid.html#ülesanne"><i class="fa fa-check"></i><b>3.3.3</b> Ülesanne</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="kaardid.html"><a href="kaardid.html#kaartide-koostamine-ja-kujundamine-veebis"><i class="fa fa-check"></i><b>3.4</b> Kaartide koostamine ja kujundamine veebis</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="kaardid.html"><a href="kaardid.html#arcgis-online"><i class="fa fa-check"></i><b>3.4.1</b> ArcGIS Online</a></li>
<li class="chapter" data-level="3.4.2" data-path="kaardid.html"><a href="kaardid.html#mapbox-studio"><i class="fa fa-check"></i><b>3.4.2</b> Mapbox Studio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="storymaps.html"><a href="storymaps.html"><i class="fa fa-check"></i><b>4</b> Story maps</a>
<ul>
<li class="chapter" data-level="4.1" data-path="storymaps.html"><a href="storymaps.html#story-maps"><i class="fa fa-check"></i><b>4.1</b> Story maps</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="storymaps.html"><a href="storymaps.html#storymapjs"><i class="fa fa-check"></i><b>4.1.1</b> StoryMapJS</a></li>
<li class="chapter" data-level="4.1.2" data-path="storymaps.html"><a href="storymaps.html#arcgis-storymaps"><i class="fa fa-check"></i><b>4.1.2</b> ArcGIS StoryMaps</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="storymaps.html"><a href="storymaps.html#ülesanne-tänane-kuupäev-story-mapis"><i class="fa fa-check"></i><b>4.2</b> Ülesanne: tänane kuupäev <em>story map</em>’is</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="qgis.html"><a href="qgis.html"><i class="fa fa-check"></i><b>5</b> Sissejuhatus QGISi</a>
<ul>
<li class="chapter" data-level="5.1" data-path="qgis.html"><a href="qgis.html#installimine-ja-seadistamine"><i class="fa fa-check"></i><b>5.1</b> Installimine ja seadistamine</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="qgis.html"><a href="qgis.html#kasutajaliidese-keel"><i class="fa fa-check"></i><b>5.1.1</b> Kasutajaliidese keel</a></li>
<li class="chapter" data-level="5.1.2" data-path="qgis.html"><a href="qgis.html#vaikimisi-koordinaatide-referentssüsteem"><i class="fa fa-check"></i><b>5.1.2</b> Vaikimisi koordinaatide referentssüsteem</a></li>
<li class="chapter" data-level="5.1.3" data-path="qgis.html"><a href="qgis.html#paneelid-ja-tööriistad"><i class="fa fa-check"></i><b>5.1.3</b> Paneelid ja tööriistad</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="qgis.html"><a href="qgis.html#aluskaardid"><i class="fa fa-check"></i><b>5.2</b> Aluskaardid</a></li>
<li class="chapter" data-level="5.3" data-path="qgis.html"><a href="qgis.html#andmete-avamine"><i class="fa fa-check"></i><b>5.3</b> Andmete avamine</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="qgis.html"><a href="qgis.html#rasterandmed-1"><i class="fa fa-check"></i><b>5.3.1</b> Rasterandmed</a></li>
<li class="chapter" data-level="5.3.2" data-path="qgis.html"><a href="qgis.html#vektorandmed-1"><i class="fa fa-check"></i><b>5.3.2</b> Vektorandmed</a></li>
<li class="chapter" data-level="5.3.3" data-path="qgis.html"><a href="qgis.html#andmete-sisselugemine-csv-failist"><i class="fa fa-check"></i><b>5.3.3</b> Andmete sisselugemine CSV-failist</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="qgis.html"><a href="qgis.html#andmete-visualiseerimine"><i class="fa fa-check"></i><b>5.4</b> Andmete visualiseerimine</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="qgis.html"><a href="qgis.html#harjutus-1"><i class="fa fa-check"></i><b>5.4.1</b> Harjutus 1</a></li>
<li class="chapter" data-level="5.4.2" data-path="qgis.html"><a href="qgis.html#sildid"><i class="fa fa-check"></i><b>5.4.2</b> Sildid</a></li>
<li class="chapter" data-level="5.4.3" data-path="qgis.html"><a href="qgis.html#harjutus-2"><i class="fa fa-check"></i><b>5.4.3</b> Harjutus 2</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="qgis.html"><a href="qgis.html#kaartide-eksportimine"><i class="fa fa-check"></i><b>5.5</b> Kaartide eksportimine</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="avaandmed.html"><a href="avaandmed.html"><i class="fa fa-check"></i><b>6</b> Avaandmed ja repositooriumid. Andmekihtide ühendamine</a>
<ul>
<li class="chapter" data-level="6.1" data-path="avaandmed.html"><a href="avaandmed.html#avaandmed-1"><i class="fa fa-check"></i><b>6.1</b> Avaandmed</a></li>
<li class="chapter" data-level="6.2" data-path="avaandmed.html"><a href="avaandmed.html#eesti-ruumiandmed"><i class="fa fa-check"></i><b>6.2</b> Eesti ruumiandmed</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="avaandmed.html"><a href="avaandmed.html#maa-ameti-geoportaal"><i class="fa fa-check"></i><b>6.2.1</b> Maa-ameti geoportaal</a></li>
<li class="chapter" data-level="6.2.2" data-path="avaandmed.html"><a href="avaandmed.html#statistikaamet"><i class="fa fa-check"></i><b>6.2.2</b> Statistikaamet</a></li>
<li class="chapter" data-level="6.2.3" data-path="avaandmed.html"><a href="avaandmed.html#muu"><i class="fa fa-check"></i><b>6.2.3</b> Muu</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="avaandmed.html"><a href="avaandmed.html#muudriigid"><i class="fa fa-check"></i><b>6.3</b> Muude riikide ruumiandmed</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="avaandmed.html"><a href="avaandmed.html#harjutus"><i class="fa fa-check"></i><b>6.3.1</b> Harjutus</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="avaandmed.html"><a href="avaandmed.html#andmestike-ühendamine"><i class="fa fa-check"></i><b>6.4</b> Andmestike ühendamine</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="avaandmed.html"><a href="avaandmed.html#ühendamine-ühise-tunnuse-järgi"><i class="fa fa-check"></i><b>6.4.1</b> Ühendamine ühise tunnuse järgi</a></li>
<li class="chapter" data-level="6.4.2" data-path="avaandmed.html"><a href="avaandmed.html#geokodeerimine"><i class="fa fa-check"></i><b>6.4.2</b> Geokodeerimine</a></li>
<li class="chapter" data-level="6.4.3" data-path="avaandmed.html"><a href="avaandmed.html#ühendamine-ruumiinfo-järgi"><i class="fa fa-check"></i><b>6.4.3</b> Ühendamine ruumiinfo järgi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="georefereerimine.html"><a href="georefereerimine.html"><i class="fa fa-check"></i><b>7</b> Georefereerimine</a>
<ul>
<li class="chapter" data-level="7.1" data-path="georefereerimine.html"><a href="georefereerimine.html#kaartide-otsimine-ja-allalaadimine"><i class="fa fa-check"></i><b>7.1</b> Kaartide otsimine ja allalaadimine</a></li>
<li class="chapter" data-level="7.2" data-path="georefereerimine.html"><a href="georefereerimine.html#harjutus-1-vana-tartu-kaardi-georefereerimine"><i class="fa fa-check"></i><b>7.2</b> Harjutus 1: vana Tartu kaardi georefereerimine</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="georefereerimine.html"><a href="georefereerimine.html#avame-kaardi-pildifaili"><i class="fa fa-check"></i><b>7.2.1</b> Avame kaardi pildifaili</a></li>
<li class="chapter" data-level="7.2.2" data-path="georefereerimine.html"><a href="georefereerimine.html#lisame-aluskaardi"><i class="fa fa-check"></i><b>7.2.2</b> Lisame aluskaardi</a></li>
<li class="chapter" data-level="7.2.3" data-path="georefereerimine.html"><a href="georefereerimine.html#georefereerime-kaardi"><i class="fa fa-check"></i><b>7.2.3</b> Georefereerime kaardi</a></li>
<li class="chapter" data-level="7.2.4" data-path="georefereerimine.html"><a href="georefereerimine.html#lõikame-kaardist-välja-ainult-vanalinna-osa"><i class="fa fa-check"></i><b>7.2.4</b> Lõikame kaardist välja ainult vanalinna osa</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="georefereerimine.html"><a href="georefereerimine.html#harjutus-2-ajalooline-maakasutus-jägala-mõisa-külades"><i class="fa fa-check"></i><b>7.3</b> Harjutus 2: ajalooline maakasutus Jägala mõisa külades</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="georefereerimine.html"><a href="georefereerimine.html#kaardi-georefereerimine"><i class="fa fa-check"></i><b>7.3.1</b> Kaardi georefereerimine</a></li>
<li class="chapter" data-level="7.3.2" data-path="georefereerimine.html"><a href="georefereerimine.html#digiteerimine"><i class="fa fa-check"></i><b>7.3.2</b> Digiteerimine</a></li>
<li class="chapter" data-level="7.3.3" data-path="georefereerimine.html"><a href="georefereerimine.html#pindalade-arvutamine"><i class="fa fa-check"></i><b>7.3.3</b> Pindalade arvutamine</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="georefereerimine.html"><a href="georefereerimine.html#harjutus-3-käsikirjalise-kaardi-georefereerimine"><i class="fa fa-check"></i><b>7.4</b> Harjutus 3: käsikirjalise kaardi georefereerimine</a></li>
<li class="chapter" data-level="7.5" data-path="georefereerimine.html"><a href="georefereerimine.html#veebilahendus"><i class="fa fa-check"></i><b>7.5</b> Veebilahendus</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="avaldised.html"><a href="avaldised.html"><i class="fa fa-check"></i><b>8</b> Avaldised ja päringud</a>
<ul>
<li class="chapter" data-level="8.1" data-path="avaldised.html"><a href="avaldised.html#andmed"><i class="fa fa-check"></i><b>8.1</b> Andmed</a></li>
<li class="chapter" data-level="8.2" data-path="avaldised.html"><a href="avaldised.html#avaldised-1"><i class="fa fa-check"></i><b>8.2</b> Avaldised</a></li>
<li class="chapter" data-level="8.3" data-path="avaldised.html"><a href="avaldised.html#harjutused-avaldistega"><i class="fa fa-check"></i><b>8.3</b> Harjutused avaldistega</a>
<ul>
<li class="chapter" data-level="" data-path="avaldised.html"><a href="avaldised.html#harjutus-1-operaatorid-objektide-valimiseks"><i class="fa fa-check"></i>Harjutus 1: operaatorid objektide valimiseks</a></li>
<li class="chapter" data-level="" data-path="avaldised.html"><a href="avaldised.html#harjutus-2-tingimuslaused-uute-atribuutidetunnuste-loomiseks"><i class="fa fa-check"></i>Harjutus 2: tingimuslaused uute atribuutide/tunnuste loomiseks</a></li>
<li class="chapter" data-level="" data-path="avaldised.html"><a href="avaldised.html#harjutus-3-tekstiavaldised-sümbolite-kujundamiseks-1"><i class="fa fa-check"></i>Harjutus 3: tekstiavaldised sümbolite kujundamiseks (1)</a></li>
<li class="chapter" data-level="" data-path="avaldised.html"><a href="avaldised.html#harjutus-4-tekstiavaldised-sümbolite-kujundamiseks-2"><i class="fa fa-check"></i>Harjutus 4: tekstiavaldised sümbolite kujundamiseks (2)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="avaldised.html"><a href="avaldised.html#päringud"><i class="fa fa-check"></i><b>8.4</b> Päringud</a></li>
<li class="chapter" data-level="8.5" data-path="avaldised.html"><a href="avaldised.html#harjutus-päringutega"><i class="fa fa-check"></i><b>8.5</b> Harjutus päringutega</a></li>
<li class="chapter" data-level="8.6" data-path="avaldised.html"><a href="avaldised.html#ülesanded"><i class="fa fa-check"></i><b>8.6</b> Ülesanded</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="avaldised.html"><a href="avaldised.html#kontrollikihelkondi"><i class="fa fa-check"></i><b>8.6.1</b> Ülesanne 1: “ei ole”/“pole” suhtelised sagedused murdekorpuses</a></li>
<li class="chapter" data-level="8.6.2" data-path="avaldised.html"><a href="avaldised.html#ülesanne-2-ei-olepole-murdeatlase-levikuandmed"><i class="fa fa-check"></i><b>8.6.2</b> Ülesanne 2: “ei ole”/“pole” murdeatlase levikuandmed</a></li>
<li class="chapter" data-level="8.6.3" data-path="avaldised.html"><a href="avaldised.html#ülesanne-3-ei-olepole-selged-eelistused"><i class="fa fa-check"></i><b>8.6.3</b> Ülesanne 3: “ei ole”/“pole” selged eelistused</a></li>
<li class="chapter" data-level="8.6.4" data-path="avaldised.html"><a href="avaldised.html#ülesanne-4-tekstiatribuutide-muutmine"><i class="fa fa-check"></i><b>8.6.4</b> Ülesanne 4: tekstiatribuutide muutmine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tekstianalyys.html"><a href="tekstianalyys.html"><i class="fa fa-check"></i><b>9</b> Geograafiline tekstianalüüs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tekstianalyys.html"><a href="tekstianalyys.html#sammud"><i class="fa fa-check"></i><b>9.1</b> Sammud</a></li>
<li class="chapter" data-level="9.2" data-path="tekstianalyys.html"><a href="tekstianalyys.html#ressursid"><i class="fa fa-check"></i><b>9.2</b> Ressursid</a></li>
<li class="chapter" data-level="9.3" data-path="tekstianalyys.html"><a href="tekstianalyys.html#eesti-keele-geoparsimine"><i class="fa fa-check"></i><b>9.3</b> Eesti keele geoparsimine</a></li>
<li class="chapter" data-level="9.4" data-path="tekstianalyys.html"><a href="tekstianalyys.html#harjutus-3"><i class="fa fa-check"></i><b>9.4</b> Harjutus</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="tekstianalyys.html"><a href="tekstianalyys.html#kohanimeüksuste-tuvastamine-ja-tekstikatkendite-meelsuse-tuvastamine"><i class="fa fa-check"></i><b>9.4.1</b> Kohanimeüksuste tuvastamine ja tekstikatkendite meelsuse tuvastamine</a></li>
<li class="chapter" data-level="9.4.2" data-path="tekstianalyys.html"><a href="tekstianalyys.html#tekstikatkendi-meelsuse-tuvastamine-excelis"><i class="fa fa-check"></i><b>9.4.2</b> Tekstikatkendi meelsuse tuvastamine Excelis</a></li>
<li class="chapter" data-level="9.4.3" data-path="tekstianalyys.html"><a href="tekstianalyys.html#koordinaatide-lisamine-geokodeerimine"><i class="fa fa-check"></i><b>9.4.3</b> Koordinaatide lisamine (geokodeerimine)</a></li>
<li class="chapter" data-level="9.4.4" data-path="tekstianalyys.html"><a href="tekstianalyys.html#visualiseerimine"><i class="fa fa-check"></i><b>9.4.4</b> Visualiseerimine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="geostatistika1.html"><a href="geostatistika1.html"><i class="fa fa-check"></i><b>10</b> Geostatistika (1)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="geostatistika1.html"><a href="geostatistika1.html#punktimustri-analüüs"><i class="fa fa-check"></i><b>10.1</b> Punktimustri analüüs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="geostatistika1.html"><a href="geostatistika1.html#punktitihedus"><i class="fa fa-check"></i><b>10.1.1</b> Punktitihedus</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="geostatistika1.html"><a href="geostatistika1.html#ülesanne-1"><i class="fa fa-check"></i><b>10.2</b> Ülesanne 1</a></li>
<li class="chapter" data-level="10.3" data-path="geostatistika1.html"><a href="geostatistika1.html#model-designer"><i class="fa fa-check"></i><b>10.3</b> Model Designer</a>
<ul>
<li class="chapter" data-level="" data-path="geostatistika1.html"><a href="geostatistika1.html#sisendid"><i class="fa fa-check"></i>Sisendid</a></li>
<li class="chapter" data-level="" data-path="geostatistika1.html"><a href="geostatistika1.html#funktsioonid"><i class="fa fa-check"></i>Funktsioonid</a></li>
<li class="chapter" data-level="" data-path="geostatistika1.html"><a href="geostatistika1.html#tulemus"><i class="fa fa-check"></i>Tulemus</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="geostatistika1.html"><a href="geostatistika1.html#ruumiline-vastastikmõju"><i class="fa fa-check"></i><b>10.4</b> Ruumiline vastastikmõju</a></li>
<li class="chapter" data-level="10.5" data-path="geostatistika1.html"><a href="geostatistika1.html#ülesanne-2"><i class="fa fa-check"></i><b>10.5</b> Ülesanne 2</a></li>
<li class="chapter" data-level="10.6" data-path="geostatistika1.html"><a href="geostatistika1.html#klasterdamine"><i class="fa fa-check"></i><b>10.6</b> Klasterdamine</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geostatistika2.html"><a href="geostatistika2.html"><i class="fa fa-check"></i><b>11</b> Geostatistika (2)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geostatistika2.html"><a href="geostatistika2.html#interpoleerimine"><i class="fa fa-check"></i><b>11.1</b> Interpoleerimine</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geostatistika2.html"><a href="geostatistika2.html#distantsi-kaaluv-interpoleerimine"><i class="fa fa-check"></i><b>11.1.1</b> Distantsi kaaluv interpoleerimine</a></li>
<li class="chapter" data-level="11.1.2" data-path="geostatistika2.html"><a href="geostatistika2.html#ülesanne-1-1"><i class="fa fa-check"></i><b>11.1.2</b> Ülesanne 1</a></li>
<li class="chapter" data-level="11.1.3" data-path="geostatistika2.html"><a href="geostatistika2.html#splain-spline"><i class="fa fa-check"></i><b>11.1.3</b> Splain (<em>Spline</em>)</a></li>
<li class="chapter" data-level="11.1.4" data-path="geostatistika2.html"><a href="geostatistika2.html#ülesanne-2-1"><i class="fa fa-check"></i><b>11.1.4</b> Ülesanne 2</a></li>
<li class="chapter" data-level="11.1.5" data-path="geostatistika2.html"><a href="geostatistika2.html#ülesanne-3"><i class="fa fa-check"></i><b>11.1.5</b> Ülesanne 3</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geostatistika2.html"><a href="geostatistika2.html#voronoi-polügoonid"><i class="fa fa-check"></i><b>11.2</b> Voronoi polügoonid</a></li>
<li class="chapter" data-level="11.3" data-path="geostatistika2.html"><a href="geostatistika2.html#muud-meetodid"><i class="fa fa-check"></i><b>11.3</b> Muud meetodid</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="veebirakendused.html"><a href="veebirakendused.html"><i class="fa fa-check"></i><b>12</b> Veebirakendused, veebimajutus</a>
<ul>
<li class="chapter" data-level="12.1" data-path="veebirakendused.html"><a href="veebirakendused.html#kaardikihid-qgisis"><i class="fa fa-check"></i><b>12.1</b> Kaardikihid QGISis</a></li>
<li class="chapter" data-level="12.2" data-path="veebirakendused.html"><a href="veebirakendused.html#veebikaartide-tegemine"><i class="fa fa-check"></i><b>12.2</b> Veebikaartide tegemine</a></li>
<li class="chapter" data-level="12.3" data-path="veebirakendused.html"><a href="veebirakendused.html#ülesanne-4"><i class="fa fa-check"></i><b>12.3</b> Ülesanne</a></li>
<li class="chapter" data-level="12.4" data-path="veebirakendused.html"><a href="veebirakendused.html#veebikaartide-majutamine-ja-jagamine"><i class="fa fa-check"></i><b>12.4</b> Veebikaartide majutamine ja jagamine</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="veebirakendused.html"><a href="veebirakendused.html#ülikooli-võrguketas"><i class="fa fa-check"></i><b>12.4.1</b> Ülikooli võrguketas</a></li>
<li class="chapter" data-level="12.4.2" data-path="veebirakendused.html"><a href="veebirakendused.html#github-pages"><i class="fa fa-check"></i><b>12.4.2</b> GitHub Pages</a></li>
<li class="chapter" data-level="12.4.3" data-path="veebirakendused.html"><a href="veebirakendused.html#muud-veebimajutusteenused"><i class="fa fa-check"></i><b>12.4.3</b> Muud veebimajutusteenused</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="veebirakendused.html"><a href="veebirakendused.html#lisa-ajatelje-kasutamine-qgisis"><i class="fa fa-check"></i><b>12.5</b> LISA: ajatelje kasutamine QGISis</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>13</b> Ruumiandmete analüüs R-iga</a>
<ul>
<li class="chapter" data-level="13.1" data-path="r.html"><a href="r.html#miks-teha-kaarte-koodipõhiselt"><i class="fa fa-check"></i><b>13.1</b> Miks teha kaarte koodipõhiselt?</a></li>
<li class="chapter" data-level="13.2" data-path="r.html"><a href="r.html#r-rstudio-ja-r-markdown"><i class="fa fa-check"></i><b>13.2</b> R, RStudio ja R Markdown</a></li>
<li class="chapter" data-level="13.3" data-path="r.html"><a href="r.html#pakettide-installimine-ja-töökataloogi-seadistamine"><i class="fa fa-check"></i><b>13.3</b> Pakettide installimine ja töökataloogi seadistamine</a></li>
<li class="chapter" data-level="13.4" data-path="r.html"><a href="r.html#kood"><i class="fa fa-check"></i><b>13.4</b> Kood</a></li>
<li class="chapter" data-level="13.5" data-path="r.html"><a href="r.html#andmete-sisselugemine"><i class="fa fa-check"></i><b>13.5</b> Andmete sisselugemine</a></li>
<li class="chapter" data-level="13.6" data-path="r.html"><a href="r.html#kaartide-tegemine"><i class="fa fa-check"></i><b>13.6</b> Kaartide tegemine</a></li>
<li class="chapter" data-level="13.7" data-path="r.html"><a href="r.html#andmete-valimine"><i class="fa fa-check"></i><b>13.7</b> Andmete valimine</a></li>
<li class="chapter" data-level="13.8" data-path="r.html"><a href="r.html#andmestike-ühendamine-1"><i class="fa fa-check"></i><b>13.8</b> Andmestike ühendamine</a></li>
<li class="chapter" data-level="13.9" data-path="r.html"><a href="r.html#jooniste-eksportimine"><i class="fa fa-check"></i><b>13.9</b> Jooniste eksportimine</a></li>
<li class="chapter" data-level="13.10" data-path="r.html"><a href="r.html#ülesanne-5"><i class="fa fa-check"></i><b>13.10</b> Ülesanne</a></li>
<li class="chapter" data-level="13.11" data-path="r.html"><a href="r.html#r-i-raamatud-ja-juhendid"><i class="fa fa-check"></i><b>13.11</b> R-i raamatud ja juhendid</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kirjandus.html"><a href="kirjandus.html"><i class="fa fa-check"></i>Kirjandus</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HVHV.00.001 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Praktikum 13</span> Ruumiandmete analüüs R-iga<a href="r.html#r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="miks-teha-kaarte-koodipõhiselt" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Miks teha kaarte koodipõhiselt?<a href="r.html#miks-teha-kaarte-koodipõhiselt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Miks teha midagi koodipõhiselt, kui saame (võrdlemisi) samasuguseid kaarte teha ka QGISis või mõnes veebirakenduses?</p>
<p>Erinevalt nn <em>osuta-ja-klõpsa</em> tarkvaradest, kus andmete analüüs toimub puhtalt programmi kasutajaliidese erinevate vidinatega suheldes ja kindlas järjekorras kuskil ikoonidel klõpsides, jääb koodi kirjutades selge jälg sellest, mida, mis järjekorras ja kuidas tehti. See aitab nii endal kui ka teistel paremini mõista, kuidas mingi konkreetse tulemuseni jõuti.<br />
Ühtlasi võib kood tööprotsesse oluliselt lihtsustada ja kiirendada, eriti juhtudel, kus andmed võivad vahepeal muutuda või tuleb teha korduvalt sarnaseid asju. Kujutame ette näiteks olukorda, kus tegime lõputöö või publikatsiooni jaoks kaardi ning kuu aega hiljem palub juhendaja või toimetaja paari detaili kaardil muuta, ülejäänud kaart aga peaks jääma täpselt samaks. Samas oleme vahepeal enda ruumiandmetega väga palju edasi tegelenud. Millised olid täpselt kasutatud andmed, värvid, joone paksus, mõõtkava, mudeldamiseks kasutatud meetod jm? Koodis on see info kõik olemas ja see toimib sellisel juhul kui täpne “retsept” sellest, kuidas esimesel korral oma kaardini jõudsime. Niisiis pole tarvis kogu kaarditegemise protsessi uuesti läbi teha, vaid muuta koodis ära vaid vajalikud detailid.</p>
</div>
<div id="r-rstudio-ja-r-markdown" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> R, RStudio ja R Markdown<a href="r.html#r-rstudio-ja-r-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Meie kasutame siin kursusel R-i versiooni <strong>4.4.1</strong> ja RStudio versiooni <strong>2024.04.2</strong>, aga töötavad ka nendest pisut vanemad ja ka päris uued versioonid. Lisaks neile võiksid Windowsi kasutajad enda arvutisse installida ka programmi <a href="https://cran.r-project.org/bin/windows/Rtools/">RTools</a>.<br />
Kui sa programme enda arvutisse installida ei taha või ei saa, võib TÜ arvutivõrgus olles kasutada oma ülikooli kasutajakontoga RStudiot ka veebi vahendusel: <strong><a href="https://rstudio.hpc.ut.ee" class="uri">https://rstudio.hpc.ut.ee</a></strong>. Kui pakettide installimine allpool ei õnnestu, võid kasutada ka <a href="https://colab.research.google.com/drive/17qt-HT9_x5D-O4Yvw69MBdQ60INyFJ5k?usp=sharing">Google Colabi</a> (vali <em>Runtime</em> -&gt; <em>Change runtime type</em> -&gt; R).</p>
<p><a href="https://www.r-project.org/"><strong>R</strong></a> on vabavaraline väga võimas programmeerimiskeel ja rakendustarkvara andmeanalüüsiks, statistilisteks arvutusteks ning andmete visualiseerimiseks. R pakub väga palju statistilisi ja graafilisi meetodeid ning täieneb pidevalt uute tööriistade ja funktsioonidega. Üks R-i tugevaid külgi on just võimalus teha kõrge kvaliteediga jooniseid ja graafikuid. Kuna tegu on koodipõhise tarkvaraga, siis annab see kasutajatele suhteliselt vabad käed ning võimaldab kontrollida isegi kõige väiksemaid detaile.</p>
<p><strong>Pakettide</strong> (<em>package</em>) eesmärk on lisada mingeid funktsioone. Paljud paketid tulevad R-iga kohe kaasa, aga üldiselt peab neid (eriti spetsiifilisemate ülesannete täitmiseks) juurde installima. Hetkel on R-i kodulehel <a href="https://cran.r-project.org/web/packages/index.html">cran.r-project.org</a> üle 20 100 paketi. Pakett koosneb koodist, andmetest, dokumentatsioonist ja testidest ning seda on lihtne teistega jagada. Ka ruumiandmete analüüsimiseks, andmete töötlemiseks ja visualiseerimiseks on R-is omaette paketid, ehkki põhiosa tavalisest andmetöötlusest saab edukalt teha ka ilma lisapakette installimata.</p>
<p><a href="https://posit.co/downloads/"><strong>RStudio</strong></a> on R-i integreeritud arenduskeskkond (<em>integrated development environment</em> ehk <em>IDE</em>). See koosneb tekstiredaktorist (1), konsoolist (2) ning tööriistadest graafikute kuvamiseks, koodi silumiseks, kogu keskkonna ja ajaloo majandamiseks jpm. RStudiost on nii vabavaraline kui ka kommertsversioon. Meie kasutame vabavaralist.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:20rstudioide"></span>
<img src="imgs/20_rstudio1.png" alt="Rstudio kasutajaliidese peamised osad" width="90%" />
<p class="caption">
Joonis 13.1: Rstudio kasutajaliidese peamised osad
</p>
</div>
<p><strong>1</strong> - skriptiaken. Siia saab kirjutada oma koodi koos kommentaaridega (kommentaari algust tähistavad trellid). Skripti saab salvestada ja teinekord uuesti kasutada (<code>File → Save As</code>). Skriptifaili laiend on <code>.R</code>. Mingi skripti rea jooksutamiseks liigu hiirega sellele reale ja vajuta kas nuppu <img src="imgs/20_rstudio_run.png" /> või vajuta klahvikombinatsiooni <code>Ctrl+Enter</code> (Windowsis) / <code>Cmd+Enter</code> (Macis).<br />
<strong>2</strong> - konsool. Siia kuvatakse kogu jooksutatud skript. Lisaks saab siin ka eraldi koodi jooksutada, mis sel juhul skripti ei salvestu.<br />
<strong>3</strong> - töökeskkond (<code>Environment</code>), käskude ajalugu (<code>History</code>) jm. Töökeskkonnas näed kõiki mingi sessiooni jooksul loodud muutujaid (mingit infot säilitavaid objekte, nt tabeleid) ja funktsioone.<br />
<strong>4</strong> - failid (<code>Files</code>), joonised (<code>Plots</code>), paketid (<code>Packages</code>) jm. Failide all näed neid faile, mis on parasjagu sinu töökataloogis (<em>working directory</em>). Töökataloogi aadressi näed ka konsooli päises.<br />
Lisaks tavalisele <code>.R</code>-laiendiga skriptiformaadile on üha enam kasutusel ka R Markdowni failiformaat (laiendiga <code>.Rmd</code>).<br />
<a href="https://rmarkdown.rstudio.com/"><strong>R Markdown</strong></a> on formaat tavalise teksti ning koodi kombineerimiseks ning võimaldab kirjutada täielikult reprodutseeritavaid artikleid, raamatuid, raporteid ning koostada veebilehti, interaktiivseid lahendusi jpm. Nii see juhend kui ka kogu kursuse materjalid on kirjutatud R Markdownis.</p>
<p>R Markdown koosnebki tavaliselt tekstist nagu see siin.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="r.html#cb8-1" tabindex="-1"></a><span class="co"># Ning kooditükkidest nagu see siin. Kooditükid on Rstudios kolme ` vahel.</span></span>
<span id="cb8-2"><a href="r.html#cb8-2" tabindex="-1"></a><span class="co"># Trellid teksti ees tähistavad kommentaari nagu tavalises R-i skriptifailis </span></span>
<span id="cb8-3"><a href="r.html#cb8-3" tabindex="-1"></a><span class="co"># ning seda koodi jooksutamisel ei arvestata. See on lihtsalt inimesele lugemiseks.</span></span>
<span id="cb8-4"><a href="r.html#cb8-4" tabindex="-1"></a><span class="co"># Kood ise tuleb kirjutada ilma trellideta.</span></span>
<span id="cb8-5"><a href="r.html#cb8-5" tabindex="-1"></a><span class="co"># Näiteks allolev kood salvestab arvu 8 muutujasse nimega &quot;lemmiknumber&quot;.</span></span>
<span id="cb8-6"><a href="r.html#cb8-6" tabindex="-1"></a><span class="co"># Muutuja &quot;lemmiknumber&quot; tekib koodi jooksutamisel ka Environment-jaotisesse.</span></span>
<span id="cb8-7"><a href="r.html#cb8-7" tabindex="-1"></a>lemmiknumber <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb8-8"><a href="r.html#cb8-8" tabindex="-1"></a><span class="co"># Nüüd saame selle arvulise muutujaga teha näiteks liitmis- ja lahutamistehteid</span></span>
<span id="cb8-9"><a href="r.html#cb8-9" tabindex="-1"></a>lemmiknumber<span class="sc">+</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="r.html#cb10-1" tabindex="-1"></a>lemmiknumber<span class="dv">-10</span></span></code></pre></div>
<pre><code>## [1] -2</code></pre>
<p>Igat koodiploki rida võib jooksutada ka eraldi (<code>Ctrl+Enter/Cmd+Enter</code>).<br />
Laadime Moodle’ist alla tänase praktikumi failid, pakime need lahti ning asetame need failid enda selle kursuse kausta. Avame Rstudio ning seal faili <em>ruumiandmed_r.Rmd</em>, valides ülevalt vasakust nurgast <em>File → Open file</em>.</p>
</div>
<div id="pakettide-installimine-ja-töökataloogi-seadistamine" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Pakettide installimine ja töökataloogi seadistamine<a href="r.html#pakettide-installimine-ja-töökataloogi-seadistamine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Kõigepealt installime vajalikud paketid. Selleks jooksutame allolevat koodi. Kui kasutad R-i skripti, siis tuleb allolevad read (ja kõik edaspidised koodiread) lihtsalt skriptiaknasse kopeerida ning neid <code>Ctrl+Enter/Cmd+Enter</code> abil jooksutada. R Markdownis saab koodi jooksutada ja nii, kui klikid koodiploki paremal üleval nurgas rohelisele nupule (<code>Run current chunk</code>). Selle tulemusena tõmbab R kõik vajalikud paketid ja installib need. Sellega võib minna natuke aega. Kui protsess on lõppenud, siis kaob konsooli paremas nurgas väike punane STOP-märk. Kui konsooli trükitakse vahepeal punast teksti, mis ei alga sõnaga <code>Error:</code>, ei tasu selle pärast muretseda. R lihtsalt teavitab sind sellest, millega ta parajasti tegeleb.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="r.html#cb12-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb12-2"><a href="r.html#cb12-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb12-3"><a href="r.html#cb12-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggspatial&quot;</span>)</span></code></pre></div>
<p>Selleks, et installitud pakettide funktsioone kasutama hakata, tuleb need paketid ka laadida. Selleks on käsk <code>library()</code>. Paketid tuleb installida ainult ühe korra, aga laadida tuleb need alati uuesti, kui oled vahepeal Rstudio sulgenud.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="r.html#cb13-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href="r.html#cb13-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb13-3"><a href="r.html#cb13-3" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span></code></pre></div>
<p>Kui paketid on laaditud, siis teeme R Markdowni failis veel ühe väikese muudatuse, et faili vaatamine oleks mugavam. Nimelt ei peaks koodi jooksutamise tulemust kohe siin koodi all näitama. Selleks valime <code>Tools → Global options → R Markdown</code> ning võtame ära linnukese valiku <code>Show output inline for all R Markdown documents</code> eest. Seejärel vajutame all servas <code>OK</code>.</p>
<p>Viimase asjana paneme paika töökataloogi ehk <em>Working directory</em>. Siin kasutame seda peamiselt selleks, et saaks andmeid lugeda lähtuvalt nende asukohast seoses meie R Markdowni faili asukohaga. Sellepärast tulekski see fail panna samasse kausta, kus on ka kaust <code>data</code> ülejäänud Moodle’ist alla laetud failidega. <em>Working directory</em> seadistamiseks saab valida ülevalt menüüribalt <code>Session → Set working directory → To Source File Location</code>. Seejärel jooksutame allolevat koodiplokki. Kui kõik on õigesti, peaks tulemuseks olema meie praeguse R Markdowni faili asukoht.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="r.html#cb14-1" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<p>Kui kopeerid koodiridu R-i skriptifaili, siis hoolitse selle eest, et sisseloetavate failide kaust <code>data</code> oleks funktsiooniga <code>getwd()</code> näidatud kaustas.</p>
</div>
<div id="kood" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Kood<a href="r.html#kood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vaatame paari näidet koodist, et mõista, kuidas üldiselt asjad töötavad.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="r.html#cb15-1" tabindex="-1"></a><span class="co"># Arvutuste tegemine. Koodi jooksutades näidatakse tulemust. </span></span>
<span id="cb15-2"><a href="r.html#cb15-2" tabindex="-1"></a><span class="dv">5</span> <span class="sc">+</span> <span class="dv">11</span></span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<p>Väärtustele (ja ka andmestikele, funktsioonidele) saab anda <code>&lt;-</code> abil nime ning selle nimega neile edaspidi viidata.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="r.html#cb17-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb17-2"><a href="r.html#cb17-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb17-3"><a href="r.html#cb17-3" tabindex="-1"></a>a <span class="sc">+</span> b</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="r.html#cb19-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb19-2"><a href="r.html#cb19-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb19-3"><a href="r.html#cb19-3" tabindex="-1"></a>a <span class="sc">+</span> b <span class="sc">+</span> x <span class="sc">+</span> y</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<p>Sama tehet saame teha ka funktsiooni abil. <strong>Funktsiooni puhul kirjutatakse kõigepealt funktsiooni nimi (nt <code>c</code> või <code>sum</code>) ning sellele järgnevad sulud, kus saab funktsiooni argumentidele väärtuseid anda</strong>. Põhimõtteliselt käib see samamoodi nagu inimkeeles: funktsioon on justkui mingi sihiline tegusõna (<em>tee midagi</em>), millele tuleb lisada, <em>mida</em>, <em>millega</em> või <em>kuidas</em> tehakse. Need viimased ongi argumendid, mida täpsustatakse sulgude sees. Kombineerime funktsiooniga <strong><code>c()</code></strong> (<em>concatenate</em>) arvulistest väärtustest nimekirja ning liidame funktsiooniga <strong><code>sum()</code></strong> kõik nimekirja väärtused kokku.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="r.html#cb21-1" tabindex="-1"></a>nimekiri <span class="ot">&lt;-</span> <span class="fu">c</span>(a, b, x, y)</span>
<span id="cb21-2"><a href="r.html#cb21-2" tabindex="-1"></a>nimekiri</span></code></pre></div>
<pre><code>## [1] 3 7 2 4</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="r.html#cb23-1" tabindex="-1"></a><span class="fu">sum</span>(nimekiri)</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<p>Muutujatele saab omistada lisaks arvulistele väärtustele mõistagi ka teistuguseid, nt tekstilisi väärtusi.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="r.html#cb25-1" tabindex="-1"></a>tekst <span class="ot">&lt;-</span> <span class="st">&quot;tekstilised väärtused on alati jutumärkide vahel&quot;</span></span>
<span id="cb25-2"><a href="r.html#cb25-2" tabindex="-1"></a>tekst</span></code></pre></div>
<pre><code>## [1] &quot;tekstilised väärtused on alati jutumärkide vahel&quot;</code></pre>
<p>Tekstiliste väärtustega arvutustehteid teha ei saa, küll aga igasugu muid asju.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="r.html#cb27-1" tabindex="-1"></a><span class="fu">nchar</span>(tekst) <span class="co"># näita teksti pikkust tähemärkides</span></span></code></pre></div>
<pre><code>## [1] 48</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="r.html#cb29-1" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, tekst) <span class="co"># asenda tekstis väikesed e-d suurtega</span></span></code></pre></div>
<pre><code>## [1] &quot;tEkstilisEd väärtusEd on alati jutumärkidE vahEl&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="r.html#cb31-1" tabindex="-1"></a><span class="fu">substr</span>(tekst, <span class="dv">1</span>, <span class="dv">10</span>) <span class="co"># näita tekstist esimest 10 tähte</span></span></code></pre></div>
<pre><code>## [1] &quot;tekstilise&quot;</code></pre>
<p>Muutujates saab hoida ka terveid andmetabeleid (<em>data frame</em>’e).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="r.html#cb33-1" tabindex="-1"></a>nimed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Oskar&quot;</span>, <span class="st">&quot;Mari&quot;</span>, <span class="st">&quot;Juhan&quot;</span>) <span class="co"># nimekiri nimedest</span></span>
<span id="cb33-2"><a href="r.html#cb33-2" tabindex="-1"></a>vanused <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">99</span>) <span class="co"># nimekiri vanustest (sama pikk kui nimede nimekiri)</span></span>
<span id="cb33-3"><a href="r.html#cb33-3" tabindex="-1"></a>tabel <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(nimed, vanused) <span class="co"># tabel kahest nimekirjast</span></span>
<span id="cb33-4"><a href="r.html#cb33-4" tabindex="-1"></a>tabel</span></code></pre></div>
<pre><code>##   nimed vanused
## 1 Oskar      10
## 2  Mari      25
## 3 Juhan      99</code></pre>
</div>
<div id="andmete-sisselugemine" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Andmete sisselugemine<a href="r.html#andmete-sisselugemine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Andmete sisselugemiseks tuleb kasutada vastavalt andmestiku tüübile funktsioone, millest enamik sisaldab mingil kujul sõna <em>read</em>. Tabelandmestiku puhul nt <code>read.delim()</code> ja <strong>vektorkujul ruumiandmete puhul <code>st_read()</code></strong> (paketist <code>sf</code>).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="r.html#cb35-1" tabindex="-1"></a>kihelkonnad <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/kihelkonnad/kihelkonnad.shp&quot;</span>)</span>
<span id="cb35-2"><a href="r.html#cb35-2" tabindex="-1"></a><span class="co"># Seda koodi võiks lugeda järgmiselt: </span></span>
<span id="cb35-3"><a href="r.html#cb35-3" tabindex="-1"></a><span class="co"># ava meie praeguse R Markdowni failiga samas kaustas olevast kaustast data/kihelkonnad </span></span>
<span id="cb35-4"><a href="r.html#cb35-4" tabindex="-1"></a><span class="co"># fail kihelkonnad.shp ja anna sellele nimeks kihelkonnad.</span></span></code></pre></div>
<p>Näeme, et sisse loetakse multipolügooni tüüpi ruumiandmed, mis on Eesti 1997. aasta koordinaatide referentssüsteemis. Kõige läänepoolsem x-koordinaat on 369020.1, kõige idapoolsem 739155.1; kõige lõunapoolsem y-koordinaat on 6377141, kõige põhjapoolsem 6634006.<br />
Atribuuttabelis on 120 rida ja 11 tulpa.<br />
Loeme sisse ka atlase punktikihi, kus on 279 rida ja 13 tulpa.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="r.html#cb36-1" tabindex="-1"></a>atlas <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/atlas.gpkg&quot;</span>)</span></code></pre></div>
<p>Kui <code>st_read()</code> funktsiooniga andmete sisselugemine ei tööta, tähendab see tõenäoliselt, et pakett on jäänud installimata (<code>install.packages("sf")</code>) või laadimata (<code>library(sf)</code>).<br />
Andmestikest ülevaate saamiseks võime vajutada paremal <em>Environment</em> jaotises vastava muutuja nimel või kasutada näiteks funktsiooni <code>head()</code>, mis kuvab tabeli esimesed read (vaikimisi 6 esimest rida).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="r.html#cb37-1" tabindex="-1"></a><span class="fu">head</span>(kihelkonnad)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 11 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 416505.7 ymin: 6404452 xmax: 502423.3 ymax: 6547085
## Projected CRS: Estonian Coordinate System of 1997
##   ID Parish_id    Name     Ger_name
## 1  1       Vor  Vormsi        Worms
## 2  2       Muh    Muhu         Mohn
## 3  3       Khn   Kihnu        Kühnö
## 4  4       Ruh   Ruhnu         Runö
## 5  5       Jaa   Jaani St. Johannis
## 6  6       Vll Valjala        Wolde
##                                                                               Comment
## 1                                                         Khk-piir ühtib vallapiiriga
## 2                                                                 Piirid kontrollitud
## 3 Ei olnud omaette kihelkond, ent loetakse siiski etnograafiliselt eraldi piirkonnaks
## 4                                                                        Kontrollitud
## 5                       Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 6                       Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
##   Problem Shape_Leng Dialect_en Shape_Le_1 Shape_Area Dialect_et
## 1    &lt;NA&gt;  137619.56    Western  119120.89   95574580      Lääne
## 2    &lt;NA&gt;  166662.20    Insular  152068.60  208717779     Saarte
## 3    &lt;NA&gt;   57101.22    Insular   43719.90   17486775     Saarte
## 4    &lt;NA&gt;   26172.08    Insular   22586.64   11903885     Saarte
## 5    &lt;NA&gt;   78056.11    Insular   72996.58  120846149     Saarte
## 6    &lt;NA&gt;  134426.80    Insular  125282.86  210185513     Saarte
##                         geometry
## 1 MULTIPOLYGON (((457464.6 65...
## 2 MULTIPOLYGON (((463501.9 64...
## 3 MULTIPOLYGON (((500539.8 64...
## 4 MULTIPOLYGON (((456664 6404...
## 5 MULTIPOLYGON (((445725.1 64...
## 6 MULTIPOLYGON (((437423 6465...</code></pre>
<p>Nagu öeldud, saab tavaliste tabelite (st mitteruumiandmete) sisselugemiseks kasutada näiteks funktsiooni <code>read.delim()</code>, aga <code>read</code>-käskusid on tegelikult väga palju (trüki nt konsooli sisse <code>read</code> ja vajuta tabulaatorit, et näha võimalikke variante). Loeme sisse murdekorpuse sagedusandmed.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="r.html#cb39-1" tabindex="-1"></a><span class="co"># tulpade eraldaja (sep) on semikoolon</span></span>
<span id="cb39-2"><a href="r.html#cb39-2" tabindex="-1"></a><span class="co"># faili kodeering (encoding) on &quot;UTF-8&quot;</span></span>
<span id="cb39-3"><a href="r.html#cb39-3" tabindex="-1"></a>korpus <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;data/eiole_pole_mk_props.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
<p>Vaatame esimesi ridu.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="r.html#cb40-1" tabindex="-1"></a><span class="fu">head</span>(korpus)</span></code></pre></div>
<pre><code>##   Murre Murrak     eiole       pole
## 1 Kirde    Jõh 0.9117647 0.08823529
## 2 Kirde    Iis 0.9062500 0.09375000
## 3   Ida    Pal 0.7191011 0.28089888
## 4  Kesk    Äks 0.9142857 0.08571429
## 5  Kesk    Amb 0.7530864 0.24691358
## 6  Kesk    Juu 0.5405405 0.45945946</code></pre>
</div>
<div id="kaartide-tegemine" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Kaartide tegemine<a href="r.html#kaartide-tegemine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Populaarne R-i pakett andmete visualiseerimiseks on <a href="https://ggplot2.tidyverse.org/index.html">ggplot2</a>, mis on ka Tidyverse’i pakettide kogumiku osa. Sellega saab teha nii kõiksugu jooniseid kui ka kaarte. Pakett põhineb nn graafikagrammatika (<em>Grammar of Graphics</em>) kontseptsioonil, mis võimaldab luua jooniseid erinevate komponentide ja kihtide kombineerimise teel. Sisuliselt toimub komponentide lisamine kihtidena pisut sarnaselt sellele, mida oleme siiani QGISis teinud. Kõigepealt lisatakse aluskiht, seejärel mingi sisukiht ning seejärel kõikvõimalikud märkused ja lisad (ehkki kihtide lisamise järjekord ei ole väga rangelt määratud).
Proovime paketi <code>ggplot2</code> abil teha oma sisseloetud andmetest kaarte.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="r.html#cb42-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb42-2"><a href="r.html#cb42-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<ul>
<li>Funktsiooniga <strong><code>ggplot()</code></strong> algab iga ggploti graafik.<br />
</li>
<li>Sellele lisame ruumiandmete kihi <strong><code>geom_sf()</code></strong> funktsiooniga, mille sees saame täpsustada andmestiku nime, kust ruumiandmed tulevad. <code>geom</code>-kihte võib lisada ka mitu tükki.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="r.html#cb43-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb43-2"><a href="r.html#cb43-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad) <span class="sc">+</span></span>
<span id="cb43-3"><a href="r.html#cb43-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> atlas)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Värvime maakondade polügoonid helehalli värvi (<code>fill</code>), polügoonide piirjooned samuti heledamaks halliks (<code>color</code>). Punktid teeme läbipaistvamaks (<code>alpha</code>) ja pisut suuremaks (<code>size</code>) ja kasutame halli taustaga kaarditeema asemel mustvalget teemat (<code>theme_bw()</code>). Värvinimesid ja HEX-värvikoode, mida saab kasutada, leiad näiteks <a href="https://r-charts.com/colors/">siit</a>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="r.html#cb44-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-2"><a href="r.html#cb44-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad, <span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="r.html#cb44-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> atlas, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="r.html#cb44-4" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Lisame joonisele ka pealkirja (<code>title</code>) ja viite kasutatud andmetele (<code>caption</code>). Lisame ka mõõtkava (<code>annotation_scale</code> paketist <code>ggspatial</code>). Mõõtkava võib paigutada nt alumisse vasakusse (<em>bl</em>), alumisse paremasse (<em>br</em>), ülemisse vasakusse (<em>ul</em>) või ülemisse paremasse nurka (<em>ur</em>).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="r.html#cb45-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb45-2"><a href="r.html#cb45-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad, <span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-3"><a href="r.html#cb45-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> atlas, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="r.html#cb45-4" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-5"><a href="r.html#cb45-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Murdeatlase punktid&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Andmed: EKI (2015), Andrus Saareste (1955)&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="r.html#cb45-6" tabindex="-1"></a>    <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Praegu oleme kujutanud kaardil lihtsalt ruumiandmeid (kus mingid polügoonid või punktid asuvad?), aga ei kajasta kuidagi visuaalselt andmestiku tunnuseid. Juhul, kui mõni kujunduselement (nt värv, suurus, kuju, läbipaistvus) on seotud <strong>atribuuttabeli tunnusega</strong>, tuleb selle tunnuse nimi ja seda kujutav visuaalne atribuut tuua välja <code>geom()</code>-kihil <strong><code>aes()</code></strong>-funktsiooni sees (<em>aesthetics</em>).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="r.html#cb46-1" tabindex="-1"></a><span class="co"># Värvime kihelkondade polügoonid vastavalt murdeala nimele</span></span>
<span id="cb46-2"><a href="r.html#cb46-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb46-3"><a href="r.html#cb46-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad, <span class="fu">aes</span>(<span class="at">fill =</span> Dialect_et))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="r.html#cb47-1" tabindex="-1"></a><span class="co"># Vrd</span></span>
<span id="cb47-2"><a href="r.html#cb47-2" tabindex="-1"></a><span class="co">#ggplot() +</span></span>
<span id="cb47-3"><a href="r.html#cb47-3" tabindex="-1"></a><span class="co">#    geom_sf(data = kihelkonnad, fill = &quot;red&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="r.html#cb48-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb48-2"><a href="r.html#cb48-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad) <span class="sc">+</span></span>
<span id="cb48-3"><a href="r.html#cb48-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> atlas, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">color =</span> KeelendBin))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="r.html#cb49-1" tabindex="-1"></a><span class="co"># Vrd</span></span>
<span id="cb49-2"><a href="r.html#cb49-2" tabindex="-1"></a><span class="co">#ggplot() +</span></span>
<span id="cb49-3"><a href="r.html#cb49-3" tabindex="-1"></a><span class="co">#    geom_sf(data = kihelkonnad) +</span></span>
<span id="cb49-4"><a href="r.html#cb49-4" tabindex="-1"></a><span class="co">#    geom_sf(data = atlas, alpha = 0.5, size = 3, color = &quot;red&quot;)</span></span></code></pre></div>
<p>Kui mõni kujunduselement (<code>alpha</code>, <code>fill</code>, <code>color</code>, <code>size</code>, <code>shape</code> vm) on niisiis niisama <code>geom_sf()</code> funktsiooni sees, kehtib see kõikidele kihi objektidele ühtmoodi (nt kõik punktid on punased). Kui see on aga omakorda veel <code>aes()</code>-funktsiooni sees, eristatakse objektide kujundust vastavalt mingile andmestiku atribuudile/tunnusele (nt ühed punktid on punased, teised sinised, vastavalt sellele, kas tegemist on <em>ei ole</em> või <em>pole</em> punktiga).</p>
<p>Atribuuttabeliga seotud kujunduselementide välimuse muutmiseks (enamasti nt värvipaleti vahetamiseks) saab kasutada eraldi <code>scale_...</code>-funktsioone. Näiteks täitevärvi (<code>fill</code>) värvipaletti saab vahetada funktsioonidega, mis algavad <code>scale_fill_...</code>, ilma täitevärvita sümboli või äärejoone (<code>color</code>) värvipaletti saab vahetada funktsioonidega, mis algavad <code>scale_color_...</code>.<br />
Värvime maakonnad nt Viridise diskreetse, st mittepideva värviskaalaga (<code>_d</code>) ja punktid <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">Breweri</a> kvalitatiivsete (st mittearvuliste) tunnuste jaoks mõeldud värvidega.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="r.html#cb50-1" tabindex="-1"></a><span class="co"># Vahetame maakondade värviskaalat</span></span>
<span id="cb50-2"><a href="r.html#cb50-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb50-3"><a href="r.html#cb50-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad, <span class="fu">aes</span>(<span class="at">fill =</span> Dialect_et)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="r.html#cb50-4" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="r.html#cb51-1" tabindex="-1"></a><span class="co"># Vahetame punktide värviskaalat</span></span>
<span id="cb51-2"><a href="r.html#cb51-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="r.html#cb51-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad) <span class="sc">+</span></span>
<span id="cb51-4"><a href="r.html#cb51-4" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> atlas, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">color =</span> KeelendBin)) <span class="sc">+</span></span>
<span id="cb51-5"><a href="r.html#cb51-5" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>Võime määrata värvid ka käsitsi, nt <code>scale_color_manual(values = c("pink", "green"))</code>.</p>
</div>
<div id="andmete-valimine" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Andmete valimine<a href="r.html#andmete-valimine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ruumiandmete filtreerimiseks on meil kasutada <code>dplyr</code> pakett, mis võimaldab paari funktsiooni abil suure osa andmetöötlusest ära teha ja mis saab laaditud koos <code>tidyverse</code>’i paketi laadimisega.<br />
Filtreerime kihelkondade kihilt ainult saarte murde alla kuuluvad polügoonid. Selleks võime esmalt küsida, mis on üldse kihelkondade kihi tulbanimed.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="r.html#cb52-1" tabindex="-1"></a><span class="fu">names</span>(kihelkonnad)</span></code></pre></div>
<pre><code>##  [1] &quot;ID&quot;         &quot;Parish_id&quot;  &quot;Name&quot;       &quot;Ger_name&quot;   &quot;Comment&quot;   
##  [6] &quot;Problem&quot;    &quot;Shape_Leng&quot; &quot;Dialect_en&quot; &quot;Shape_Le_1&quot; &quot;Shape_Area&quot;
## [11] &quot;Dialect_et&quot; &quot;geometry&quot;</code></pre>
<p>Nüüd filtreerime kihelkondade kihilt need read ja need kihelkondade polügoonid, kus tulbas <code>Dialect_et</code> on väärtus <code>Saarte</code>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="r.html#cb54-1" tabindex="-1"></a>kihelkonnad <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="r.html#cb54-2" tabindex="-1"></a>    <span class="fu">filter</span>(Dialect_et <span class="sc">==</span> <span class="st">&quot;Saarte&quot;</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 18 features and 11 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 369020.1 ymin: 6404452 xmax: 502423.3 ymax: 6551381
## Projected CRS: Estonian Coordinate System of 1997
## First 10 features:
##    ID Parish_id       Name     Ger_name
## 1   2       Muh       Muhu         Mohn
## 2   3       Khn      Kihnu        Kühnö
## 3   4       Ruh      Ruhnu         Runö
## 4   5       Jaa      Jaani St. Johannis
## 5   6       Vll    Valjala        Wolde
## 6   7       Mus   Mustjala       Mustel
## 7   8       Kaa     Kaarma       Karmel
## 8   9       Kär      Kärla       Kergel
## 9  10       Khk Kihelkonna     Kielkond
## 10 11       Jäm     Jämaja        Jamma
##                                                                                Comment
## 1                                                                  Piirid kontrollitud
## 2  Ei olnud omaette kihelkond, ent loetakse siiski etnograafiliselt eraldi piirkonnaks
## 3                                                                         Kontrollitud
## 4                        Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 5                        Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 6                        Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 7                        Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 8                        Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 9                        Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
## 10                       Katastripiiride põhjal üle kontrollitud (P. Päll, 2013-01-15)
##    Problem Shape_Leng Dialect_en Shape_Le_1 Shape_Area Dialect_et
## 1     &lt;NA&gt;  166662.20    Insular  152068.60  208717779     Saarte
## 2     &lt;NA&gt;   57101.22    Insular   43719.90   17486775     Saarte
## 3     &lt;NA&gt;   26172.08    Insular   22586.64   11903885     Saarte
## 4     &lt;NA&gt;   78056.11    Insular   72996.58  120846149     Saarte
## 5     &lt;NA&gt;  134426.80    Insular  125282.86  210185513     Saarte
## 6     &lt;NA&gt;  114295.25    Insular  109866.84  226931935     Saarte
## 7     &lt;NA&gt;  170224.11    Insular  160600.13  373623450     Saarte
## 8     &lt;NA&gt;   77964.86    Insular   77959.20  228263844     Saarte
## 9     &lt;NA&gt;  394865.11    Insular  364986.01  459481464     Saarte
## 10    &lt;NA&gt;  113085.92    Insular   95051.81  142890724     Saarte
##                          geometry
## 1  MULTIPOLYGON (((463501.9 64...
## 2  MULTIPOLYGON (((500539.8 64...
## 3  MULTIPOLYGON (((456664 6404...
## 4  MULTIPOLYGON (((445725.1 64...
## 5  MULTIPOLYGON (((437423 6465...
## 6  MULTIPOLYGON (((401102.4 64...
## 7  MULTIPOLYGON (((415976.4 64...
## 8  MULTIPOLYGON (((404232.4 64...
## 9  MULTIPOLYGON (((375155.3 64...
## 10 MULTIPOLYGON (((383088.7 64...</code></pre>
<p>Nn toru <code>%&gt;%</code> suunab mingi objekti või väljundi uue funktsiooni sisse. Praegusel juhul võtsime niisiis kihelkondade kihi ja selle suunasime <code>filter()</code>-funktsiooni. Võime filtreerimise väljundi omakorda suunata järgmisse funktsiooni, näiteks joonise tegemise funktsiooni. Sellisel juhul pole <code>geom_sf()</code> funktsioonis vaja eraldi andmestikku täpsustada, sest toru ütleb ära, et andmestik tuleb eelnevate käskude väljundist.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="r.html#cb56-1" tabindex="-1"></a>kihelkonnad <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="r.html#cb56-2" tabindex="-1"></a>    <span class="fu">filter</span>(Dialect_et <span class="sc">==</span> <span class="st">&quot;Saarte&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="r.html#cb56-3" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="r.html#cb56-4" tabindex="-1"></a>    <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Teine variant on salvestada filtreeritud andmed eraldi muutujasse ja kasutada seejärel <code>ggplot()</code> funktsiooni nii nagu ennegi.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="r.html#cb57-1" tabindex="-1"></a>kihelkonnad <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Dialect_et <span class="sc">==</span> <span class="st">&quot;Saarte&quot;</span>) <span class="ot">-&gt;</span> saarte_murre</span>
<span id="cb57-2"><a href="r.html#cb57-2" tabindex="-1"></a><span class="co"># saame suunamist teha ka vasakult paremale -&gt;</span></span>
<span id="cb57-3"><a href="r.html#cb57-3" tabindex="-1"></a><span class="co"># sama tulemuse saaks koodiga</span></span>
<span id="cb57-4"><a href="r.html#cb57-4" tabindex="-1"></a><span class="co"># saarte_murre &lt;- kihelkonnad %&gt;% filter(Dialect_et == &quot;Saarte&quot;)</span></span>
<span id="cb57-5"><a href="r.html#cb57-5" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href="r.html#cb57-6" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> saarte_murre)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Ridade filtreerimisel töötavad sarnased operaatorid, mida oleme näinud ka QGISis:</p>
<ul>
<li><code>&gt;</code> on suurem kui<br />
</li>
<li><code>&lt;</code> on väiksem kui</li>
<li><code>&gt;=</code> on suurem kui või võrdne<br />
</li>
<li><code>&lt;=</code> on väiksem kui või võrdne<br />
</li>
<li><code>==</code> on võrdne<br />
</li>
<li><code>!=</code> ei ole võrdne<br />
</li>
<li><code>%in%</code> kuulub hulka</li>
</ul>
<p>Valime atlase punktikihilt ainult <em>pole</em> punktid ja kuvame need kihelkondade kaardil. Kihelkondade kiht peab tulema enne punktikihti, et see punkte ära ei kataks.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="r.html#cb58-1" tabindex="-1"></a><span class="fu">names</span>(atlas) <span class="co"># vaatame tulbanimesid</span></span></code></pre></div>
<pre><code>##  [1] &quot;ANIMI&quot;      &quot;ONIMI&quot;      &quot;MNIMI&quot;      &quot;SaKhkLyh&quot;   &quot;SaKhk&quot;     
##  [6] &quot;SaKyla&quot;     &quot;SaKJEes&quot;    &quot;SaKJPrk&quot;    &quot;SaKJSynd&quot;   &quot;Keelend&quot;   
## [11] &quot;SaKom&quot;      &quot;KeelendBin&quot; &quot;KeelendNum&quot; &quot;geom&quot;</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="r.html#cb60-1" tabindex="-1"></a><span class="fu">head</span>(atlas) <span class="co"># vaatame esimesi ridu</span></span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 13 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 425475.3 ymin: 6507561 xmax: 535475 ymax: 6590791
## Projected CRS: Estonian Coordinate System of 1997
##                ANIMI         ONIMI         MNIMI SaKhkLyh        SaKhk
## 1        Leibre küla   Vigala vald Rapla maakond      Vig       Vigala
## 2      Paldiski linn Paldiski linn Harju maakond      HMd Harju-Madise
## 3 Haabersti linnaosa       Tallinn Harju maakond      Kei        Keila
## 4       Muraste küla    Harku vald Harju maakond      Kei        Keila
## 5       Ilmandu küla    Harku vald Harju maakond      Kei        Keila
## 6         Selja küla    Käina vald  Hiiu maakond      Käi        Käina
##      SaKyla SaKJEes SaKJPrk SaKJSynd     Keelend                     SaKom
## 1 Leilavere    &lt;NA&gt;    &lt;NA&gt;       NA ei (äi) ole                      &lt;NA&gt;
## 2    Leetse    &lt;NA&gt;    &lt;NA&gt;       NA        põle                      &lt;NA&gt;
## 3   Kakumäe    &lt;NA&gt;    &lt;NA&gt;       NA        pole                      &lt;NA&gt;
## 4   Muraste    &lt;NA&gt;    &lt;NA&gt;       NA ei (äi) ole                      &lt;NA&gt;
## 5   Ilmandu    &lt;NA&gt;    &lt;NA&gt;       NA ei (äi) ole                      &lt;NA&gt;
## 6     Selja    &lt;NA&gt;    &lt;NA&gt;       NA        pole T. s. Eduard Mäehans 1890
##   KeelendBin KeelendNum                     geom
## 1     ei ole          1 POINT (523059.3 6507561)
## 2       pole          0 POINT (505646.8 6579844)
## 3       pole          0   POINT (535475 6586658)
## 4     ei ole          1 POINT (525130.3 6590791)
## 5     ei ole          1 POINT (527089.1 6589553)
## 6       pole          0 POINT (425475.3 6522034)</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="r.html#cb62-1" tabindex="-1"></a>atlas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(KeelendBin <span class="sc">==</span> <span class="st">&quot;pole&quot;</span>) <span class="ot">-&gt;</span> pole_punktid</span>
<span id="cb62-2"><a href="r.html#cb62-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-3"><a href="r.html#cb62-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kihelkonnad, <span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span> </span>
<span id="cb62-4"><a href="r.html#cb62-4" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> pole_punktid, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb62-5"><a href="r.html#cb62-5" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Atlase punktikihi puhul meil murrete infot teada ei ole (on ainult maakondade info). Selleks, et kuvada korraga nt keskmurde kihelkondi JA keskmurde atlase punkte, peaksime atlase punktidele nende kihelkonna info põhjal leidma ka murrete nimed.</p>
</div>
<div id="andmestike-ühendamine-1" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Andmestike ühendamine<a href="r.html#andmestike-ühendamine-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ruumiandmete</strong> omavahel ühendamiseks (st puhtalt koordinaadipõhiseks andmete ühendamiseks) saab kasutada funktsiooni <strong><code>st_join()</code></strong> (paketist <code>sf</code>). Selleks, et ühendamisel säiliks andmestiku vektortüübina punktandmestik, mitte polügoonid, peaksime vasakule poole panema atlase andmestiku nime ja paremale kihelkondade oma.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="r.html#cb63-1" tabindex="-1"></a>atlas_khk <span class="ot">&lt;-</span> <span class="fu">st_join</span>(atlas, kihelkonnad)</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="r.html#cb64-1" tabindex="-1"></a><span class="fu">head</span>(atlas_khk)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 24 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 425475.3 ymin: 6507561 xmax: 535475 ymax: 6590791
## Projected CRS: Estonian Coordinate System of 1997
##                ANIMI         ONIMI         MNIMI SaKhkLyh        SaKhk
## 1        Leibre küla   Vigala vald Rapla maakond      Vig       Vigala
## 2      Paldiski linn Paldiski linn Harju maakond      HMd Harju-Madise
## 3 Haabersti linnaosa       Tallinn Harju maakond      Kei        Keila
## 4       Muraste küla    Harku vald Harju maakond      Kei        Keila
## 5       Ilmandu küla    Harku vald Harju maakond      Kei        Keila
## 6         Selja küla    Käina vald  Hiiu maakond      Käi        Käina
##      SaKyla SaKJEes SaKJPrk SaKJSynd     Keelend                     SaKom
## 1 Leilavere    &lt;NA&gt;    &lt;NA&gt;       NA ei (äi) ole                      &lt;NA&gt;
## 2    Leetse    &lt;NA&gt;    &lt;NA&gt;       NA        põle                      &lt;NA&gt;
## 3   Kakumäe    &lt;NA&gt;    &lt;NA&gt;       NA        pole                      &lt;NA&gt;
## 4   Muraste    &lt;NA&gt;    &lt;NA&gt;       NA ei (äi) ole                      &lt;NA&gt;
## 5   Ilmandu    &lt;NA&gt;    &lt;NA&gt;       NA ei (äi) ole                      &lt;NA&gt;
## 6     Selja    &lt;NA&gt;    &lt;NA&gt;       NA        pole T. s. Eduard Mäehans 1890
##   KeelendBin KeelendNum ID Parish_id         Name     Ger_name
## 1     ei ole          1 37       Vig       Vigala       Fickel
## 2       pole          0 27       HMd Harju-Madise St. Matthias
## 3       pole          0 26       Kei        Keila        Kegel
## 4     ei ole          1 26       Kei        Keila        Kegel
## 5     ei ole          1 26       Kei        Keila        Kegel
## 6       pole          0 46       Käi        Käina       Keinis
##                                                                                     Comment
## 1            Kihelkonnapiirid mõisapiiride järgi üle kontrollitud (Peeter Päll, 2012-11-26)
## 2 Kihelkonnapiirid mõisapiiride järgi üle kontrollitud (Peeter Päll, 2012-11-12) + Ris piir
## 3            Kihelkonnapiirid mõisapiiride järgi üle kontrollitud (Peeter Päll, 2012-11-12)
## 4            Kihelkonnapiirid mõisapiiride järgi üle kontrollitud (Peeter Päll, 2012-11-12)
## 5            Kihelkonnapiirid mõisapiiride järgi üle kontrollitud (Peeter Päll, 2012-11-12)
## 6            Kihelkonnapiirid mõisapiiride järgi üle kontrollitud (Peeter Päll, 2012-11-27)
##   Problem Shape_Leng Dialect_en Shape_Le_1 Shape_Area Dialect_et
## 1    &lt;NA&gt;   109783.2    Western   109656.3  361383036      Lääne
## 2    &lt;NA&gt;   112767.7        Mid   110349.6  173357161       Kesk
## 3    &lt;NA&gt;   145259.7        Mid   142289.8  627679360       Kesk
## 4    &lt;NA&gt;   145259.7        Mid   142289.8  627679360       Kesk
## 5    &lt;NA&gt;   145259.7        Mid   142289.8  627679360       Kesk
## 6    &lt;NA&gt;   125610.6    Insular   119959.6  199587278     Saarte
##                       geom
## 1 POINT (523059.3 6507561)
## 2 POINT (505646.8 6579844)
## 3   POINT (535475 6586658)
## 4 POINT (525130.3 6590791)
## 5 POINT (527089.1 6589553)
## 6 POINT (425475.3 6522034)</code></pre>
<p>Funktsioon <code>st_join()</code> vaatab niisiis iga punkti puhul, millise kihelkonna polügooni sisse see punkt jääb, ning lisab punktile vastava kihelkonna info (sh info selle kohta, millise murdeala alla kihelkond kuulub).</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="r.html#cb66-1" tabindex="-1"></a>kesk_khk <span class="ot">&lt;-</span> kihelkonnad <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Dialect_et <span class="sc">==</span> <span class="st">&quot;Kesk&quot;</span>)</span>
<span id="cb66-2"><a href="r.html#cb66-2" tabindex="-1"></a>kesk_atlas <span class="ot">&lt;-</span> atlas_khk <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Dialect_et <span class="sc">==</span> <span class="st">&quot;Kesk&quot;</span>)</span>
<span id="cb66-3"><a href="r.html#cb66-3" tabindex="-1"></a></span>
<span id="cb66-4"><a href="r.html#cb66-4" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="r.html#cb66-5" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kesk_khk) <span class="sc">+</span></span>
<span id="cb66-6"><a href="r.html#cb66-6" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kesk_atlas) <span class="sc">+</span></span>
<span id="cb66-7"><a href="r.html#cb66-7" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Keskmurde kihelkonnad ja murdeatlase punktid&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Võtame kaardilt ära ka koordinaadistiku ja värvime tausta tumehalliks</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="r.html#cb67-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb67-2"><a href="r.html#cb67-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kesk_khk) <span class="sc">+</span></span>
<span id="cb67-3"><a href="r.html#cb67-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kesk_atlas, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">color =</span> KeelendBin)) <span class="sc">+</span></span>
<span id="cb67-4"><a href="r.html#cb67-4" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Keskmurde kihelkonnad ja murdeatlase punktid&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="r.html#cb67-5" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="co"># kaota koordinaadistik</span></span>
<span id="cb67-6"><a href="r.html#cb67-6" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="co"># kaota telgede tekst</span></span>
<span id="cb67-7"><a href="r.html#cb67-7" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="co"># kaota telgede kriipsud</span></span>
<span id="cb67-8"><a href="r.html#cb67-8" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey40&quot;</span>)) <span class="co"># lisa joonisele taust, mis oleks täidetud halli värviga</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Väiksema ala puhul võime punktide asemel kuvada ehk hoopis konkreetsete keelendite silte.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="r.html#cb68-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb68-2"><a href="r.html#cb68-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> kesk_khk) <span class="sc">+</span></span>
<span id="cb68-3"><a href="r.html#cb68-3" tabindex="-1"></a>    <span class="fu">geom_sf_text</span>(<span class="at">data =</span> kesk_atlas, <span class="fu">aes</span>(<span class="at">label =</span> Keelend), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># sildid</span></span>
<span id="cb68-4"><a href="r.html#cb68-4" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Keskmurde kihelkonnad ja murdeatlase keelendid&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-5"><a href="r.html#cb68-5" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-6"><a href="r.html#cb68-6" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-7"><a href="r.html#cb68-7" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-8"><a href="r.html#cb68-8" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="co"># kaotame x- ja y- telje pealkirjad</span></span>
<span id="cb68-9"><a href="r.html#cb68-9" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey40&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Muude andmestike (nt <strong>ruumiandmete + mitteruumiandmete</strong>) ühendamiseks saab kasutada muid <code>..._join()</code>-funktsioone (paketist <code>dplyr</code>, mis peaks laaditama automaatselt, kui laadid paketi <code>tidyverse</code>). Näiteks <strong><code>left_join()</code></strong> ühendab kaks andmestikku nii, et uude andmestikku jäävad vasakpoolsest andmestikust kõik read ja parempoolsest andmestikust need read, mis tal on vasakpoolsega ühised. Säilib ka vasakpoolsete andmete andmetüüp (nt kui vasakpoolne andmestik on ruumiandmete andmestik ja parempoolne tavaline tabel, on ühendamisel tekkiv andmestik ka ruumiandmete andmestik). Teiste <code>join</code>-meetodite kohta saad lugeda, kui trükid konsooli <code>?join</code> ja vajutad Enterit.</p>
<p>Kui tahame ühendada nüüd kihelkondade polügoonide andmeid (<code>kihelkonnad</code>) ja murdekorpuse sagedusandmeid (<code>korpus</code>), peame kõigepealt tegema kindlaks, millised on need tulbanimed, mis mõlemas andmestikus sisaldavad samu väärtusi.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="r.html#cb69-1" tabindex="-1"></a><span class="fu">names</span>(kihelkonnad)</span></code></pre></div>
<pre><code>##  [1] &quot;ID&quot;         &quot;Parish_id&quot;  &quot;Name&quot;       &quot;Ger_name&quot;   &quot;Comment&quot;   
##  [6] &quot;Problem&quot;    &quot;Shape_Leng&quot; &quot;Dialect_en&quot; &quot;Shape_Le_1&quot; &quot;Shape_Area&quot;
## [11] &quot;Dialect_et&quot; &quot;geometry&quot;</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="r.html#cb71-1" tabindex="-1"></a><span class="fu">names</span>(korpus)</span></code></pre></div>
<pre><code>## [1] &quot;Murre&quot;  &quot;Murrak&quot; &quot;eiole&quot;  &quot;pole&quot;</code></pre>
<p>Ühendame kihelkondade kihi tulba <code>Parish_id</code> põhjal ja korpuse kihi tulba <code>Murrak</code> põhjal. Mõlemad sisaldavad kihelkondade lühendeid.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="r.html#cb73-1" tabindex="-1"></a>yhendatud <span class="ot">&lt;-</span> <span class="fu">left_join</span>(kihelkonnad, korpus, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Parish_id&quot;</span> <span class="ot">=</span> <span class="st">&quot;Murrak&quot;</span>))</span></code></pre></div>
<p>Värvime nüüd kihelkonnad vastavalt sellele, kui suur on mingis kihelkonnas <em>pole</em> kasutamise osakaal.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="r.html#cb74-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb74-2"><a href="r.html#cb74-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> yhendatud, <span class="fu">aes</span>(<span class="at">fill =</span> pole))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Valime värviskaala, kus helesinine märgib väikest osakaalu, tumesinine suurt osakaalu ja vahepealsed väärtused jäävad nende vahele. Kihelkonnad, kust andmed puuduvad, värvime helehalliks.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="r.html#cb75-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb75-2"><a href="r.html#cb75-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> yhendatud, <span class="fu">aes</span>(<span class="at">fill =</span> pole)) <span class="sc">+</span></span>
<span id="cb75-3"><a href="r.html#cb75-3" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="r.html#cb75-4" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="jooniste-eksportimine" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Jooniste eksportimine<a href="r.html#jooniste-eksportimine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Kaarte saab eksportida paremal olevast <em>Plots</em> aknast, valides <em>Export</em> (see toimib juhul, kui oled enne määranud, et R Markdowni koodiplokkide väljundeid ei kuvataks markdowni faili sees; vastasel juhul ei kuvata <em>Plots</em> jaotises midagi). Samuti võib koodi lõppu lisada funktsiooni <code>ggsave("failinimi.png")</code>. Seejärel salvestatakse fail <em>Working directory</em> asukohta, mida saad vaadata funktsiooniga <code>getwd()</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="r.html#cb76-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb76-2"><a href="r.html#cb76-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> yhendatud, <span class="fu">aes</span>(<span class="at">fill =</span> pole)) <span class="sc">+</span></span>
<span id="cb76-3"><a href="r.html#cb76-3" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-4"><a href="r.html#cb76-4" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb76-5"><a href="r.html#cb76-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;minu_kaart.png&quot;</span>)</span></code></pre></div>
<p>Veidi rohkem kontrolli joonise parameetrite üle saad, kui kasutad <code>png()</code>, <code>tiff()</code> vmt funktsiooni, lisad selle järele oma joonise koodi ja kõige lõppu <code>dev.off()</code>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="r.html#cb77-1" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="st">&quot;minu_kaart.png&quot;</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb77-2"><a href="r.html#cb77-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-3"><a href="r.html#cb77-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> yhendatud, <span class="fu">aes</span>(<span class="at">fill =</span> pole)) <span class="sc">+</span></span>
<span id="cb77-4"><a href="r.html#cb77-4" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-5"><a href="r.html#cb77-5" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb77-6"><a href="r.html#cb77-6" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="ülesanne-5" class="section level2 hasAnchor" number="13.10">
<h2><span class="header-section-number">13.10</span> Ülesanne<a href="r.html#ülesanne-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Loe sisse kultuurimälestiste polügoonid failist <code>asustusyksus_malestised.gpkg</code>.</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="r.html#cb78-1" tabindex="-1"></a>malestised <span class="ot">&lt;-</span> ...</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Filtreeri andmestikust välja ainult Tartumaa asustusüksuste andmed.</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="r.html#cb79-1" tabindex="-1"></a>tartumaa_malestised <span class="ot">&lt;-</span> ...</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Värvi Tartu maakonna asustusüksused vastavalt sellele, kui palju on seal kultuurimälestisi kokku. Vali sobiv värvipalett. Selleks, et rõhutada erinevusi väikeste väärtuste vahel ja peita erinevusi suurte väärtuste vahel, võib kasutada <code>scale</code>-funktsiooni sees näiteks argumenti <code>trans = "log1p"</code>.</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="r.html#cb80-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb80-2"><a href="r.html#cb80-2" tabindex="-1"></a>    <span class="fu">geom_sf</span>(...) <span class="sc">+</span></span>
<span id="cb80-3"><a href="r.html#cb80-3" tabindex="-1"></a>    <span class="fu">scale_fill_...</span>(<span class="at">trans =</span> <span class="st">&quot;log1p&quot;</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Salvesta see Rmd-fail või eraldi R-i skriptifail joonise tegemiseks vajaliku koodiga ja tehtud kaart nimega <code>yl1.png</code>.</li>
</ol>
</div>
<div id="r-i-raamatud-ja-juhendid" class="section level2 hasAnchor" number="13.11">
<h2><span class="header-section-number">13.11</span> R-i raamatud ja juhendid<a href="r.html#r-i-raamatud-ja-juhendid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R-is saab analüüsida mõistagi ka rasterandmeid, teha veebirakendusi jpm.</p>
<p>R-i ja ruumiandmete kohta on hea ja ülevaatlik kursus ka aadressil <a href="http://aasa.ut.ee/Rspatial/">http://aasa.ut.ee/Rspatial/</a>.</p>
<p><a href="https://r4ds.had.co.nz/">R for Data Science</a><br />
<a href="https://r.geocompx.org/">Geocomputation with R</a><br />
<a href="https://r-spatial.org/book/">Spatial Data Science</a><br />
<a href="https://rspatial.org/index.html">Spatial Data Science with R and “terra”</a>
<a href="https://rc2e.com/">R Cookbook</a><br />
<a href="https://r-graphics.org/">R Graphics Cookbook</a><br />
<a href="https://bookdown.org/yihui/rmarkdown/">R Markdown: The Definitive Guide</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="veebirakendused.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="kirjandus.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
